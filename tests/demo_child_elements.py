import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojIC0qLSBjb2Rpbmc6IHV0Zi04IC0qLQoiIiIKRGVtbyBzY3JpcHQgxJHhu4MgdGVzdCBjw6FjIGjDoG0gZmluZF9jaGlsZF9lbGVtZW50cyB2w6AgZmluZF9jaGlsZF9lbGVtZW50IG3hu5tpCiIiIgoKaW1wb3J0IHN5cwppbXBvcnQgb3MKCiMgVGjDqm0gdGjGsCBt4bulYyBn4buRYyB2w6BvIFB5dGhvbiBwYXRoCnN5cy5wYXRoLmluc2VydCgwLCBvcy5wYXRoLmRpcm5hbWUob3MucGF0aC5kaXJuYW1lKG9zLnBhdGguYWJzcGF0aChfX2ZpbGVfXykpKSkKCmZyb20gc2VydmljZXMuaGVscGVyX3NlcnZpY2UgaW1wb3J0IEhlbHBlclNlcnZpY2UKaW1wb3J0IGNvbmZpZwoKZGVmIGRlbW9fZmluZF9jaGlsZF9lbGVtZW50cygpOgogICAgIiIiCiAgICBEZW1vIGPDoWNoIHPhu60gZOG7pW5nIGZpbmRfY2hpbGRfZWxlbWVudHMgdsOgIGZpbmRfY2hpbGRfZWxlbWVudAogICAgIiIiCiAgICBwcmludCgi8J+UjSBEZW1vIEZpbmQgQ2hpbGQgRWxlbWVudHMiKQogICAgcHJpbnQoIj0iICogNTApCiAgICAKICAgICMgS2jhu59pIHThuqFvIEhlbHBlclNlcnZpY2UKICAgIGhlbHBlciA9IEhlbHBlclNlcnZpY2UoKQogICAgCiAgICBwcmludCgi8J+TsSBM4bqleSB0aMO0bmcgdGluIG3DoG4gaMOsbmggaGnhu4duIHThuqFpLi4uIikKICAgIAogICAgIyAxLiBEZW1vIHTDrG0gdOG6pXQgY+G6oyBlbGVtZW50IGNvbiB24bubaSBjbGFzcyBj4bulIHRo4buDCiAgICBwcmludCgiXG4x77iP4oOjICBUw6xtIGVsZW1lbnQgY2hhICh2w60gZOG7pTogVmlld0dyb3VwIGhv4bq3YyBMaW5lYXJMYXlvdXQpIikKICAgIHBhcmVudF9lbGVtZW50cyA9IGhlbHBlci5maW5kX2FsbF9lbGVtZW50cyhjbGFzc19uYW1lPSJhbmRyb2lkLndpZGdldC5WaWV3R3JvdXAiKQogICAgCiAgICBpZiBub3QgcGFyZW50X2VsZW1lbnRzOgogICAgICAgIHBhcmVudF9lbGVtZW50cyA9IGhlbHBlci5maW5kX2FsbF9lbGVtZW50cyhjbGFzc19uYW1lPSJhbmRyb2lkLndpZGdldC5MaW5lYXJMYXlvdXQiKQogICAgCiAgICBpZiBub3QgcGFyZW50X2VsZW1lbnRzOgogICAgICAgIHBhcmVudF9lbGVtZW50cyA9IGhlbHBlci5maW5kX2FsbF9lbGVtZW50cyhjbGFzc19uYW1lPSJhbmRyb2lkLndpZGdldC5SZWxhdGl2ZUxheW91dCIpCiAgICAKICAgIGlmIHBhcmVudF9lbGVtZW50czoKICAgICAgICBwYXJlbnQgPSBwYXJlbnRfZWxlbWVudHNbMF0gICMgTOG6pXkgZWxlbWVudCBjaGEgxJHhuqd1IHRpw6puCiAgICAgICAgcGFyZW50X2NsYXNzID0gcGFyZW50LmdldCgiY2xhc3MiLCAiVW5rbm93biIpCiAgICAgICAgcGFyZW50X2lkID0gcGFyZW50LmdldCgicmVzb3VyY2UtaWQiLCAiTm8gSUQiKQogICAgICAgIHByaW50KGYi4pyFIFTDrG0gdGjhuqV5IGVsZW1lbnQgY2hhOiB7cGFyZW50X2NsYXNzfSIpCiAgICAgICAgcHJpbnQoZiIgICBSZXNvdXJjZSBJRDoge3BhcmVudF9pZH0iKQogICAgICAgIHByaW50KGYiICAgQm91bmRzOiB7cGFyZW50LmdldCgnYm91bmRzJywgJ1Vua25vd24nKX0iKQogICAgICAgIAogICAgICAgICMgMi4gVMOsbSB04bqldCBj4bqjIGVsZW1lbnQgY29uIGPDsyBjbGFzcyBj4bulIHRo4buDCiAgICAgICAgcHJpbnQoZiJcbjLvuI/ig6MgIFTDrG0gdOG6pXQgY+G6oyBlbGVtZW50IGNvbiB24bubaSBjbGFzcyAnYW5kcm9pZC53aWRnZXQuVGV4dFZpZXcnIikKICAgICAgICBjaGlsZF90ZXh0X3ZpZXdzID0gaGVscGVyLmZpbmRfY2hpbGRfZWxlbWVudHMocGFyZW50LCBjbGFzc19uYW1lPSJhbmRyb2lkLndpZGdldC5UZXh0VmlldyIpCiAgICAgICAgCiAgICAgICAgcHJpbnQoZiLwn5OLIFTDrG0gdGjhuqV5IHtsZW4oY2hpbGRfdGV4dF92aWV3cyl9IFRleHRWaWV3IGNvbjoiKQogICAgICAgIGZvciBpLCBjaGlsZCBpbiBlbnVtZXJhdGUoY2hpbGRfdGV4dF92aWV3c1s6NV0pOiAgIyBDaOG7iSBoaeG7g24gdGjhu4sgNSBlbGVtZW50IMSR4bqndQogICAgICAgICAgICB0ZXh0ID0gY2hpbGQuZ2V0KCJ0ZXh0IiwgIiIpCiAgICAgICAgICAgIHJlc291cmNlX2lkID0gY2hpbGQuZ2V0KCJyZXNvdXJjZS1pZCIsICJObyBJRCIpCiAgICAgICAgICAgIHByaW50KGYiICAge2krMX0uIFRleHQ6ICd7dGV4dH0nIHwgSUQ6IHtyZXNvdXJjZV9pZH0iKQogICAgICAgIAogICAgICAgIGlmIGxlbihjaGlsZF90ZXh0X3ZpZXdzKSA+IDU6CiAgICAgICAgICAgIHByaW50KGYiICAgLi4uIHbDoCB7bGVuKGNoaWxkX3RleHRfdmlld3MpIC0gNX0gZWxlbWVudCBraMOhYyIpCiAgICAgICAgCiAgICAgICAgIyAzLiBUw6xtIGVsZW1lbnQgY29uIMSR4bqndSB0acOqbiB24bubaSDEkWnhu4F1IGtp4buHbiBj4bulIHRo4buDCiAgICAgICAgcHJpbnQoZiJcbjPvuI/ig6MgIFTDrG0gZWxlbWVudCBjb24gxJHhuqd1IHRpw6puIGPDsyB0ZXh0IGtow7RuZyBy4buXbmciKQogICAgICAgIGZpcnN0X2NoaWxkX3dpdGhfdGV4dCA9IGhlbHBlci5maW5kX2NoaWxkX2VsZW1lbnQocGFyZW50LCBjbGFzc19uYW1lPSJhbmRyb2lkLndpZGdldC5UZXh0VmlldyIpCiAgICAgICAgCiAgICAgICAgaWYgZmlyc3RfY2hpbGRfd2l0aF90ZXh0OgogICAgICAgICAgICB0ZXh0ID0gZmlyc3RfY2hpbGRfd2l0aF90ZXh0LmdldCgidGV4dCIsICIiKQogICAgICAgICAgICBwcmludChmIuKchSBUw6xtIHRo4bqleTogJ3t0ZXh0fSciKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KCLinYwgS2jDtG5nIHTDrG0gdGjhuqV5IGVsZW1lbnQgY29uIHBow7kgaOG7o3AiKQogICAgICAgIAogICAgICAgICMgNC4gRGVtbyB0w6xtIGVsZW1lbnQgY29uIHbhu5tpIGNsYXNzIGtow6FjCiAgICAgICAgcHJpbnQoZiJcbjTvuI/ig6MgIFTDrG0gdOG6pXQgY+G6oyBCdXR0b24gY29uIikKICAgICAgICBjaGlsZF9idXR0b25zID0gaGVscGVyLmZpbmRfY2hpbGRfZWxlbWVudHMocGFyZW50LCBjbGFzc19uYW1lPSJhbmRyb2lkLndpZGdldC5CdXR0b24iKQogICAgICAgIAogICAgICAgIHByaW50KGYi8J+UmCBUw6xtIHRo4bqleSB7bGVuKGNoaWxkX2J1dHRvbnMpfSBCdXR0b24gY29uOiIpCiAgICAgICAgZm9yIGksIGJ1dHRvbiBpbiBlbnVtZXJhdGUoY2hpbGRfYnV0dG9ucyk6CiAgICAgICAgICAgIHRleHQgPSBidXR0b24uZ2V0KCJ0ZXh0IiwgIiIpCiAgICAgICAgICAgIGNvbnRlbnRfZGVzYyA9IGJ1dHRvbi5nZXQoImNvbnRlbnQtZGVzYyIsICIiKQogICAgICAgICAgICBkaXNwbGF5X3RleHQgPSB0ZXh0IG9yIGNvbnRlbnRfZGVzYyBvciAiTm8gdGV4dCIKICAgICAgICAgICAgcHJpbnQoZiIgICB7aSsxfS4gJ3tkaXNwbGF5X3RleHR9JyIpCiAgICAgICAgCiAgICAgICAgIyA1LiBEZW1vIHTDrG0gR3JpZFZpZXcgKG5oxrAgecOqdSBj4bqndSBj4bunYSB1c2VyKQogICAgICAgIHByaW50KGYiXG4177iP4oOjICBUw6xtIHThuqV0IGPhuqMgR3JpZFZpZXcgY29uIikKICAgICAgICBjaGlsZF9ncmlkdmlld3MgPSBoZWxwZXIuZmluZF9jaGlsZF9lbGVtZW50cyhwYXJlbnQsIGNsYXNzX25hbWU9ImFuZHJvaWQud2lkZ2V0LkdyaWRWaWV3IikKICAgICAgICAKICAgICAgICBpZiBjaGlsZF9ncmlkdmlld3M6CiAgICAgICAgICAgIHByaW50KGYi8J+TiiBUw6xtIHRo4bqleSB7bGVuKGNoaWxkX2dyaWR2aWV3cyl9IEdyaWRWaWV3IGNvbjoiKQogICAgICAgICAgICBmb3IgaSwgZ3JpZHZpZXcgaW4gZW51bWVyYXRlKGNoaWxkX2dyaWR2aWV3cyk6CiAgICAgICAgICAgICAgICByZXNvdXJjZV9pZCA9IGdyaWR2aWV3LmdldCgicmVzb3VyY2UtaWQiLCAiTm8gSUQiKQogICAgICAgICAgICAgICAgYm91bmRzID0gZ3JpZHZpZXcuZ2V0KCJib3VuZHMiLCAiVW5rbm93biIpCiAgICAgICAgICAgICAgICBwcmludChmIiAgIHtpKzF9LiBJRDoge3Jlc291cmNlX2lkfSB8IEJvdW5kczoge2JvdW5kc30iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KCLwn5OKIEtow7RuZyB0w6xtIHRo4bqleSBHcmlkVmlldyBjb24gbsOgbyIpCiAgICAgICAgICAgIAogICAgZWxzZToKICAgICAgICBwcmludCgi4p2MIEtow7RuZyB0w6xtIHRo4bqleSBlbGVtZW50IGNoYSBwaMO5IGjhu6NwIMSR4buDIGRlbW8iKQogICAgICAgIHByaW50KCLwn5KhIFRo4butIG3hu58gbeG7mXQg4bupbmcgZOG7pW5nIGPDsyBnaWFvIGRp4buHbiBwaOG7qWMgdOG6oXAgaMahbiIpCgpkZWYgZGVtb19zcGVjaWZpY19zZWFyY2goKToKICAgICIiIgogICAgRGVtbyB0w6xtIGtp4bq/bSBj4bulIHRo4buDIHbhu5tpIG5oaeG7gXUgxJFp4buBdSBraeG7h24KICAgICIiIgogICAgcHJpbnQoIlxu8J+OryBEZW1vIFTDrG0gS2nhur9tIEPhu6UgVGjhu4MiKQogICAgcHJpbnQoIj0iICogNTApCiAgICAKICAgIGhlbHBlciA9IEhlbHBlclNlcnZpY2UoKQogICAgCiAgICAjIFTDrG0gdOG6pXQgY+G6oyBlbGVtZW50IGPDsyB0aOG7gyBjbGljawogICAgcHJpbnQoIjHvuI/ig6MgIFTDrG0gdOG6pXQgY+G6oyBlbGVtZW50IGPDsyBjbGlja2FibGU9J3RydWUnIikKICAgIGNsaWNrYWJsZV9lbGVtZW50cyA9IGhlbHBlci5maW5kX2FsbF9lbGVtZW50cyh2aXNpYmxlX3RvX3VzZXI9VHJ1ZSkKICAgIGNsaWNrYWJsZV9jb3VudCA9IDAKICAgIAogICAgZm9yIGVsZW1lbnQgaW4gY2xpY2thYmxlX2VsZW1lbnRzOgogICAgICAgIGlmIGVsZW1lbnQuZ2V0KCJjbGlja2FibGUiKSA9PSAidHJ1ZSI6CiAgICAgICAgICAgIGNsaWNrYWJsZV9jb3VudCArPSAxCiAgICAKICAgIHByaW50KGYi8J+Wse+4jyAgVMOsbSB0aOG6pXkge2NsaWNrYWJsZV9jb3VudH0gZWxlbWVudCBjw7MgdGjhu4MgY2xpY2siKQogICAgCiAgICAjIFTDrG0gZWxlbWVudCBjaGEgY8OzIG5oaeG7gXUgY29uIG5o4bqldAogICAgcHJpbnQoIlxuMu+4j+KDoyAgVMOsbSBlbGVtZW50IGNoYSBjw7Mgbmhp4buBdSBlbGVtZW50IGNvbiBuaOG6pXQiKQogICAgYWxsX2VsZW1lbnRzID0gaGVscGVyLmZpbmRfYWxsX2VsZW1lbnRzKCkKICAgIAogICAgaWYgYWxsX2VsZW1lbnRzOgogICAgICAgIG1heF9jaGlsZHJlbiA9IDAKICAgICAgICBiZXN0X3BhcmVudCA9IE5vbmUKICAgICAgICAKICAgICAgICBmb3IgZWxlbWVudCBpbiBhbGxfZWxlbWVudHNbOjEwXTogICMgQ2jhu4kgdGVzdCAxMCBlbGVtZW50IMSR4bqndSDEkeG7gyB0csOhbmggcXXDoSBjaOG6rW0KICAgICAgICAgICAgY2hpbGRyZW4gPSBoZWxwZXIuZmluZF9jaGlsZF9lbGVtZW50cyhlbGVtZW50KQogICAgICAgICAgICBpZiBsZW4oY2hpbGRyZW4pID4gbWF4X2NoaWxkcmVuOgogICAgICAgICAgICAgICAgbWF4X2NoaWxkcmVuID0gbGVuKGNoaWxkcmVuKQogICAgICAgICAgICAgICAgYmVzdF9wYXJlbnQgPSBlbGVtZW50CiAgICAgICAgCiAgICAgICAgaWYgYmVzdF9wYXJlbnQ6CiAgICAgICAgICAgIHBhcmVudF9jbGFzcyA9IGJlc3RfcGFyZW50LmdldCgiY2xhc3MiLCAiVW5rbm93biIpCiAgICAgICAgICAgIHBhcmVudF9pZCA9IGJlc3RfcGFyZW50LmdldCgicmVzb3VyY2UtaWQiLCAiTm8gSUQiKQogICAgICAgICAgICBwcmludChmIvCfkZEgRWxlbWVudCBjaGEgY8OzIG5oaeG7gXUgY29uIG5o4bqldDoge3BhcmVudF9jbGFzc30iKQogICAgICAgICAgICBwcmludChmIiAgIFJlc291cmNlIElEOiB7cGFyZW50X2lkfSIpCiAgICAgICAgICAgIHByaW50KGYiICAgU+G7kSBsxrDhu6NuZyBjb246IHttYXhfY2hpbGRyZW59IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludCgi4p2MIEtow7RuZyB0w6xtIHRo4bqleSBlbGVtZW50IGNoYSBwaMO5IGjhu6NwIikKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICB0cnk6CiAgICAgICAgcHJpbnQoIvCfmoAgQuG6r3QgxJHhuqd1IGRlbW8gRmluZCBDaGlsZCBFbGVtZW50cyIpCiAgICAgICAgZGVtb19maW5kX2NoaWxkX2VsZW1lbnRzKCkKICAgICAgICBkZW1vX3NwZWNpZmljX3NlYXJjaCgpCiAgICAgICAgcHJpbnQoIlxu4pyFIERlbW8gaG/DoG4gdGjDoG5oISIpCiAgICAgICAgCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgcHJpbnQoIlxuXG7ij7nvuI8gIERlbW8gYuG7iyBk4burbmcgYuG7n2kgbmfGsOG7nWkgZMO5bmciKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYiXG7inYwgTOG7l2kgdHJvbmcgcXXDoSB0csOsbmggZGVtbzoge2V9IikKICAgICAgICBpbXBvcnQgdHJhY2ViYWNrCiAgICAgICAgdHJhY2ViYWNrLnByaW50X2V4YygpCg==').decode('utf-8'))
