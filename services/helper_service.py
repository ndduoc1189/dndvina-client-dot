import base64
exec(base64.b64decode('aW1wb3J0IHJlcXVlc3RzCmltcG9ydCBqc29uCmltcG9ydCByYW5kb20KaW1wb3J0IHRpbWUKaW1wb3J0IHJlCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCBvcwppbXBvcnQgY29uZmlnCmZyb20gdHlwaW5nIGltcG9ydCBEaWN0LCBBbnksIE9wdGlvbmFsLCBUdXBsZSwgTGlzdCwgVW5pb24KdHJ5OgogICAgZnJvbSBseG1sIGltcG9ydCBldHJlZQogICAgTFhNTF9BVkFJTEFCTEUgPSBUcnVlCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIExYTUxfQVZBSUxBQkxFID0gRmFsc2UKCmNsYXNzIEhlbHBlclNlcnZpY2U6CiAgICBkZWYgX19pbml0X18oc2VsZiwgYmFzZV91cmw6IHN0ciA9ICJodHRwOi8vbG9jYWxob3N0OjgwODAiKToKICAgICAgICBzZWxmLmJhc2VfdXJsID0gYmFzZV91cmwKICAgICAgICBzZWxmLmlzX2FkYl9jb25uZWN0ZWQgPSBGYWxzZQogICAgICAgIHNlbGYuZGV2aWNlX2lwID0gTm9uZQogICAgICAgIAogICAgICAgICMgTuG6v3UgYmFzZV91cmwgY2jhu6lhIMSR4buLYSBjaOG7iSBJUCwgdGjhu60ga+G6v3QgbuG7kWkgQURCCiAgICAgICAgaXBfbWF0Y2ggPSByZS5zZWFyY2gociJodHRwOi8vKFswLTldK1wuWzAtOV0rXC5bMC05XStcLlswLTldKykiLCBiYXNlX3VybCkKICAgICAgICBpZiBpcF9tYXRjaDoKICAgICAgICAgICAgc2VsZi5kZXZpY2VfaXAgPSBpcF9tYXRjaC5ncm91cCgxKQogICAgICAgICAgICBzZWxmLmNoZWNrX2FuZF9jb25uZWN0X2FkYigpCgogICAgZGVmIGNoZWNrX2FuZF9jb25uZWN0X2FkYihzZWxmKSAtPiBib29sOgogICAgICAgICIiIgogICAgICAgIEtp4buDbSB0cmEgdsOgIGvhur90IG7hu5FpIEFEQiB04bubaSB0aGnhur90IGLhu4sKICAgICAgICAiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgS2nhu4NtIHRyYSBBREIgY8OzIMSRxrDhu6NjIGPDoGkgxJHhurd0IGtow7RuZwogICAgICAgICAgICBzdWJwcm9jZXNzLnJ1bihbImFkYiIsICItLXZlcnNpb24iXSwgY2hlY2s9VHJ1ZSwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgS+G6v3QgbuG7kWkgQURCIMSR4bq/biB0aGnhur90IGLhu4sgc+G7rSBk4bulbmcgxJHhu4thIGNo4buJIHThu6sgY29uZmlnCiAgICAgICAgICAgIGFkYl9hZGRyZXNzID0gZiJ7Y29uZmlnLkFEQl9IT1NUfTp7Y29uZmlnLkFEQl9QT1JUfSIKICAgICAgICAgICAgCiAgICAgICAgICAgICMgVGjhu60ga+G6v3QgbuG7kWkgxJHhur9uIHRoaeG6v3QgYuG7iwogICAgICAgICAgICBjb25uZWN0X3Byb2Nlc3MgPSBzdWJwcm9jZXNzLnJ1bigKICAgICAgICAgICAgICAgIFsiYWRiIiwgImNvbm5lY3QiLCBhZGJfYWRkcmVzc10sCiAgICAgICAgICAgICAgICBjaGVjaz1UcnVlLAogICAgICAgICAgICAgICAgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwKICAgICAgICAgICAgICAgIHN0ZGVycj1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgICAgICB0ZXh0PVRydWUKICAgICAgICAgICAgKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBLaeG7g20gdHJhIGvhur90IHF14bqjIGvhur90IG7hu5FpCiAgICAgICAgICAgIGlmICJjb25uZWN0ZWQiIGluIGNvbm5lY3RfcHJvY2Vzcy5zdGRvdXQubG93ZXIoKToKICAgICAgICAgICAgICAgIHNlbGYuaXNfYWRiX2Nvbm5lY3RlZCA9IFRydWUKICAgICAgICAgICAgICAgIHByaW50KGYixJDDoyBr4bq/dCBu4buRaSBBREIgdGjDoG5oIGPDtG5nIMSR4bq/biB7YWRiX2FkZHJlc3N9IikKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgICAgICAKICAgICAgICBleGNlcHQgKHN1YnByb2Nlc3MuU3VicHJvY2Vzc0Vycm9yLCBGaWxlTm90Rm91bmRFcnJvcikgYXMgZToKICAgICAgICAgICAgcHJpbnQoZiJLaMO0bmcgdGjhu4Mga+G6v3QgbuG7kWkgQURCOiB7ZX0iKQogICAgICAgIAogICAgICAgIHNlbGYuaXNfYWRiX2Nvbm5lY3RlZCA9IEZhbHNlCiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgZGVmIF9nZXRfYWRiX2RldmljZV9wYXJhbShzZWxmKSAtPiBMaXN0W3N0cl06CiAgICAgICAgIiIiCiAgICAgICAgVHLhuqMgduG7gSB0aGFtIHPhu5EgdGhp4bq/dCBi4buLIGNobyBs4buHbmggQURCCiAgICAgICAgCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgTGlzdFtzdHJdOiBEYW5oIHPDoWNoIHRoYW0gc+G7kSBbLXMsIGRldmljZV9pZF0gaG/hurdjIGxpc3QgcuG7l25nIG7hur91IGtow7RuZyBjw7MgdGhp4bq/dCBi4buLCiAgICAgICAgIiIiCiAgICAgICAgaWYgc2VsZi5pc19hZGJfY29ubmVjdGVkOgogICAgICAgICAgICBhZGJfYWRkcmVzcyA9IGYie2NvbmZpZy5BREJfSE9TVH06e2NvbmZpZy5BREJfUE9SVH0iCiAgICAgICAgICAgIHJldHVybiBbIi1zIiwgYWRiX2FkZHJlc3NdCiAgICAgICAgcmV0dXJuIFtdCgogICAgZGVmIF9tYWtlX3JlcXVlc3Qoc2VsZiwgZW5kcG9pbnQ6IHN0ciwgcGFyYW1zOiBEaWN0W3N0ciwgQW55XSA9IE5vbmUpIC0+IERpY3Rbc3RyLCBBbnldOgogICAgICAgICIiIgogICAgICAgIFRo4buxYyBoaeG7h24gcmVxdWVzdCBBUEkgdsOgIHRy4bqjIHbhu4Ega+G6v3QgcXXhuqMgZOG6oW5nIEpTT04gaG/hurdjIFhNTAogICAgICAgICIiIgogICAgICAgIHVybCA9IGYie3NlbGYuYmFzZV91cmx9L3tlbmRwb2ludH0iCiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIFRoaeG6v3QgbOG6rXAgdGltZW91dCBjaG8gcmVxdWVzdAogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwsIHBhcmFtcz1wYXJhbXMsIHRpbWVvdXQ9MTApCiAgICAgICAgICAgIHJlc3BvbnNlLnJhaXNlX2Zvcl9zdGF0dXMoKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBLaeG7g20gdHJhIENvbnRlbnQtVHlwZQogICAgICAgICAgICBjb250ZW50X3R5cGUgPSByZXNwb25zZS5oZWFkZXJzLmdldCgnQ29udGVudC1UeXBlJywgJycpCiAgICAgICAgICAgIGlmICdhcHBsaWNhdGlvbi94bWwnIGluIGNvbnRlbnRfdHlwZSBvciBlbmRwb2ludCA9PSAnZHVtcC1zY3JlZW4teG1sJzoKICAgICAgICAgICAgICAgICMgVHLhuqMgduG7gSBYTUwgZMaw4bubaSBk4bqhbmcgdGV4dAogICAgICAgICAgICAgICAgcmV0dXJuIHsic3RhdHVzIjogInN1Y2Nlc3MiLCAiZGF0YSI6IHJlc3BvbnNlLnRleHR9CiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIFRy4bqjIHbhu4EgSlNPTgogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKQogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlRpbWVvdXQ6CiAgICAgICAgICAgIHByaW50KGYiUmVxdWVzdCB0aW1lb3V0IGtoaSBn4buNaSB7dXJsfSwgdGjhu60ga2jhu59pIMSR4buZbmcgbOG6oWkgaGVscGVyIGFwcCIpCiAgICAgICAgICAgIHNlbGYuX3Jlc3RhcnRfaGVscGVyX2FwcCgpCiAgICAgICAgICAgICMgVGjhu60gbOG6oWkgcmVxdWVzdCBzYXUga2hpIGto4bufaSDEkeG7mW5nIGzhuqFpIGhlbHBlciBhcHAKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxKSAgIyBDaOG7nSAxIGdpw6J5IMSR4buDIOG7qW5nIGThu6VuZyBraOG7n2kgxJHhu5luZwogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCBwYXJhbXM9cGFyYW1zLCB0aW1lb3V0PTEwKQogICAgICAgICAgICAgICAgcmVzcG9uc2UucmFpc2VfZm9yX3N0YXR1cygpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGNvbnRlbnRfdHlwZSA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdDb250ZW50LVR5cGUnLCAnJykKICAgICAgICAgICAgICAgIGlmICdhcHBsaWNhdGlvbi94bWwnIGluIGNvbnRlbnRfdHlwZSBvciBlbmRwb2ludCA9PSAnZHVtcC1zY3JlZW4teG1sJzoKICAgICAgICAgICAgICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAic3VjY2VzcyIsICJkYXRhIjogcmVzcG9uc2UudGV4dH0KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKQogICAgICAgICAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBwcmludChmIlbhuqtuIGzhu5dpIHNhdSBraGkgdGjhu60ga2jhu59pIMSR4buZbmcgbOG6oWkgaGVscGVyIGFwcDoge2V9IikKICAgICAgICAgICAgICAgIHJldHVybiB7InN0YXR1cyI6ICJlcnJvciIsICJtZXNzYWdlIjogc3RyKGUpfQogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvciBhcyBlOgogICAgICAgICAgICAjIELhuq90IGzhu5dpIGvhur90IG7hu5FpIGLhu4sgdOG7qyBjaOG7kWkgaG/hurdjIGtow7RuZyB0aOG7gyBr4bq/dCBu4buRaQogICAgICAgICAgICBwcmludChmIkzhu5dpIGvhur90IG7hu5FpIGtoaSBn4buNaSB7dXJsfSwgdGjhu60ga2jhu59pIMSR4buZbmcgbOG6oWkgaGVscGVyIGFwcDoge2V9IikKICAgICAgICAgICAgc2VsZi5fcmVzdGFydF9oZWxwZXJfYXBwKCkKICAgICAgICAgICAgIyBUaOG7rSBs4bqhaSByZXF1ZXN0IHNhdSBraGkga2jhu59pIMSR4buZbmcgbOG6oWkgaGVscGVyIGFwcAogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDIpICAjIENo4budIDIgZ2nDonkgxJHhu4Mg4bupbmcgZOG7pW5nIGto4bufaSDEkeG7mW5nCiAgICAgICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwsIHBhcmFtcz1wYXJhbXMsIHRpbWVvdXQ9MTApCiAgICAgICAgICAgICAgICByZXNwb25zZS5yYWlzZV9mb3Jfc3RhdHVzKCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgY29udGVudF90eXBlID0gcmVzcG9uc2UuaGVhZGVycy5nZXQoJ0NvbnRlbnQtVHlwZScsICcnKQogICAgICAgICAgICAgICAgaWYgJ2FwcGxpY2F0aW9uL3htbCcgaW4gY29udGVudF90eXBlIG9yIGVuZHBvaW50ID09ICdkdW1wLXNjcmVlbi14bWwnOgogICAgICAgICAgICAgICAgICAgIHJldHVybiB7InN0YXR1cyI6ICJzdWNjZXNzIiwgImRhdGEiOiByZXNwb25zZS50ZXh0fQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpCiAgICAgICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHByaW50KGYiVuG6q24gbOG7l2kgc2F1IGtoaSB0aOG7rSBraOG7n2kgxJHhu5luZyBs4bqhaSBoZWxwZXIgYXBwOiB7ZX0iKQogICAgICAgICAgICAgICAgcmV0dXJuIHsic3RhdHVzIjogImVycm9yIiwgIm1lc3NhZ2UiOiBzdHIoZSl9CiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBwcmludChmIkzhu5dpIGtoaSB0aOG7sWMgaGnhu4duIHJlcXVlc3Q6IHtlfSIpCiAgICAgICAgICAgIHJldHVybiB7InN0YXR1cyI6ICJlcnJvciIsICJtZXNzYWdlIjogc3RyKGUpfQoKICAgIGRlZiBfcmVzdGFydF9oZWxwZXJfYXBwKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgIiIiCiAgICAgICAgS2jhu59pIMSR4buZbmcgbOG6oWkgaGVscGVyIGFwcCBz4butIGThu6VuZyBBREIKICAgICAgICAKICAgICAgICBSZXR1cm5zOgogICAgICAgICAgICBib29sOiBUcnVlIG7hur91IHRow6BuaCBjw7RuZywgRmFsc2UgbuG6v3UgdGjhuqV0IGLhuqFpCiAgICAgICAgIiIiCiAgICAgICAgaWYgc2VsZi5pc19hZGJfY29ubmVjdGVkOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAjIEzhuqV5IHRoYW0gc+G7kSB0aGnhur90IGLhu4sKICAgICAgICAgICAgICAgIGRldmljZV9wYXJhbXMgPSBzZWxmLl9nZXRfYWRiX2RldmljZV9wYXJhbSgpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgS2jhu59pIMSR4buZbmcgaGVscGVyIGFwcCBi4bqxbmcgQURCCiAgICAgICAgICAgICAgICBjbWQgPSBbImFkYiJdICsgZGV2aWNlX3BhcmFtcyArIFsic2hlbGwiLCAiYW0iLCAic3RhcnQiLCAiLW4iLCAiY29tLmRuZHZpbmEuaGVscGVyLy5NYWluQWN0aXZpdHkiXQogICAgICAgICAgICAgICAgc3VicHJvY2Vzcy5ydW4oCiAgICAgICAgICAgICAgICAgICAgY21kLAogICAgICAgICAgICAgICAgICAgIGNoZWNrPVRydWUsCiAgICAgICAgICAgICAgICAgICAgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwKICAgICAgICAgICAgICAgICAgICBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFLAogICAgICAgICAgICAgICAgICAgIHRleHQ9VHJ1ZQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgcHJpbnQoIsSQw6Mga2jhu59pIMSR4buZbmcgbOG6oWkgaGVscGVyIGFwcCBxdWEgQURCIikKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgIGV4Y2VwdCBzdWJwcm9jZXNzLlN1YnByb2Nlc3NFcnJvciBhcyBlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJM4buXaSBraGkga2jhu59pIMSR4buZbmcgbOG6oWkgaGVscGVyIGFwcCBxdWEgQURCOiB7ZX0iKQogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoIktow7RuZyB0aOG7gyBraOG7n2kgxJHhu5luZyBs4bqhaSBoZWxwZXIgYXBwIHbDrCBBREIgY2jGsGEgxJHGsOG7o2Mga+G6v3QgbuG7kWkiKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgdGFwKHNlbGYsIHg6IGludCwgeTogaW50KSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBDaOG6oW0gdsOgbyB24buLIHRyw60geCx5IHRyw6puIG3DoG4gaMOsbmgKICAgICAgICAiIiIKICAgICAgICByZXR1cm4gc2VsZi5fbWFrZV9yZXF1ZXN0KCJ0YXAiLCBwYXJhbXM9eyJ4IjogeCwgInkiOiB5fSkKCiAgICBkZWYgdGFwX2VsZW1lbnQoc2VsZiwgYm91bmRzOiBzdHIpIC0+IERpY3Rbc3RyLCBBbnldOgogICAgICAgICIiIgogICAgICAgIENo4bqhbSB2w6BvIG3hu5l0IHBo4bqnbiB04butIGThu7FhIHRyw6puIGJvdW5kcyBj4bunYSBuw7MKICAgICAgICBGb3JtYXQgYm91bmRzOiAiW3gxLHkxXVt4Mix5Ml0iCiAgICAgICAgIiIiCiAgICAgICAgIyBQaMOibiB0w61jaCBib3VuZHMgxJHhu4MgbOG6pXkgdOG7jWEgxJHhu5kKICAgICAgICBtYXRjaCA9IHJlLm1hdGNoKHIiXFsoXGQrKSwoXGQrKVxdXFsoXGQrKSwoXGQrKVxdIiwgYm91bmRzKQogICAgICAgIGlmIG1hdGNoOgogICAgICAgICAgICB4MSwgeTEsIHgyLCB5MiA9IG1hcChpbnQsIG1hdGNoLmdyb3VwcygpKQogICAgICAgICAgICAjIENo4buNbiBt4buZdCDEkWnhu4NtIG5n4bqrdSBuaGnDqm4gdHJvbmcgYm91bmRzCiAgICAgICAgICAgIHggPSByYW5kb20ucmFuZGludCh4MSwgeDIpCiAgICAgICAgICAgIHkgPSByYW5kb20ucmFuZGludCh5MSwgeTIpCiAgICAgICAgICAgIHJldHVybiBzZWxmLnRhcCh4LCB5KQogICAgICAgIHJldHVybiB7InN0YXR1cyI6ICJlcnJvciIsICJtZXNzYWdlIjogIsSQ4buLbmggZOG6oW5nIGJvdW5kcyBraMO0bmcgaOG7o3AgbOG7hyJ9CgogICAgZGVmIHN3aXBlX3VwKHNlbGYpIC0+IERpY3Rbc3RyLCBBbnldOgogICAgICAgICIiIgogICAgICAgIFZ14buRdCBsw6puIHThu6sgduG7iyB0csOtIG5n4bqrdSBuaGnDqm4gcGjDuSBo4bujcAogICAgICAgICIiIgogICAgICAgIHJldHVybiBzZWxmLl9tYWtlX3JlcXVlc3QoInN3aXBlX3VwIikKCiAgICBkZWYgc3dpcGVfZG93bihzZWxmKSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBWdeG7kXQgeHXhu5FuZyB04burIHbhu4sgdHLDrSBuZ+G6q3Ugbmhpw6puIHBow7kgaOG7o3AKICAgICAgICAiIiIKICAgICAgICByZXR1cm4gc2VsZi5fbWFrZV9yZXF1ZXN0KCJzd2lwZV9kb3duIikKCiAgICBkZWYgaW5wdXRfdGV4dChzZWxmLCB0ZXh0OiBzdHIsIHNwZWVkOiBmbG9hdCA9IDEuMCwgCiAgICAgICAgICAgICAgICAgIGRpcmVjdF9tb2RlOiBib29sID0gRmFsc2UsIHBlcmZlY3RfbW9kZTogYm9vbCA9IFRydWUpIC0+IERpY3Rbc3RyLCBBbnldOgogICAgICAgICIiIgogICAgICAgIE3DtCBwaOG7j25nIGfDtSBwaMOtbSB24bubaSB04buRYyDEkeG7mSBuZ+G6q3Ugbmhpw6puIGdp4buRbmcgbmfGsOG7nWkgdGjhuq10CiAgICAgICAgIiIiCiAgICAgICAgcGFyYW1zID0gewogICAgICAgICAgICAidGV4dCI6IHRleHQsCiAgICAgICAgICAgICJzcGVlZCI6IHNwZWVkLAogICAgICAgICAgICAiZGlyZWN0X21vZGUiOiBzdHIoZGlyZWN0X21vZGUpLmxvd2VyKCksCiAgICAgICAgICAgICJwZXJmZWN0X21vZGUiOiBzdHIocGVyZmVjdF9tb2RlKS5sb3dlcigpCiAgICAgICAgfQogICAgICAgIHJldHVybiBzZWxmLl9tYWtlX3JlcXVlc3QoImlucHV0X3RleHQiLCBwYXJhbXM9cGFyYW1zKQoKICAgIGRlZiBzaG93X3RvYXN0KHNlbGYsIG1lc3NhZ2U6IHN0ciwgdHlwZV86IHN0ciA9ICJpbmZvIiwgCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBzdHIgPSAiYm90dG9tIikgLT4gRGljdFtzdHIsIEFueV06CiAgICAgICAgIiIiCiAgICAgICAgSGnhu4NuIHRo4buLIHRow7RuZyBiw6FvIHRvYXN0CiAgICAgICAgIiIiCiAgICAgICAgcGFyYW1zID0gewogICAgICAgICAgICAibWVzc2FnZSI6IG1lc3NhZ2UsCiAgICAgICAgICAgICJ0eXBlIjogdHlwZV8sCiAgICAgICAgICAgICJwb3NpdGlvbiI6IHBvc2l0aW9uCiAgICAgICAgfQogICAgICAgIHJldHVybiBzZWxmLl9tYWtlX3JlcXVlc3QoInRvYXN0LW1lc3NhZ2UiLCBwYXJhbXM9cGFyYW1zKQoKICAgIGRlZiBnZXRfZGV2aWNlX2luZm8oc2VsZikgLT4gRGljdFtzdHIsIEFueV06CiAgICAgICAgIiIiCiAgICAgICAgTOG6pXkgdGjDtG5nIHRpbiBjaGkgdGnhur90IHbhu4EgdGhp4bq/dCBi4buLCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX21ha2VfcmVxdWVzdCgiZGV2aWNlLWluZm8iKQoKICAgIGRlZiBkdW1wX3NjcmVlbl94bWwoc2VsZikgLT4gc3RyOgogICAgICAgICIiIgogICAgICAgIER1bXAgdG/DoG4gYuG7mSBj4bqldSB0csO6YyBYTUwgY+G7p2EgbcOgbiBow6xuaCBoaeG7h24gdOG6oWkKICAgICAgICAKICAgICAgICBUcuG6oyB24buBIG7hu5lpIGR1bmcgWE1MIGTGsOG7m2kgZOG6oW5nIGNodeG7l2kKICAgICAgICAiIiIKICAgICAgICByZXNwb25zZSA9IHNlbGYuX21ha2VfcmVxdWVzdCgiZHVtcC1zY3JlZW4teG1sIikKICAgICAgICBpZiByZXNwb25zZVsic3RhdHVzIl0gPT0gInN1Y2Nlc3MiOgogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2VbImRhdGEiXQogICAgICAgIHJldHVybiAiIgoKICAgIGRlZiBvcGVuX2FwcChzZWxmLCBwYWNrYWdlOiBzdHIsIGFjdGl2aXR5OiBzdHIgPSBOb25lKSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBN4bufIG3hu5l0IOG7qW5nIGThu6VuZyB24bubaSBwYWNrYWdlIG5hbWUgdsOgIGFjdGl2aXR5IGPhu6UgdGjhu4MKICAgICAgICAiIiIKICAgICAgICBwYXJhbXMgPSB7InBhY2thZ2UiOiBwYWNrYWdlfQogICAgICAgIGlmIGFjdGl2aXR5OgogICAgICAgICAgICBwYXJhbXNbImFjdGl2aXR5Il0gPSBhY3Rpdml0eQogICAgICAgIHJldHVybiBzZWxmLl9tYWtlX3JlcXVlc3QoIm9wZW5fYXBwIiwgcGFyYW1zPXBhcmFtcykKCiAgICBkZWYgY2xvc2VfYXBwKHNlbGYsIHBhY2thZ2U6IHN0cikgLT4gRGljdFtzdHIsIEFueV06CiAgICAgICAgIiIiCiAgICAgICAgxJDDs25nIG3hu5l0IOG7qW5nIGThu6VuZyDEkWFuZyBjaOG6oXkKICAgICAgICDGr3UgdGnDqm4gc+G7rSBk4bulbmcgQURCIG7hur91IMSRw6Mga+G6v3QgbuG7kWkKICAgICAgICAiIiIKICAgICAgICBpZiBzZWxmLmlzX2FkYl9jb25uZWN0ZWQ6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICMgTOG6pXkgdGhhbSBz4buRIHRoaeG6v3QgYuG7iwogICAgICAgICAgICAgICAgZGV2aWNlX3BhcmFtcyA9IHNlbGYuX2dldF9hZGJfZGV2aWNlX3BhcmFtKCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyDEkMOzbmcg4bupbmcgZOG7pW5nIGLhurFuZyBBREIKICAgICAgICAgICAgICAgIGNtZCA9IFsiYWRiIl0gKyBkZXZpY2VfcGFyYW1zICsgWyJzaGVsbCIsIGYiYW0gZm9yY2Utc3RvcCB7cGFja2FnZX0iXQogICAgICAgICAgICAgICAgc3VicHJvY2Vzcy5ydW4oCiAgICAgICAgICAgICAgICAgICAgY21kLAogICAgICAgICAgICAgICAgICAgIGNoZWNrPVRydWUsCiAgICAgICAgICAgICAgICAgICAgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwKICAgICAgICAgICAgICAgICAgICBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAic3VjY2VzcyIsICJtZXNzYWdlIjogZiLEkMOjIMSRw7NuZyB7cGFja2FnZX0gYuG6sW5nIEFEQiJ9CiAgICAgICAgICAgIGV4Y2VwdCBzdWJwcm9jZXNzLlN1YnByb2Nlc3NFcnJvciBhcyBlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJM4buXaSBraGkgxJHDs25nIOG7qW5nIGThu6VuZyBi4bqxbmcgQURCOiB7ZX0iKQogICAgICAgICAgICAgICAgIyBO4bq/dSBs4buXaSwgdGjhu60gcGjGsMahbmcgdGjhu6ljIEhUVFAKICAgICAgICAKICAgICAgICAjIFPhu60gZOG7pW5nIEhUVFAgQVBJIG7hur91IGtow7RuZyBjw7MgQURCIGhv4bq3YyBBREIgYuG7iyBs4buXaQogICAgICAgIHJldHVybiBzZWxmLl9tYWtlX3JlcXVlc3QoInByZXNzX2hvbWUiKQoKICAgIGRlZiBfc2FuaXRpemVfeG1sKHNlbGYsIHhtbF9jb250ZW50OiBzdHIpIC0+IHN0cjoKICAgICAgICAiIiIKICAgICAgICBY4butIGzDvSBjw6FjIGvDvSB04buxIMSR4bq3YyBiaeG7h3QgdHJvbmcgWE1MIMSR4buDIHRyw6FuaCBs4buXaSBraGkgcGjDom4gdMOtY2gKICAgICAgICAKICAgICAgICBBcmdzOgogICAgICAgICAgICB4bWxfY29udGVudDogQ2h14buXaSBYTUwgY+G6p24geOG7rSBsw70KICAgICAgICAgICAgCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgc3RyOiBDaHXhu5dpIFhNTCDEkcOjIMSRxrDhu6NjIHjhu60gbMO9CiAgICAgICAgIiIiCiAgICAgICAgIyBUaGF5IHRo4bq/IGPDoWMga8O9IHThu7EgJiBraMO0bmcgaOG7o3AgbOG7hyBi4bqxbmcgJmFtcDsKICAgICAgICAjIE5oxrBuZyBnaeG7ryBuZ3V5w6puIGPDoWMgZW50aXR5IGjhu6NwIGzhu4cgbmjGsCAmYW1wOywgJmx0OywgJmd0OywgJnF1b3Q7LCAmYXBvczsKICAgICAgICB4bWxfY29udGVudCA9IHJlLnN1YihyJyYoPyEoYW1wfGx0fGd0fHF1b3R8YXBvcyk7KScsICcmYW1wOycsIHhtbF9jb250ZW50KQogICAgICAgIAogICAgICAgICMgTG/huqFpIGLhu48gY8OhYyBrw70gdOG7sSDEkWnhu4F1IGtoaeG7g24ga2jDtG5nIGjhu6NwIGzhu4cgdHJvbmcgWE1MCiAgICAgICAgeG1sX2NvbnRlbnQgPSByZS5zdWIocidbXHgwMC1ceDA4XHgwQlx4MENceDBFLVx4MUZdJywgJycsIHhtbF9jb250ZW50KQogICAgICAgIAogICAgICAgIHJldHVybiB4bWxfY29udGVudAoKICAgIGRlZiBmaW5kX2VsZW1lbnRfaW5feG1sKHNlbGYsIHhtbF9jb250ZW50OiBzdHIsIAogICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHN0ciA9IE5vbmUsIGNvbnRlbnRfZGVzYzogc3RyID0gTm9uZSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VfaWQ6IHN0ciA9IE5vbmUsIGNsYXNzX25hbWU6IHN0ciA9IE5vbmUpIC0+IE9wdGlvbmFsW0RpY3Rbc3RyLCBBbnldXToKICAgICAgICAiIiIKICAgICAgICBUw6xtIHBo4bqnbiB04butIHRyb25nIFhNTCBk4buxYSB0csOqbiB0ZXh0LCBjb250ZW50LWRlc2MsIHJlc291cmNlLWlkIGhv4bq3YyBjbGFzcwogICAgICAgIAogICAgICAgIEFyZ3M6CiAgICAgICAgICAgIHhtbF9jb250ZW50OiBO4buZaSBkdW5nIFhNTAogICAgICAgICAgICB0ZXh0OiBUZXh0IGPhu6dhIHBo4bqnbiB04butIGPhuqduIHTDrG0KICAgICAgICAgICAgY29udGVudF9kZXNjOiBDb250ZW50IGRlc2NyaXB0aW9uIGPhu6dhIHBo4bqnbiB04butIGPhuqduIHTDrG0KICAgICAgICAgICAgcmVzb3VyY2VfaWQ6IFJlc291cmNlIElEIGPhu6dhIHBo4bqnbiB04butIGPhuqduIHTDrG0KICAgICAgICAgICAgY2xhc3NfbmFtZTogQ2xhc3MgbmFtZSBj4bunYSBwaOG6p24gdOG7rSBj4bqnbiB0w6xtCiAgICAgICAgICAgIAogICAgICAgIFJldHVybnM6CiAgICAgICAgICAgIE9wdGlvbmFsW0RpY3Rbc3RyLCBBbnldXTogUGjhuqduIHThu60gxJHhuqd1IHRpw6puIHTDrG0gdGjhuqV5IGhv4bq3YyBOb25lIG7hur91IGtow7RuZyB0w6xtIHRo4bqleQogICAgICAgICIiIgogICAgICAgIGlmIG5vdCB4bWxfY29udGVudDoKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICAgICAgCiAgICAgICAgaWYgTFhNTF9BVkFJTEFCTEU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICMgWOG7rSBsw70gY8OhYyBrw70gdOG7sSDEkeG6t2MgYmnhu4d0IHRyb25nIFhNTAogICAgICAgICAgICAgICAgeG1sX2NvbnRlbnQgPSBzZWxmLl9zYW5pdGl6ZV94bWwoeG1sX2NvbnRlbnQpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgUGFyc2UgWE1MIHbhu5tpIHTDuXkgY2jhu41uIHJlY292ZXIgxJHhu4MgeOG7rSBsw70gbOG7l2kKICAgICAgICAgICAgICAgIHBhcnNlciA9IGV0cmVlLlhNTFBhcnNlcihyZWNvdmVyPVRydWUpCiAgICAgICAgICAgICAgICByb290ID0gZXRyZWUuZnJvbXN0cmluZyh4bWxfY29udGVudC5lbmNvZGUoJ3V0Zi04JyksIHBhcnNlcj1wYXJzZXIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgWMOieSBk4buxbmcgWFBhdGggcXVlcnkgZOG7sWEgdHLDqm4gY8OhYyDEkWnhu4F1IGtp4buHbgogICAgICAgICAgICAgICAgY29uZGl0aW9ucyA9IFtdCiAgICAgICAgICAgICAgICBpZiB0ZXh0IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbnMuYXBwZW5kKGYnQHRleHQ9Int0ZXh0fSInKQogICAgICAgICAgICAgICAgaWYgY29udGVudF9kZXNjIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbnMuYXBwZW5kKGYnQGNvbnRlbnQtZGVzYz0ie2NvbnRlbnRfZGVzY30iJykKICAgICAgICAgICAgICAgIGlmIHJlc291cmNlX2lkIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbnMuYXBwZW5kKGYnQHJlc291cmNlLWlkPSJ7cmVzb3VyY2VfaWR9IicpCiAgICAgICAgICAgICAgICBpZiBjbGFzc19uYW1lIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbnMuYXBwZW5kKGYnQGNsYXNzPSJ7Y2xhc3NfbmFtZX0iJykKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgeHBhdGhfcXVlcnkgPSAiLy9ub2RlIgogICAgICAgICAgICAgICAgaWYgY29uZGl0aW9uczoKICAgICAgICAgICAgICAgICAgICB4cGF0aF9xdWVyeSArPSAiWyIgKyAiIGFuZCAiLmpvaW4oY29uZGl0aW9ucykgKyAiXSIKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBUw6xtIHBo4bqnbiB04butIMSR4bqndSB0acOqbiBwaMO5IGjhu6NwCiAgICAgICAgICAgICAgICBlbGVtZW50ID0gcm9vdC54cGF0aCh4cGF0aF9xdWVyeSkKICAgICAgICAgICAgICAgIGlmIGVsZW1lbnQ6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2VsZW1lbnRfdG9fZGljdChlbGVtZW50WzBdKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBwcmludChmIkzhu5dpIGtoaSB0w6xtIHBo4bqnbiB04butIHbhu5tpIGx4bWw6IHtlfSIpCiAgICAgICAgCiAgICAgICAgIyBGYWxsYmFjazogVMOsbSBraeG6v20gYuG6sW5nIHJlZ2V4CiAgICAgICAgaWYgdGV4dDoKICAgICAgICAgICAgcGF0dGVybiA9IGYndGV4dD0ie3RleHR9IicKICAgICAgICAgICAgbWF0Y2ggPSByZS5zZWFyY2gocGF0dGVybiwgeG1sX2NvbnRlbnQpCiAgICAgICAgICAgIGlmIG1hdGNoOgogICAgICAgICAgICAgICAgIyBUw6xtIHRo4bq7IG5vZGUgY2jhu6lhIHRleHQKICAgICAgICAgICAgICAgIHN0YXJ0X3BvcyA9IHhtbF9jb250ZW50LnJmaW5kKCc8bm9kZScsIDAsIG1hdGNoLnN0YXJ0KCkpCiAgICAgICAgICAgICAgICBpZiBzdGFydF9wb3MgIT0gLTE6CiAgICAgICAgICAgICAgICAgICAgZW5kX3BvcyA9IHhtbF9jb250ZW50LmZpbmQoJz4nLCBzdGFydF9wb3MpICsgMQogICAgICAgICAgICAgICAgICAgIG5vZGVfY29udGVudCA9IHhtbF9jb250ZW50W3N0YXJ0X3BvczplbmRfcG9zXQogICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLl9leHRyYWN0X2F0dHJpYnV0ZXMobm9kZV9jb250ZW50KQogICAgICAgIAogICAgICAgIGlmIGNvbnRlbnRfZGVzYzoKICAgICAgICAgICAgcGF0dGVybiA9IGYnY29udGVudC1kZXNjPSJ7Y29udGVudF9kZXNjfSInCiAgICAgICAgICAgIG1hdGNoID0gcmUuc2VhcmNoKHBhdHRlcm4sIHhtbF9jb250ZW50KQogICAgICAgICAgICBpZiBtYXRjaDoKICAgICAgICAgICAgICAgICMgVMOsbSB0aOG6uyBub2RlIGNo4bupYSBjb250ZW50LWRlc2MKICAgICAgICAgICAgICAgIHN0YXJ0X3BvcyA9IHhtbF9jb250ZW50LnJmaW5kKCc8bm9kZScsIDAsIG1hdGNoLnN0YXJ0KCkpCiAgICAgICAgICAgICAgICBpZiBzdGFydF9wb3MgIT0gLTE6CiAgICAgICAgICAgICAgICAgICAgZW5kX3BvcyA9IHhtbF9jb250ZW50LmZpbmQoJz4nLCBzdGFydF9wb3MpICsgMQogICAgICAgICAgICAgICAgICAgIG5vZGVfY29udGVudCA9IHhtbF9jb250ZW50W3N0YXJ0X3BvczplbmRfcG9zXQogICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLl9leHRyYWN0X2F0dHJpYnV0ZXMobm9kZV9jb250ZW50KQogICAgICAgIAogICAgICAgIGlmIHJlc291cmNlX2lkOgogICAgICAgICAgICBwYXR0ZXJuID0gZidyZXNvdXJjZS1pZD0ie3Jlc291cmNlX2lkfSInCiAgICAgICAgICAgIG1hdGNoID0gcmUuc2VhcmNoKHBhdHRlcm4sIHhtbF9jb250ZW50KQogICAgICAgICAgICBpZiBtYXRjaDoKICAgICAgICAgICAgICAgICMgVMOsbSB0aOG6uyBub2RlIGNo4bupYSByZXNvdXJjZS1pZAogICAgICAgICAgICAgICAgc3RhcnRfcG9zID0geG1sX2NvbnRlbnQucmZpbmQoJzxub2RlJywgMCwgbWF0Y2guc3RhcnQoKSkKICAgICAgICAgICAgICAgIGlmIHN0YXJ0X3BvcyAhPSAtMToKICAgICAgICAgICAgICAgICAgICBlbmRfcG9zID0geG1sX2NvbnRlbnQuZmluZCgnPicsIHN0YXJ0X3BvcykgKyAxCiAgICAgICAgICAgICAgICAgICAgbm9kZV9jb250ZW50ID0geG1sX2NvbnRlbnRbc3RhcnRfcG9zOmVuZF9wb3NdCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2V4dHJhY3RfYXR0cmlidXRlcyhub2RlX2NvbnRlbnQpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgaWYgY2xhc3NfbmFtZToKICAgICAgICAgICAgcGF0dGVybiA9IGYnY2xhc3M9IntjbGFzc19uYW1lfSInCiAgICAgICAgICAgIG1hdGNoID0gcmUuc2VhcmNoKHBhdHRlcm4sIHhtbF9jb250ZW50KQogICAgICAgICAgICBpZiBtYXRjaDoKICAgICAgICAgICAgICAgICMgVMOsbSB0aOG6uyBub2RlIGNo4bupYSBjbGFzcwogICAgICAgICAgICAgICAgc3RhcnRfcG9zID0geG1sX2NvbnRlbnQucmZpbmQoJzxub2RlJywgMCwgbWF0Y2guc3RhcnQoKSkKICAgICAgICAgICAgICAgIGlmIHN0YXJ0X3BvcyAhPSAtMToKICAgICAgICAgICAgICAgICAgICBlbmRfcG9zID0geG1sX2NvbnRlbnQuZmluZCgnPicsIHN0YXJ0X3BvcykgKyAxCiAgICAgICAgICAgICAgICAgICAgbm9kZV9jb250ZW50ID0geG1sX2NvbnRlbnRbc3RhcnRfcG9zOmVuZF9wb3NdCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2V4dHJhY3RfYXR0cmlidXRlcyhub2RlX2NvbnRlbnQpCiAgICAgICAgCiAgICAgICAgcmV0dXJuIE5vbmUKICAgIAogICAgZGVmIGZpbmRfYWxsX2VsZW1lbnRzX2luX3htbChzZWxmLCB4bWxfY29udGVudDogc3RyLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHN0ciA9IE5vbmUsIGNvbnRlbnRfZGVzYzogc3RyID0gTm9uZSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZV9pZDogc3RyID0gTm9uZSwgY2xhc3NfbmFtZTogc3RyID0gTm9uZSkgLT4gTGlzdFtEaWN0W3N0ciwgQW55XV06CiAgICAgICAgIiIiCiAgICAgICAgVMOsbSB04bqldCBj4bqjIGPDoWMgcGjhuqduIHThu60gdHJvbmcgWE1MIHBow7kgaOG7o3AgduG7m2kgxJFp4buBdSBraeG7h24KICAgICAgICAiIiIKICAgICAgICByZXN1bHRzID0gW10KICAgICAgICAKICAgICAgICBpZiBub3QgeG1sX2NvbnRlbnQ6CiAgICAgICAgICAgIHJldHVybiByZXN1bHRzCiAgICAgICAgICAgIAogICAgICAgIGlmIExYTUxfQVZBSUxBQkxFOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAjIFjhu60gbMO9IGPDoWMga8O9IHThu7EgxJHhurdjIGJp4buHdCB0cm9uZyBYTUwgxJHhu4MgdHLDoW5oIGzhu5dpIEVudGl0eVJlZgogICAgICAgICAgICAgICAgeG1sX2NvbnRlbnQgPSBzZWxmLl9zYW5pdGl6ZV94bWwoeG1sX2NvbnRlbnQpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgUGFyc2UgWE1MIHbhu5tpIHTDuXkgY2jhu41uIHJlY292ZXIgxJHhu4MgeOG7rSBsw70gbOG7l2kKICAgICAgICAgICAgICAgIHBhcnNlciA9IGV0cmVlLlhNTFBhcnNlcihyZWNvdmVyPVRydWUpCiAgICAgICAgICAgICAgICByb290ID0gZXRyZWUuZnJvbXN0cmluZyh4bWxfY29udGVudC5lbmNvZGUoJ3V0Zi04JyksIHBhcnNlcj1wYXJzZXIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgWMOieSBk4buxbmcgWFBhdGggcXVlcnkgZOG7sWEgdHLDqm4gY8OhYyDEkWnhu4F1IGtp4buHbgogICAgICAgICAgICAgICAgY29uZGl0aW9ucyA9IFtdCiAgICAgICAgICAgICAgICBpZiB0ZXh0IGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbnMuYXBwZW5kKGYnQHRleHQ9Int0ZXh0fSInKQogICAgICAgICAgICAgICAgaWYgY29udGVudF9kZXNjIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbnMuYXBwZW5kKGYnQGNvbnRlbnQtZGVzYz0ie2NvbnRlbnRfZGVzY30iJykKICAgICAgICAgICAgICAgIGlmIHJlc291cmNlX2lkIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbnMuYXBwZW5kKGYnQHJlc291cmNlLWlkPSJ7cmVzb3VyY2VfaWR9IicpCiAgICAgICAgICAgICAgICBpZiBjbGFzc19uYW1lIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgICAgIGNvbmRpdGlvbnMuYXBwZW5kKGYnQGNsYXNzPSJ7Y2xhc3NfbmFtZX0iJykKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgeHBhdGhfcXVlcnkgPSAiLy9ub2RlIgogICAgICAgICAgICAgICAgaWYgY29uZGl0aW9uczoKICAgICAgICAgICAgICAgICAgICB4cGF0aF9xdWVyeSArPSAiWyIgKyAiIGFuZCAiLmpvaW4oY29uZGl0aW9ucykgKyAiXSIKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBUw6xtIHThuqV0IGPhuqMgcGjhuqduIHThu60gcGjDuSBo4bujcAogICAgICAgICAgICAgICAgZWxlbWVudHMgPSByb290LnhwYXRoKHhwYXRoX3F1ZXJ5KQogICAgICAgICAgICAgICAgZm9yIGVsZW1lbnQgaW4gZWxlbWVudHM6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoc2VsZi5fZWxlbWVudF90b19kaWN0KGVsZW1lbnQpKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICBwcmludChmIkzhu5dpIGtoaSB0w6xtIHBo4bqnbiB04butIHbhu5tpIGx4bWw6IHtlfSIpCiAgICAgICAgICAgICAgICBwcmludChmIlRo4butIHTDrG0gcGjhuqduIHThu60gYuG6sW5nIHBoxrDGoW5nIHRo4bupYyB0aGF5IHRo4bq/Li4uIikKICAgICAgICAKICAgICAgICAjIEZhbGxiYWNrOiBUw6xtIGtp4bq/bSBi4bqxbmcgcmVnZXggKGNo4buJIHRy4bqjIHbhu4Ega+G6v3QgcXXhuqMgxJHGoW4gZ2nhuqNuKQogICAgICAgIGlmIG5vdCByZXN1bHRzIGFuZCB0ZXh0OgogICAgICAgICAgICBwYXR0ZXJuID0gZid0ZXh0PSJ7dGV4dH0iJwogICAgICAgICAgICBmb3IgbWF0Y2ggaW4gcmUuZmluZGl0ZXIocGF0dGVybiwgeG1sX2NvbnRlbnQpOgogICAgICAgICAgICAgICAgc3RhcnRfcG9zID0geG1sX2NvbnRlbnQucmZpbmQoJzxub2RlJywgMCwgbWF0Y2guc3RhcnQoKSkKICAgICAgICAgICAgICAgIGlmIHN0YXJ0X3BvcyAhPSAtMToKICAgICAgICAgICAgICAgICAgICBlbmRfcG9zID0geG1sX2NvbnRlbnQuZmluZCgnPicsIHN0YXJ0X3BvcykgKyAxCiAgICAgICAgICAgICAgICAgICAgbm9kZV9jb250ZW50ID0geG1sX2NvbnRlbnRbc3RhcnRfcG9zOmVuZF9wb3NdCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5hcHBlbmQoc2VsZi5fZXh0cmFjdF9hdHRyaWJ1dGVzKG5vZGVfY29udGVudCkpCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdHMKICAgIAogICAgZGVmIF9leHRyYWN0X2F0dHJpYnV0ZXMoc2VsZiwgbm9kZV9jb250ZW50OiBzdHIpIC0+IERpY3Rbc3RyLCBBbnldOgogICAgICAgICIiIgogICAgICAgIFRyw61jaCB4deG6pXQgY8OhYyB0aHXhu5ljIHTDrW5oIHThu6sgbuG7mWkgZHVuZyBj4bunYSBt4buZdCB0aOG6uyBub2RlCiAgICAgICAgIiIiCiAgICAgICAgYXR0cmlidXRlcyA9IHt9CiAgICAgICAgCiAgICAgICAgIyBDw6FjIHRodeG7mWMgdMOtbmggY+G6p24gdHLDrWNoIHh14bqldAogICAgICAgIGF0dHJfcGF0dGVybnMgPSB7CiAgICAgICAgICAgICJjbGFzcyI6IHInY2xhc3M9IihbXiJdKikiJywKICAgICAgICAgICAgInBhY2thZ2UiOiByJ3BhY2thZ2U9IihbXiJdKikiJywKICAgICAgICAgICAgInJlc291cmNlLWlkIjogcidyZXNvdXJjZS1pZD0iKFteIl0qKSInLAogICAgICAgICAgICAidGV4dCI6IHIndGV4dD0iKFteIl0qKSInLAogICAgICAgICAgICAiY29udGVudC1kZXNjIjogcidjb250ZW50LWRlc2M9IihbXiJdKikiJywKICAgICAgICAgICAgImJvdW5kcyI6IHInYm91bmRzPSIoW14iXSopIicsCiAgICAgICAgICAgICJjaGVja2FibGUiOiByJ2NoZWNrYWJsZT0iKFteIl0qKSInLAogICAgICAgICAgICAiY2hlY2tlZCI6IHInY2hlY2tlZD0iKFteIl0qKSInLAogICAgICAgICAgICAiY2xpY2thYmxlIjogcidjbGlja2FibGU9IihbXiJdKikiJywKICAgICAgICAgICAgImVuYWJsZWQiOiByJ2VuYWJsZWQ9IihbXiJdKikiJywKICAgICAgICAgICAgImZvY3VzYWJsZSI6IHInZm9jdXNhYmxlPSIoW14iXSopIicsCiAgICAgICAgICAgICJmb2N1c2VkIjogcidmb2N1c2VkPSIoW14iXSopIicsCiAgICAgICAgICAgICJzY3JvbGxhYmxlIjogcidzY3JvbGxhYmxlPSIoW14iXSopIicsCiAgICAgICAgICAgICJsb25nLWNsaWNrYWJsZSI6IHInbG9uZy1jbGlja2FibGU9IihbXiJdKikiJywKICAgICAgICAgICAgInBhc3N3b3JkIjogcidwYXNzd29yZD0iKFteIl0qKSInLAogICAgICAgICAgICAic2VsZWN0ZWQiOiByJ3NlbGVjdGVkPSIoW14iXSopIicKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgZm9yIGF0dHJfbmFtZSwgcGF0dGVybiBpbiBhdHRyX3BhdHRlcm5zLml0ZW1zKCk6CiAgICAgICAgICAgIG1hdGNoID0gcmUuc2VhcmNoKHBhdHRlcm4sIG5vZGVfY29udGVudCkKICAgICAgICAgICAgaWYgbWF0Y2g6CiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzW2F0dHJfbmFtZV0gPSBtYXRjaC5ncm91cCgxKQogICAgICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIGF0dHJpYnV0ZXMKCiAgICBkZWYgX2VsZW1lbnRfdG9fZGljdChzZWxmLCBlbGVtZW50KSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBDaHV54buDbiDEkeG7lWkgbeG7mXQgcGjhuqduIHThu60gWE1MIHThu6sgbHhtbCB0aMOgbmggZGljdAogICAgICAgICIiIgogICAgICAgIHJlc3VsdCA9IHt9CiAgICAgICAgCiAgICAgICAgIyBM4bqleSB04bqldCBj4bqjIHRodeG7mWMgdMOtbmgKICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBlbGVtZW50LmF0dHJpYi5pdGVtcygpOgogICAgICAgICAgICByZXN1bHRba2V5XSA9IHZhbHVlCiAgICAgICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQKCiAgICBkZWYgZmluZF9lbGVtZW50KHNlbGYsIHRleHQ6IHN0ciA9IE5vbmUsIGNvbnRlbnRfZGVzYzogc3RyID0gTm9uZSwgCiAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VfaWQ6IHN0ciA9IE5vbmUsIGNsYXNzX25hbWU6IHN0ciA9IE5vbmUpIC0+IE9wdGlvbmFsW0RpY3Rbc3RyLCBBbnldXToKICAgICAgICAiIiIKICAgICAgICBUw6xtIHBo4bqnbiB04butIHRyw6puIG3DoG4gaMOsbmggZOG7sWEgdHLDqm4gdGV4dCwgY29udGVudC1kZXNjLCByZXNvdXJjZS1pZCBob+G6t2MgY2xhc3MKICAgICAgICAiIiIKICAgICAgICB4bWxfY29udGVudCA9IHNlbGYuZHVtcF9zY3JlZW5feG1sKCkKICAgICAgICByZXR1cm4gc2VsZi5maW5kX2VsZW1lbnRfaW5feG1sKHhtbF9jb250ZW50LCB0ZXh0LCBjb250ZW50X2Rlc2MsIHJlc291cmNlX2lkLCBjbGFzc19uYW1lKQoKICAgIGRlZiBmaW5kX2FsbF9lbGVtZW50cyhzZWxmLCB0ZXh0OiBzdHIgPSBOb25lLCBjb250ZW50X2Rlc2M6IHN0ciA9IE5vbmUsIAogICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZV9pZDogc3RyID0gTm9uZSwgY2xhc3NfbmFtZTogc3RyID0gTm9uZSkgLT4gTGlzdFtEaWN0W3N0ciwgQW55XV06CiAgICAgICAgIiIiCiAgICAgICAgVMOsbSB04bqldCBj4bqjIGPDoWMgcGjhuqduIHThu60gdHLDqm4gbcOgbiBow6xuaCBwaMO5IGjhu6NwIHbhu5tpIMSRaeG7gXUga2nhu4duCiAgICAgICAgIiIiCiAgICAgICAgeG1sX2NvbnRlbnQgPSBzZWxmLmR1bXBfc2NyZWVuX3htbCgpCiAgICAgICAgcmV0dXJuIHNlbGYuZmluZF9hbGxfZWxlbWVudHNfaW5feG1sKHhtbF9jb250ZW50LCB0ZXh0LCBjb250ZW50X2Rlc2MsIHJlc291cmNlX2lkLCBjbGFzc19uYW1lKQoKICAgIGRlZiBpc19lbGVtZW50X3NlbGVjdGVkKHNlbGYsIGVsZW1lbnQ6IERpY3Rbc3RyLCBBbnldKSAtPiBib29sOgogICAgICAgICIiIgogICAgICAgIEtp4buDbSB0cmEgeGVtIHBo4bqnbiB04butIGPDsyDEkcaw4bujYyBjaOG7jW4gaGF5IGtow7RuZwogICAgICAgICIiIgogICAgICAgIHJldHVybiBlbGVtZW50LmdldCgic2VsZWN0ZWQiKSA9PSAidHJ1ZSIKCiAgICBkZWYgd2FpdF9mb3JfZWxlbWVudChzZWxmLCB0ZXh0OiBzdHIgPSBOb25lLCBjb250ZW50X2Rlc2M6IHN0ciA9IE5vbmUsIAogICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZV9pZDogc3RyID0gTm9uZSwgdGltZW91dDogaW50ID0gMzAsIAogICAgICAgICAgICAgICAgICAgICAgICBjaGVja19pbnRlcnZhbDogaW50ID0gMSkgLT4gT3B0aW9uYWxbRGljdFtzdHIsIEFueV1dOgogICAgICAgICIiIgogICAgICAgIENo4budIMSR4bujaSBjaG8gxJHhur9uIGtoaSBt4buZdCBwaOG6p24gdOG7rSB4deG6pXQgaGnhu4duIHRyw6puIG3DoG4gaMOsbmgKICAgICAgICAiIiIKICAgICAgICBzdGFydF90aW1lID0gdGltZS50aW1lKCkKICAgICAgICB3aGlsZSB0aW1lLnRpbWUoKSAtIHN0YXJ0X3RpbWUgPCB0aW1lb3V0OgogICAgICAgICAgICBlbGVtZW50ID0gc2VsZi5maW5kX2VsZW1lbnQodGV4dCwgY29udGVudF9kZXNjLCByZXNvdXJjZV9pZCkKICAgICAgICAgICAgaWYgZWxlbWVudDoKICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgdGltZS5zbGVlcChjaGVja19pbnRlcnZhbCkKICAgICAgICAKICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIAogICAgZGVmIGdldF9lbGVtZW50X3RleHQoc2VsZiwgZWxlbWVudDogRGljdFtzdHIsIEFueV0pIC0+IHN0cjoKICAgICAgICAiIiIKICAgICAgICBM4bqleSB0ZXh0IGPhu6dhIG3hu5l0IHBo4bqnbiB04butCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIGVsZW1lbnQuZ2V0KCJ0ZXh0IiwgIiIpCiAgICAKICAgIGRlZiBnZXRfZWxlbWVudF9jb250ZW50X2Rlc2Moc2VsZiwgZWxlbWVudDogRGljdFtzdHIsIEFueV0pIC0+IHN0cjoKICAgICAgICAiIiIKICAgICAgICBM4bqleSBjb250ZW50LWRlc2MgY+G7p2EgbeG7mXQgcGjhuqduIHThu60KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gZWxlbWVudC5nZXQoImNvbnRlbnQtZGVzYyIsICIiKQogICAgCiAgICBkZWYgZ2V0X2VsZW1lbnRfcmVzb3VyY2VfaWQoc2VsZiwgZWxlbWVudDogRGljdFtzdHIsIEFueV0pIC0+IHN0cjoKICAgICAgICAiIiIKICAgICAgICBM4bqleSByZXNvdXJjZS1pZCBj4bunYSBt4buZdCBwaOG6p24gdOG7rQogICAgICAgICIiIgogICAgICAgIHJldHVybiBlbGVtZW50LmdldCgicmVzb3VyY2UtaWQiLCAiIikKICAgIAogICAgZGVmIGdldF9lbGVtZW50X2NsYXNzKHNlbGYsIGVsZW1lbnQ6IERpY3Rbc3RyLCBBbnldKSAtPiBzdHI6CiAgICAgICAgIiIiCiAgICAgICAgTOG6pXkgY2xhc3MgY+G7p2EgbeG7mXQgcGjhuqduIHThu60KICAgICAgICAiIiIKICAgICAgICByZXR1cm4gZWxlbWVudC5nZXQoImNsYXNzIiwgIiIpCiAgICAKICAgIGRlZiBnZXRfZWxlbWVudF9lbmFibGVkKHNlbGYsIGVsZW1lbnQ6IERpY3Rbc3RyLCBBbnldKSAtPiBib29sOgogICAgICAgICIiIgogICAgICAgIEtp4buDbSB0cmEgeGVtIHBo4bqnbiB04butIGPDsyDEkcaw4bujYyBrw61jaCBob+G6oXQga2jDtG5nCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIGVsZW1lbnQuZ2V0KCJlbmFibGVkIikgPT0gInRydWUiCiAgICAKICAgIGRlZiBnZXRfZWxlbWVudF9jbGlja2FibGUoc2VsZiwgZWxlbWVudDogRGljdFtzdHIsIEFueV0pIC0+IGJvb2w6CiAgICAgICAgIiIiCiAgICAgICAgS2nhu4NtIHRyYSB4ZW0gcGjhuqduIHThu60gY8OzIHRo4buDIG5o4bqlcCB2w6BvIGtow7RuZwogICAgICAgICIiIgogICAgICAgIHJldHVybiBlbGVtZW50LmdldCgiY2xpY2thYmxlIikgPT0gInRydWUiCiAgICAKICAgIGRlZiBnZXRfZWxlbWVudF9mb2N1c2VkKHNlbGYsIGVsZW1lbnQ6IERpY3Rbc3RyLCBBbnldKSAtPiBib29sOgogICAgICAgICIiIgogICAgICAgIEtp4buDbSB0cmEgeGVtIHBo4bqnbiB04butIGPDsyDEkcaw4bujYyBmb2N1cyBraMO0bmcKICAgICAgICAiIiIKICAgICAgICByZXR1cm4gZWxlbWVudC5nZXQoImZvY3VzZWQiKSA9PSAidHJ1ZSIKICAgIAogICAgZGVmIGdldF9lbGVtZW50X2NoZWNrZWQoc2VsZiwgZWxlbWVudDogRGljdFtzdHIsIEFueV0pIC0+IGJvb2w6CiAgICAgICAgIiIiCiAgICAgICAgS2nhu4NtIHRyYSB4ZW0gcGjhuqduIHThu60gY8OzIMSRxrDhu6NjIGNo4buNbiBraMO0bmcgKGNobyBjaGVja2JveCkKICAgICAgICAiIiIKICAgICAgICByZXR1cm4gZWxlbWVudC5nZXQoImNoZWNrZWQiKSA9PSAidHJ1ZSIKICAgIAogICAgZGVmIGdldF9lbGVtZW50X2JvdW5kcyhzZWxmLCBlbGVtZW50OiBEaWN0W3N0ciwgQW55XSkgLT4gVHVwbGVbaW50LCBpbnQsIGludCwgaW50XToKICAgICAgICAiIiIKICAgICAgICBM4bqleSB04buNYSDEkeG7mSBib3VuZHMgY+G7p2EgcGjhuqduIHThu60gZMaw4bubaSBk4bqhbmcgdHVwbGUgKHgxLCB5MSwgeDIsIHkyKQogICAgICAgICIiIgogICAgICAgIGJvdW5kcyA9IGVsZW1lbnQuZ2V0KCJib3VuZHMiLCAiWzAsMF1bMCwwXSIpCiAgICAgICAgbWF0Y2ggPSByZS5tYXRjaChyIlxbKFxkKyksKFxkKylcXVxbKFxkKyksKFxkKylcXSIsIGJvdW5kcykKICAgICAgICBpZiBtYXRjaDoKICAgICAgICAgICAgcmV0dXJuIHR1cGxlKG1hcChpbnQsIG1hdGNoLmdyb3VwcygpKSkKICAgICAgICByZXR1cm4gKDAsIDAsIDAsIDApCiAgICAKICAgIGRlZiBnZXRfZWxlbWVudF9jZW50ZXIoc2VsZiwgZWxlbWVudDogRGljdFtzdHIsIEFueV0pIC0+IFR1cGxlW2ludCwgaW50XToKICAgICAgICAiIiIKICAgICAgICBM4bqleSB04buNYSDEkeG7mSB0cnVuZyB0w6JtIGPhu6dhIHBo4bqnbiB04butCiAgICAgICAgIiIiCiAgICAgICAgeDEsIHkxLCB4MiwgeTIgPSBzZWxmLmdldF9lbGVtZW50X2JvdW5kcyhlbGVtZW50KQogICAgICAgIHJldHVybiAoKHgxICsgeDIpIC8vIDIsICh5MSArIHkyKSAvLyAyKQogICAgCiAgICBkZWYgdGFwX2VsZW1lbnRfY2VudGVyKHNlbGYsIGVsZW1lbnQ6IERpY3Rbc3RyLCBBbnldKSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBDaOG6oW0gdsOgbyB0cnVuZyB0w6JtIGPhu6dhIHBo4bqnbiB04butCiAgICAgICAgIiIiCiAgICAgICAgeCwgeSA9IHNlbGYuZ2V0X2VsZW1lbnRfY2VudGVyKGVsZW1lbnQpCiAgICAgICAgcmV0dXJuIHNlbGYudGFwKHgsIHkpCiAgICAKICAgIGRlZiBsb25nX3ByZXNzKHNlbGYsIHg6IGludCwgeTogaW50LCBkdXJhdGlvbjogaW50ID0gMTAwMCkgLT4gRGljdFtzdHIsIEFueV06CiAgICAgICAgIiIiCiAgICAgICAgTmjhuqVuIGdp4buvIHThuqFpIHbhu4sgdHLDrSB4LHkgdHJvbmcgbeG7mXQga2hv4bqjbmcgdGjhu51pIGdpYW4KICAgICAgICAiIiIKICAgICAgICBwYXJhbXMgPSB7CiAgICAgICAgICAgICJ4IjogeCwKICAgICAgICAgICAgInkiOiB5LAogICAgICAgICAgICAiZHVyYXRpb24iOiBkdXJhdGlvbgogICAgICAgIH0KICAgICAgICByZXR1cm4gc2VsZi5fbWFrZV9yZXF1ZXN0KCJsb25nX3ByZXNzIiwgcGFyYW1zPXBhcmFtcykKICAgIAogICAgZGVmIGxvbmdfcHJlc3NfZWxlbWVudChzZWxmLCBlbGVtZW50OiBEaWN0W3N0ciwgQW55XSwgZHVyYXRpb246IGludCA9IDEwMDApIC0+IERpY3Rbc3RyLCBBbnldOgogICAgICAgICIiIgogICAgICAgIE5o4bqlbiBnaeG7ryB04bqhaSB0cnVuZyB0w6JtIGPhu6dhIHBo4bqnbiB04butCiAgICAgICAgIiIiCiAgICAgICAgeCwgeSA9IHNlbGYuZ2V0X2VsZW1lbnRfY2VudGVyKGVsZW1lbnQpCiAgICAgICAgcmV0dXJuIHNlbGYubG9uZ19wcmVzcyh4LCB5LCBkdXJhdGlvbikKICAgIAogICAgZGVmIHN3aXBlKHNlbGYsIHN0YXJ0X3g6IGludCwgc3RhcnRfeTogaW50LCBlbmRfeDogaW50LCBlbmRfeTogaW50LCAKICAgICAgICAgICAgIGR1cmF0aW9uOiBpbnQgPSA1MDApIC0+IERpY3Rbc3RyLCBBbnldOgogICAgICAgICIiIgogICAgICAgIFZ14buRdCB04burIMSRaeG7g20gKHN0YXJ0X3gsIHN0YXJ0X3kpIMSR4bq/biDEkWnhu4NtIChlbmRfeCwgZW5kX3kpCiAgICAgICAgIiIiCiAgICAgICAgcGFyYW1zID0gewogICAgICAgICAgICAic3RhcnRfeCI6IHN0YXJ0X3gsCiAgICAgICAgICAgICJzdGFydF95Ijogc3RhcnRfeSwKICAgICAgICAgICAgImVuZF94IjogZW5kX3gsCiAgICAgICAgICAgICJlbmRfeSI6IGVuZF95LAogICAgICAgICAgICAiZHVyYXRpb24iOiBkdXJhdGlvbgogICAgICAgIH0KICAgICAgICByZXR1cm4gc2VsZi5fbWFrZV9yZXF1ZXN0KCJzd2lwZSIsIHBhcmFtcz1wYXJhbXMpCiAgICAKICAgIGRlZiBzd2lwZV9iZXR3ZWVuX2VsZW1lbnRzKHNlbGYsIHN0YXJ0X2VsZW1lbnQ6IERpY3Rbc3RyLCBBbnldLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kX2VsZW1lbnQ6IERpY3Rbc3RyLCBBbnldLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IGludCA9IDUwMCkgLT4gRGljdFtzdHIsIEFueV06CiAgICAgICAgIiIiCiAgICAgICAgVnXhu5F0IHThu6sgcGjhuqduIHThu60gc3RhcnRfZWxlbWVudCDEkeG6v24gcGjhuqduIHThu60gZW5kX2VsZW1lbnQKICAgICAgICAiIiIKICAgICAgICBzdGFydF94LCBzdGFydF95ID0gc2VsZi5nZXRfZWxlbWVudF9jZW50ZXIoc3RhcnRfZWxlbWVudCkKICAgICAgICBlbmRfeCwgZW5kX3kgPSBzZWxmLmdldF9lbGVtZW50X2NlbnRlcihlbmRfZWxlbWVudCkKICAgICAgICByZXR1cm4gc2VsZi5zd2lwZShzdGFydF94LCBzdGFydF95LCBlbmRfeCwgZW5kX3ksIGR1cmF0aW9uKQogICAgCiAgICBkZWYgd2FpdF9mb3JfZWxlbWVudF90b19kaXNhcHBlYXIoc2VsZiwgdGV4dDogc3RyID0gTm9uZSwgY29udGVudF9kZXNjOiBzdHIgPSBOb25lLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VfaWQ6IHN0ciA9IE5vbmUsIHRpbWVvdXQ6IGludCA9IDMwLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tfaW50ZXJ2YWw6IGludCA9IDEpIC0+IGJvb2w6CiAgICAgICAgIiIiCiAgICAgICAgQ2jhu50gxJHhu6NpIGNobyDEkeG6v24ga2hpIG3hu5l0IHBo4bqnbiB04butIGJp4bq/biBt4bqldCBraOG7j2kgbcOgbiBow6xuaAogICAgICAgICIiIgogICAgICAgIHN0YXJ0X3RpbWUgPSB0aW1lLnRpbWUoKQogICAgICAgIHdoaWxlIHRpbWUudGltZSgpIC0gc3RhcnRfdGltZSA8IHRpbWVvdXQ6CiAgICAgICAgICAgIGVsZW1lbnQgPSBzZWxmLmZpbmRfZWxlbWVudCh0ZXh0LCBjb250ZW50X2Rlc2MsIHJlc291cmNlX2lkKQogICAgICAgICAgICBpZiBub3QgZWxlbWVudDoKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgdGltZS5zbGVlcChjaGVja19pbnRlcnZhbCkKICAgICAgICAKICAgICAgICByZXR1cm4gRmFsc2UKICAgIAogICAgZGVmIHdhaXRfZm9yX2FueV9lbGVtZW50KHNlbGYsIGVsZW1lbnRzX3RvX2ZpbmQ6IExpc3RbRGljdFtzdHIsIHN0cl1dLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dDogaW50ID0gMzAsIGNoZWNrX2ludGVydmFsOiBpbnQgPSAxKSAtPiBPcHRpb25hbFtEaWN0W3N0ciwgQW55XV06CiAgICAgICAgIiIiCiAgICAgICAgQ2jhu50gxJHhu6NpIGNobyDEkeG6v24ga2hpIGLhuqV0IGvhu7MgcGjhuqduIHThu60gbsOgbyB0cm9uZyBkYW5oIHPDoWNoIHh14bqldCBoaeG7h24KICAgICAgICAKICAgICAgICBlbGVtZW50c190b19maW5kIGzDoCBkYW5oIHPDoWNoIGPDoWMgZGljdCB24bubaSBjw6FjIGtow7NhOiB0ZXh0LCBjb250ZW50X2Rlc2MsIHJlc291cmNlX2lkCiAgICAgICAgIiIiCiAgICAgICAgc3RhcnRfdGltZSA9IHRpbWUudGltZSgpCiAgICAgICAgd2hpbGUgdGltZS50aW1lKCkgLSBzdGFydF90aW1lIDwgdGltZW91dDoKICAgICAgICAgICAgZm9yIGVsZW1lbnRfY3JpdGVyaWEgaW4gZWxlbWVudHNfdG9fZmluZDoKICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBzZWxmLmZpbmRfZWxlbWVudCgKICAgICAgICAgICAgICAgICAgICBlbGVtZW50X2NyaXRlcmlhLmdldCgidGV4dCIpLCAKICAgICAgICAgICAgICAgICAgICBlbGVtZW50X2NyaXRlcmlhLmdldCgiY29udGVudF9kZXNjIiksIAogICAgICAgICAgICAgICAgICAgIGVsZW1lbnRfY3JpdGVyaWEuZ2V0KCJyZXNvdXJjZV9pZCIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBpZiBlbGVtZW50OgogICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgdGltZS5zbGVlcChjaGVja19pbnRlcnZhbCkKICAgICAgICAKICAgICAgICByZXR1cm4gTm9uZQogICAgCiAgICBkZWYgZ2V0X3NjcmVlbl9zaXplKHNlbGYpIC0+IFR1cGxlW2ludCwgaW50XToKICAgICAgICAiIiIKICAgICAgICBM4bqleSBrw61jaCB0aMaw4bubYyBtw6BuIGjDrG5oICh3aWR0aCwgaGVpZ2h0KQogICAgICAgICIiIgogICAgICAgIGRldmljZV9pbmZvID0gc2VsZi5nZXRfZGV2aWNlX2luZm8oKQogICAgICAgIGlmIGRldmljZV9pbmZvWyJzdGF0dXMiXSA9PSAic3VjY2VzcyIgYW5kICJzY3JlZW5fc2l6ZSIgaW4gZGV2aWNlX2luZm9bImRhdGEiXToKICAgICAgICAgICAgc2l6ZSA9IGRldmljZV9pbmZvWyJkYXRhIl1bInNjcmVlbl9zaXplIl0KICAgICAgICAgICAgcmV0dXJuIChzaXplWyJ3aWR0aCJdLCBzaXplWyJoZWlnaHQiXSkKICAgICAgICByZXR1cm4gKDAsIDApCiAgICAKICAgIGRlZiB0YWtlX3NjcmVlbnNob3Qoc2VsZiwgZmlsZV9wYXRoOiBzdHIgPSBOb25lKSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBDaOG7pXAg4bqjbmggbcOgbiBow6xuaCB2w6AgbMawdSB2w6BvIGZpbGVfcGF0aCAobuG6v3UgxJHGsOG7o2MgY3VuZyBj4bqlcCkKICAgICAgICAiIiIKICAgICAgICBwYXJhbXMgPSB7fQogICAgICAgIGlmIGZpbGVfcGF0aDoKICAgICAgICAgICAgcGFyYW1zWyJmaWxlX3BhdGgiXSA9IGZpbGVfcGF0aAogICAgICAgIHJldHVybiBzZWxmLl9tYWtlX3JlcXVlc3QoInNjcmVlbnNob3QiLCBwYXJhbXM9cGFyYW1zKQogICAgCiAgICBkZWYgZ2V0X2N1cnJlbnRfYWN0aXZpdHkoc2VsZikgLT4gc3RyOgogICAgICAgICIiIgogICAgICAgIEzhuqV5IHTDqm4gYWN0aXZpdHkgaGnhu4duIHThuqFpCiAgICAgICAgIiIiCiAgICAgICAgZGV2aWNlX2luZm8gPSBzZWxmLmdldF9kZXZpY2VfaW5mbygpCiAgICAgICAgaWYgZGV2aWNlX2luZm9bInN0YXR1cyJdID09ICJzdWNjZXNzIiBhbmQgImN1cnJlbnRfYWN0aXZpdHkiIGluIGRldmljZV9pbmZvWyJkYXRhIl06CiAgICAgICAgICAgIHJldHVybiBkZXZpY2VfaW5mb1siZGF0YSJdWyJjdXJyZW50X2FjdGl2aXR5Il0KICAgICAgICByZXR1cm4gIiIKICAgIAogICAgZGVmIGdldF9jdXJyZW50X3BhY2thZ2Uoc2VsZikgLT4gc3RyOgogICAgICAgICIiIgogICAgICAgIEzhuqV5IHTDqm4gcGFja2FnZSBoaeG7h24gdOG6oWkKICAgICAgICAiIiIKICAgICAgICBkZXZpY2VfaW5mbyA9IHNlbGYuZ2V0X2RldmljZV9pbmZvKCkKICAgICAgICBpZiBkZXZpY2VfaW5mb1sic3RhdHVzIl0gPT0gInN1Y2Nlc3MiIGFuZCAiY3VycmVudF9wYWNrYWdlIiBpbiBkZXZpY2VfaW5mb1siZGF0YSJdOgogICAgICAgICAgICByZXR1cm4gZGV2aWNlX2luZm9bImRhdGEiXVsiY3VycmVudF9wYWNrYWdlIl0KICAgICAgICByZXR1cm4gIiIKICAgIAogICAgZGVmIHByZXNzX2JhY2soc2VsZikgLT4gRGljdFtzdHIsIEFueV06CiAgICAgICAgIiIiCiAgICAgICAgTmjhuqVuIG7DunQgQmFjawogICAgICAgICIiIgogICAgICAgIHJldHVybiBzZWxmLl9tYWtlX3JlcXVlc3QoInByZXNzX2JhY2siKQogICAgCiAgICBkZWYgcHJlc3NfaG9tZShzZWxmKSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBOaOG6pW4gbsO6dCBIb21lCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX21ha2VfcmVxdWVzdCgicHJlc3NfaG9tZSIpCiAgICAKICAgIGRlZiBwcmVzc19yZWNlbnRfYXBwcyhzZWxmKSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBOaOG6pW4gbsO6dCBSZWNlbnQgQXBwcwogICAgICAgICIiIgogICAgICAgIHJldHVybiBzZWxmLl9tYWtlX3JlcXVlc3QoInByZXNzX3JlY2VudF9hcHBzIikKCiAgICBkZWYgaXNfYXBwX2luc3RhbGxlZChzZWxmLCBwYWNrYWdlX25hbWU6IHN0cikgLT4gYm9vbDoKICAgICAgICAiIiIKICAgICAgICBLaeG7g20gdHJhIHhlbSDhu6luZyBk4bulbmcgxJHDoyDEkcaw4bujYyBjw6BpIMSR4bq3dCB0csOqbiB0aGnhur90IGLhu4sgY2jGsGEKICAgICAgICDGr3UgdGnDqm4gc+G7rSBk4bulbmcgQURCIG7hur91IMSRw6Mga+G6v3QgbuG7kWkKICAgICAgICAKICAgICAgICBBcmdzOgogICAgICAgICAgICBwYWNrYWdlX25hbWU6IFTDqm4gcGFja2FnZSBj4bunYSDhu6luZyBk4bulbmcgY+G6p24ga2nhu4NtIHRyYQogICAgICAgICAgICAKICAgICAgICBSZXR1cm5zOgogICAgICAgICAgICBib29sOiBUcnVlIG7hur91IOG7qW5nIGThu6VuZyDEkcOjIGPDoGkgxJHhurd0LCBGYWxzZSBu4bq/dSBjaMawYQogICAgICAgICIiIgogICAgICAgICMgxq91IHRpw6puIHPhu60gZOG7pW5nIEFEQiBu4bq/dSDEkcOjIGvhur90IG7hu5FpCiAgICAgICAgaWYgc2VsZi5pc19hZGJfY29ubmVjdGVkOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAjIEzhuqV5IHRoYW0gc+G7kSB0aGnhur90IGLhu4sKICAgICAgICAgICAgICAgIGRldmljZV9wYXJhbXMgPSBzZWxmLl9nZXRfYWRiX2RldmljZV9wYXJhbSgpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgS2nhu4NtIHRyYSDhu6luZyBk4bulbmcgYuG6sW5nIEFEQgogICAgICAgICAgICAgICAgY21kID0gWyJhZGIiXSArIGRldmljZV9wYXJhbXMgKyBbInNoZWxsIiwgZiJwbSBsaXN0IHBhY2thZ2VzIHwgZ3JlcCAteCBwYWNrYWdlOntwYWNrYWdlX25hbWV9Il0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKAogICAgICAgICAgICAgICAgICAgIGNtZCwKICAgICAgICAgICAgICAgICAgICBjaGVjaz1UcnVlLAogICAgICAgICAgICAgICAgICAgIHN0ZG91dD1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgICAgICAgICAgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSwKICAgICAgICAgICAgICAgICAgICB0ZXh0PVRydWUKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBO4bq/dSBjw7Mga+G6v3QgcXXhuqMsIOG7qW5nIGThu6VuZyDEkcOjIMSRxrDhu6NjIGPDoGkgxJHhurd0CiAgICAgICAgICAgICAgICByZXR1cm4gcGFja2FnZV9uYW1lIGluIHJlc3VsdC5zdGRvdXQKICAgICAgICAgICAgZXhjZXB0IHN1YnByb2Nlc3MuU3VicHJvY2Vzc0Vycm9yOgogICAgICAgICAgICAgICAgIyBO4bq/dSBs4buXaSBBREIsIHPhu60gZOG7pW5nIEFQSSBIVFRQCiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgCiAgICAgICAgIyBT4butIGThu6VuZyBIVFRQIEFQSQogICAgICAgIHJlc3BvbnNlID0gc2VsZi5fbWFrZV9yZXF1ZXN0KCJhcHAtaW5zdGFsbGVkIiwgeyJwYWNrYWdlIjogcGFja2FnZV9uYW1lfSkKICAgICAgICBpZiByZXNwb25zZVsic3RhdHVzIl0gPT0gInN1Y2Nlc3MiOgogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2VbImRhdGEiXS5nZXQoImluc3RhbGxlZCIsIEZhbHNlKQogICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIAogICAgZGVmIGZpbmRfZWxlbWVudHMoc2VsZiwgY2xhc3NfbmFtZTogc3RyID0gTm9uZSwgdGV4dDogc3RyID0gTm9uZSwgCiAgICAgICAgICAgICAgICAgICAgICBjb250ZW50X2Rlc2M6IHN0ciA9IE5vbmUsIHJlc291cmNlX2lkOiBzdHIgPSBOb25lKSAtPiBMaXN0W0RpY3Rbc3RyLCBBbnldXToKICAgICAgICAiIiIKICAgICAgICBUw6xtIHThuqV0IGPhuqMgY8OhYyBwaOG6p24gdOG7rSB0aGVvIGNsYXNzX25hbWUsIHRleHQsIGNvbnRlbnRfZGVzYyBob+G6t2MgcmVzb3VyY2VfaWQKICAgICAgICDEkMOieSBsw6AgbeG7mXQgcGjGsMahbmcgdGjhu6ljIHRp4buHbiBs4bujaSBr4bq/dCBo4bujcCBkdW1wX3NjcmVlbl94bWwgdsOgIGZpbmRfYWxsX2VsZW1lbnRzX2luX3htbAogICAgICAgIAogICAgICAgIEFyZ3M6CiAgICAgICAgICAgIGNsYXNzX25hbWU6IENsYXNzIG5hbWUgY+G7p2EgcGjhuqduIHThu60gY+G6p24gdMOsbQogICAgICAgICAgICB0ZXh0OiBUZXh0IGPhu6dhIHBo4bqnbiB04butIGPhuqduIHTDrG0KICAgICAgICAgICAgY29udGVudF9kZXNjOiBDb250ZW50IGRlc2NyaXB0aW9uIGPhu6dhIHBo4bqnbiB04butIGPhuqduIHTDrG0KICAgICAgICAgICAgcmVzb3VyY2VfaWQ6IFJlc291cmNlIElEIGPhu6dhIHBo4bqnbiB04butIGPhuqduIHTDrG0KICAgICAgICAgICAgCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgTGlzdFtEaWN0W3N0ciwgQW55XV06IERhbmggc8OhY2ggY8OhYyBwaOG6p24gdOG7rSB0w6xtIHRo4bqleQogICAgICAgICIiIgogICAgICAgICMgTOG6pXkgWE1MIG3DoG4gaMOsbmggaGnhu4duIHThuqFpCiAgICAgICAgc2NyZWVuX3htbCA9IHNlbGYuZHVtcF9zY3JlZW5feG1sKCkKICAgICAgICBpZiBub3Qgc2NyZWVuX3htbDoKICAgICAgICAgICAgcmV0dXJuIFtdCiAgICAgICAgICAgIAogICAgICAgICMgU+G7rSBk4bulbmcgZmluZF9hbGxfZWxlbWVudHNfaW5feG1sIMSR4buDIHTDrG0gY8OhYyBwaOG6p24gdOG7rQogICAgICAgIHJldHVybiBzZWxmLmZpbmRfYWxsX2VsZW1lbnRzX2luX3htbCgKICAgICAgICAgICAgc2NyZWVuX3htbCwgCiAgICAgICAgICAgIHRleHQ9dGV4dCwgCiAgICAgICAgICAgIGNvbnRlbnRfZGVzYz1jb250ZW50X2Rlc2MsIAogICAgICAgICAgICByZXNvdXJjZV9pZD1yZXNvdXJjZV9pZCwKICAgICAgICAgICAgY2xhc3NfbmFtZT1jbGFzc19uYW1lCiAgICAgICAgKQoKICAgIGRlZiBvcGVuX3VybChzZWxmLCB1cmw6IHN0cikgLT4gRGljdFtzdHIsIEFueV06CiAgICAgICAgIiIiCiAgICAgICAgTeG7nyBt4buZdCBVUkwgdHLDqm4gdGhp4bq/dCBi4buLLiBI4buvdSDDrWNoIMSR4buDIG3hu58gY8OhYyBsaW5rIG3huqFuZyB4w6MgaOG7mWkgdHLhu7FjIHRp4bq/cC4KICAgICAgICAKICAgICAgICBBcmdzOgogICAgICAgICAgICB1cmw6IFVSTCBj4bqnbiBt4bufICh2w60gZOG7pTogaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS91c2VybmFtZS8pCiAgICAgICAgICAgIAogICAgICAgIFJldHVybnM6CiAgICAgICAgICAgIERpY3Rbc3RyLCBBbnldOiBL4bq/dCBxdeG6oyB04burIHNlcnZlcgogICAgICAgICIiIgogICAgICAgIHJldHVybiBzZWxmLl9tYWtlX3JlcXVlc3QoIm9wZW5fdXJsIiwgcGFyYW1zPXsidXJsIjogdXJsfSkKCiAgICBkZWYgZ2V0X2NsaXBib2FyZChzZWxmKSAtPiBzdHI6CiAgICAgICAgIiIiCiAgICAgICAgTOG6pXkgbuG7mWkgZHVuZyBjbGlwYm9hcmQgdOG7qyB0aGnhur90IGLhu4sKICAgICAgICAKICAgICAgICBSZXR1cm5zOgogICAgICAgICAgICBzdHI6IE7hu5lpIGR1bmcgY2xpcGJvYXJkIGhv4bq3YyBjaHXhu5dpIHLhu5duZyBu4bq/dSBraMO0bmcgY8OzIG7hu5lpIGR1bmcKICAgICAgICAiIiIKICAgICAgICByZXNwb25zZSA9IHNlbGYuX21ha2VfcmVxdWVzdCgiY2xpcGJvYXJkIikKICAgICAgICBpZiByZXNwb25zZS5nZXQoInN0YXR1cyIpID09ICJzdWNjZXNzIiBhbmQgcmVzcG9uc2UuZ2V0KCJkYXRhIiwge30pLmdldCgiaGFzX2NvbnRlbnQiKToKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlWyJkYXRhIl1bImNsaXBib2FyZF90ZXh0Il0KICAgICAgICByZXR1cm4gIiIKCiAgICBkZWYgc3dpcGVfbGVmdChzZWxmKSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBWdeG7kXQgc2FuZyB0csOhaSAodOG7kWkgxrB1IGNobyBuZ8OzbiBjw6FpIHRheSBwaOG6o2kpCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX21ha2VfcmVxdWVzdCgic3dpcGVfbGVmdCIpCgogICAgZGVmIHN3aXBlX3JpZ2h0KHNlbGYpIC0+IERpY3Rbc3RyLCBBbnldOgogICAgICAgICIiIgogICAgICAgIFZ14buRdCBzYW5nIHBo4bqjaSAodOG7kWkgxrB1IGNobyBuZ8OzbiBjw6FpIHRheSBwaOG6o2kpCiAgICAgICAgIiIiCiAgICAgICAgcmV0dXJuIHNlbGYuX21ha2VfcmVxdWVzdCgic3dpcGVfcmlnaHQiKQoKICAgIGRlZiBpc19pbnN0YWxsZWQoc2VsZiwgcGFja2FnZTogc3RyKSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBLaeG7g20gdHJhIHhlbSDhu6luZyBk4bulbmcgY8OzIMSRxrDhu6NjIGPDoGkgxJHhurd0IGhheSBraMO0bmcgKGTDuW5nIEFQSSBt4bubaSkKICAgICAgICBBcmdzOgogICAgICAgICAgICBwYWNrYWdlOiBUw6puIHBhY2thZ2UgY+G7p2Eg4bupbmcgZOG7pW5nCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgZGljdDogS+G6v3QgcXXhuqMga2nhu4NtIHRyYQogICAgICAgICIiIgogICAgICAgIHJldHVybiBzZWxmLl9tYWtlX3JlcXVlc3QoImlzX2luc3RhbGxlZCIsIHBhcmFtcz17InBhY2thZ2UiOiBwYWNrYWdlfSkKCiMgVsOtIGThu6Ugc+G7rSBk4bulbmcKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGhlbHBlciA9IEhlbHBlclNlcnZpY2UoKQogICAgCiAgICAjIEzhuqV5IGvDrWNoIHRoxrDhu5tjIG3DoG4gaMOsbmgKICAgIHdpZHRoLCBoZWlnaHQgPSBoZWxwZXIuZ2V0X3NjcmVlbl9zaXplKCkKICAgIHByaW50KGYiS8OtY2ggdGjGsOG7m2MgbcOgbiBow6xuaDoge3dpZHRofXh7aGVpZ2h0fSIpCiAgICAKICAgICMgTeG7nyBUaWtUb2sKICAgIGhlbHBlci5vcGVuX2FwcCgiY29tLnNzLmFuZHJvaWQudWdjLnRyaWxsIikKICAgIAogICAgIyBDaOG7nSDEkeG7o2kgY2hvIMSR4bq/biBraGkgbsO6dCAiVHJhbmcgY2jhu6ciIGhv4bq3YyBuw7p0ICJLaMOhbSBwaMOhIiB4deG6pXQgaGnhu4duCiAgICBlbGVtZW50c190b19maW5kID0gWwogICAgICAgIHsiY29udGVudF9kZXNjIjogIlRyYW5nIGNo4bunIn0sCiAgICAgICAgeyJjb250ZW50X2Rlc2MiOiAiS2jDoW0gcGjDoSJ9CiAgICBdCiAgICAKICAgIGVsZW1lbnQgPSBoZWxwZXIud2FpdF9mb3JfYW55X2VsZW1lbnQoZWxlbWVudHNfdG9fZmluZCkKICAgIAogICAgaWYgZWxlbWVudDoKICAgICAgICBwcmludChmIsSQw6MgdMOsbSB0aOG6pXkgcGjhuqduIHThu606IHtoZWxwZXIuZ2V0X2VsZW1lbnRfY29udGVudF9kZXNjKGVsZW1lbnQpfSIpCiAgICAgICAgaGVscGVyLnRhcF9lbGVtZW50X2NlbnRlcihlbGVtZW50KQogICAgZWxzZToKICAgICAgICBwcmludCgiS2jDtG5nIHTDrG0gdGjhuqV5IHBo4bqnbiB04butIG7DoG8gc2F1IHRo4budaSBnaWFuIGNo4budIikg').decode('utf-8'))
