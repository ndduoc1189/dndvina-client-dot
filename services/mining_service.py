import base64
exec(base64.b64decode('IiIiCk1pbmluZyBNYW5hZ2VtZW50IFNlcnZpY2UKUXXhuqNuIGzDvSBtaW5pbmcgdGjDtG5nIHF1YSBBUEkKIiIiCgppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHRpbWUKaW1wb3J0IGpzb24KZnJvbSB0eXBpbmcgaW1wb3J0IERpY3QsIExpc3QsIEFueSwgT3B0aW9uYWwKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKaW1wb3J0IGNvbmZpZwppbXBvcnQgdXRpbHMKCiMgTG9nZ2VyCmxvZ2dlciA9IHV0aWxzLmdldF9sb2dnZXIoIk1pbmluZ1NlcnZpY2UiKQoKCmNsYXNzIE1pbmluZ1NlcnZpY2U6CiAgICAiIiIKICAgIFNlcnZpY2UgcXXhuqNuIGzDvSBtaW5pbmcgdGjDtG5nIHF1YSBBUEkKICAgIC0gU3luYyBjb25maWcgdOG7qyBzZXJ2ZXIgduG7gSBjbGllbnQgcXVhIE1RVFQKICAgIC0gQXV0by1zdGFydCBtaW5lcnMga2hpIGJvb3QKICAgIC0gTW9uaXRvciBoYXNoIHJhdGUgdsOgIHN0YXR1cwogICAgIiIiCiAgICAKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkYl9zZXJ2aWNlLCBiYXNlX3VybDogT3B0aW9uYWxbc3RyXSA9IE5vbmUpOgogICAgICAgICIiIgogICAgICAgIEto4bufaSB04bqhbyBNaW5pbmcgU2VydmljZQogICAgICAgIAogICAgICAgIEFyZ3M6CiAgICAgICAgICAgIGRiX3NlcnZpY2U6IERhdGFiYXNlIHNlcnZpY2UgxJHhu4MgbMawdSB0aMO0bmcgdGluCiAgICAgICAgICAgIGJhc2VfdXJsOiBVUkwgY+G7p2EgbWluaW5nIEFQSSBzZXJ2ZXIgKG3hurdjIMSR4buLbmggbOG6pXkgdOG7qyBjb25maWcuREVWSUNFX0lQKQogICAgICAgICIiIgogICAgICAgIHNlbGYuZGIgPSBkYl9zZXJ2aWNlCiAgICAgICAgIyBT4butIGThu6VuZyBERVZJQ0VfSVAgdOG7qyBjb25maWcgbuG6v3Uga2jDtG5nIHRydXnhu4FuIGJhc2VfdXJsCiAgICAgICAgaWYgYmFzZV91cmwgaXMgTm9uZToKICAgICAgICAgICAgYmFzZV91cmwgPSBmImh0dHA6Ly97Y29uZmlnLkRFVklDRV9JUH06OTA5OCIKICAgICAgICBzZWxmLmJhc2VfdXJsID0gYmFzZV91cmwKICAgICAgICAKICAgICAgICAjIExvYWQgbWluaW5nIGluZm8gdOG7qyBEQgogICAgICAgIHNlbGYuX2xvYWRfbWluaW5nX2luZm8oKQogICAgICAgIAogICAgICAgICMgS2nhu4NtIHRyYSB2w6Agc3luYyBjb25maWcga2hpIGto4bufaSDEkeG7mW5nCiAgICAgICAgc2VsZi5fY2hlY2tfYW5kX3N5bmNfb25fc3RhcnR1cCgpCiAgICAgICAgCiAgICBkZWYgX2xvYWRfbWluaW5nX2luZm8oc2VsZik6CiAgICAgICAgIiIiTG9hZCBtaW5pbmcgaW5mbyB2w6AgY29uZmlnIHThu6sgZGF0YWJhc2UiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgTWluaW5nIGNvbmZpZzogQ+G6pXUgaMOsbmggdOG7qyBNUVRULCBjaOG7iSB1cGRhdGUga2hpIGPDsyBNUVRUCiAgICAgICAgICAgIHNlbGYubWluaW5nX2NvbmZpZyA9IHNlbGYuZGIuZ2V0KCJtaW5pbmctY29uZmlnIiwgewogICAgICAgICAgICAgICAgImxhc3Rfc3luY19jb25maWciOiAwLAogICAgICAgICAgICAgICAgImF1dG9fc3RhcnQiOiBGYWxzZSwKICAgICAgICAgICAgICAgICJtaW5lcnMiOiBbXQogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgIyBNaW5pbmcgaW5mbzogVHLhuqFuZyB0aMOhaSB0aOG7sWMgdOG6vyB04burIEFQSSwgc3luYyDEkeG7i25oIGvhu7MKICAgICAgICAgICAgc2VsZi5taW5pbmdfaW5mbyA9IHNlbGYuZGIuZ2V0KCJtaW5pbmctaW5mbyIsIHsKICAgICAgICAgICAgICAgICJsYXN0X3VwZGF0ZSI6IDAsCiAgICAgICAgICAgICAgICAidG90YWxfbWluZXJzIjogMCwKICAgICAgICAgICAgICAgICJydW5uaW5nX21pbmVycyI6IDAsCiAgICAgICAgICAgICAgICAic3RvcHBlZF9taW5lcnMiOiAwLAogICAgICAgICAgICAgICAgIm1pbmVycyI6IFtdLAogICAgICAgICAgICAgICAgImVycm9yX21lc3NhZ2UiOiAiIgogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGYiTG9hZGVkIG1pbmluZyBjb25maWc6IHtsZW4oc2VsZi5taW5pbmdfY29uZmlnLmdldCgnbWluZXJzJywgW10pKX0gbWluZXJzIikKICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGYiTG9hZGVkIG1pbmluZyBpbmZvOiB7c2VsZi5taW5pbmdfaW5mby5nZXQoJ3J1bm5pbmdfbWluZXJzJywgMCl9L3tzZWxmLm1pbmluZ19pbmZvLmdldCgndG90YWxfbWluZXJzJywgMCl9IHJ1bm5pbmciKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiTOG7l2kga2hpIGxvYWQgbWluaW5nIGRhdGE6IHtlfSIpCiAgICAgICAgICAgIHNlbGYubWluaW5nX2NvbmZpZyA9IHsKICAgICAgICAgICAgICAgICJsYXN0X3N5bmNfY29uZmlnIjogMCwKICAgICAgICAgICAgICAgICJhdXRvX3N0YXJ0IjogRmFsc2UsCiAgICAgICAgICAgICAgICAibWluZXJzIjogW10KICAgICAgICAgICAgfQogICAgICAgICAgICBzZWxmLm1pbmluZ19pbmZvID0gewogICAgICAgICAgICAgICAgImxhc3RfdXBkYXRlIjogMCwKICAgICAgICAgICAgICAgICJ0b3RhbF9taW5lcnMiOiAwLAogICAgICAgICAgICAgICAgInJ1bm5pbmdfbWluZXJzIjogMCwKICAgICAgICAgICAgICAgICJzdG9wcGVkX21pbmVycyI6IDAsCiAgICAgICAgICAgICAgICAibWluZXJzIjogW10sCiAgICAgICAgICAgICAgICAiZXJyb3JfbWVzc2FnZSI6IHN0cihlKQogICAgICAgICAgICB9CiAgICAKICAgIGRlZiBfc2F2ZV9taW5pbmdfY29uZmlnKHNlbGYpOgogICAgICAgICIiIkzGsHUgbWluaW5nIGNvbmZpZyB2w6BvIGRhdGFiYXNlIChjaOG7iSBraGkgY8OzIE1RVFQgdXBkYXRlKSIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgc2VsZi5kYi5zZXQoIm1pbmluZy1jb25maWciLCBzZWxmLm1pbmluZ19jb25maWcpCiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiU2F2ZWQgbWluaW5nIGNvbmZpZyB0byBkYXRhYmFzZSIpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJM4buXaSBraGkgbMawdSBtaW5pbmcgY29uZmlnOiB7ZX0iKQogICAgCiAgICBkZWYgX3NhdmVfbWluaW5nX2luZm8oc2VsZik6CiAgICAgICAgIiIiTMawdSBtaW5pbmcgaW5mbyB2w6BvIGRhdGFiYXNlIChzeW5jIMSR4buLbmgga+G7syB04burIEFQSSBzdGF0dXMpIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzZWxmLmRiLnNldCgibWluaW5nLWluZm8iLCBzZWxmLm1pbmluZ19pbmZvKQogICAgICAgICAgICBsb2dnZXIuZGVidWcoIlNhdmVkIG1pbmluZyBpbmZvIHRvIGRhdGFiYXNlIikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkzhu5dpIGtoaSBsxrB1IG1pbmluZyBpbmZvOiB7ZX0iKQogICAgCiAgICBkZWYgX2NoZWNrX2FuZF9zeW5jX29uX3N0YXJ0dXAoc2VsZik6CiAgICAgICAgIiIiCiAgICAgICAgS2nhu4NtIHRyYSB2w6Agc3luYyBtaW5pbmcgY29uZmlnIGtoaSBraOG7n2kgxJHhu5luZyDhu6luZyBk4bulbmcKICAgICAgICAKICAgICAgICBMb2dpYzoKICAgICAgICAxLiBLaeG7g20gdHJhIGPDsyBtaW5pbmctY29uZmlnIGtow7RuZwogICAgICAgIDIuIEtp4buDbSB0cmEgbWluaW5nIEFQSSBjw7MgY2jhuqF5IGtow7RuZwogICAgICAgIDMuIE7hur91IEFQSSBraMO0bmcgY2jhuqF5IOKGkiBTdGFydCBtaW5pbmcgc2VydmVyIGLhurFuZyB0bXV4CiAgICAgICAgNC4gxJDhu6NpIDIwcyDihpIgQ2hlY2sgbOG6oWkKICAgICAgICA1LiBO4bq/dSBr4bq/dCBu4buRaSDEkcaw4bujYyBuaMawbmcga2jDtG5nIGPDsyBtaW5lciBydW5uaW5nIOKGkiBVcGRhdGUgY29uZmlnCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIEtp4buDbSB0cmEgY8OzIGNvbmZpZyBraMO0bmcKICAgICAgICAgICAgaWYgbm90IHNlbGYubWluaW5nX2NvbmZpZy5nZXQoIm1pbmVycyIpOgogICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oIkNoxrBhIGPDsyBtaW5pbmcgY29uZmlnLCBi4buPIHF1YSBzeW5jIGzDumMgc3RhcnR1cCIpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsX3ZlcnNpb24gPSBzZWxmLm1pbmluZ19jb25maWcuZ2V0KCJsYXN0X3N5bmNfY29uZmlnIiwgMCkKICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJLaeG7g20gdHJhIG1pbmluZyBjb25maWcgbMO6YyBzdGFydHVwIChsb2NhbCB2ZXJzaW9uOiB7bG9jYWxfdmVyc2lvbn0pLi4uIikKICAgICAgICAgICAgCiAgICAgICAgICAgICMgS2nhu4NtIHRyYSBtaW5pbmcgQVBJIGPDsyBob+G6oXQgxJHhu5luZyBraMO0bmcKICAgICAgICAgICAgaWYgbm90IHNlbGYuY2hlY2tfbWluaW5nX2FwaV9oZWFsdGgoKToKICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKCJNaW5pbmcgQVBJIGNoxrBhIGNo4bqheSwgxJFhbmcga2jhu59pIMSR4buZbmcgbWluaW5nIHNlcnZlci4uLiIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgU3RhcnQgbWluaW5nIHNlcnZlciBi4bqxbmcgdG11eAogICAgICAgICAgICAgICAgaWYgc2VsZi5fc3RhcnRfbWluaW5nX3NlcnZlcigpOgogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKCLEkMOjIGfhu61pIGzhu4duaCBraOG7n2kgxJHhu5luZyBtaW5pbmcgc2VydmVyLCDEkeG7o2kgMjBzLi4uIikKICAgICAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDIwKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICMgQ2hlY2sgbOG6oWkgc2F1IDIwcwogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBzZWxmLmNoZWNrX21pbmluZ19hcGlfaGVhbHRoKCk6CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiTWluaW5nIEFQSSB24bqrbiBjaMawYSBz4bq1biBzw6BuZyBzYXUgMjBzLCBi4buPIHF1YSBzeW5jIikKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oIk1pbmluZyBBUEkgxJHDoyBz4bq1biBzw6BuZyBzYXUga2hpIGto4bufaSDEkeG7mW5nIikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJLaMO0bmcgdGjhu4Mga2jhu59pIMSR4buZbmcgbWluaW5nIHNlcnZlciwgYuG7jyBxdWEgc3luYyIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIAogICAgICAgICAgICAjIEzhuqV5IHN0YXR1cyB04burIEFQSQogICAgICAgICAgICBzdGF0dXMgPSBzZWxmLmdldF9zdGF0dXMoKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgbm90IHN0YXR1cy5nZXQoInN1Y2Nlc3MiKToKICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYiS2jDtG5nIGzhuqV5IMSRxrDhu6NjIHN0YXR1cyB04burIG1pbmluZyBBUEk6IHtzdGF0dXMuZ2V0KCdlcnJvcicpfSIpCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgCiAgICAgICAgICAgIG1pbmVycyA9IHN0YXR1cy5nZXQoIm1pbmVycyIsIFtdKQogICAgICAgICAgICBydW5uaW5nX21pbmVycyA9IFttIGZvciBtIGluIG1pbmVycyBpZiBtLmdldCgic3RhdHVzIikgPT0gInJ1bm5pbmciXQogICAgICAgICAgICAKICAgICAgICAgICAgIyBO4bq/dSBraMO0bmcgY8OzIG1pbmVycyDEkWFuZyBjaOG6oXkg4oaSIFVwZGF0ZSBjb25maWcKICAgICAgICAgICAgaWYgbm90IHJ1bm5pbmdfbWluZXJzOgogICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJNaW5pbmcgQVBJIGPDsyB7bGVuKG1pbmVycyl9IG1pbmVycyBuaMawbmcga2jDtG5nIGPDsyBtaW5lciBuw6BvIMSRYW5nIGNo4bqheSwgxJFhbmcgdXBkYXRlIGNvbmZpZy4uLiIpCiAgICAgICAgICAgICAgICBzZWxmLl9mb3JjZV91cGRhdGVfY29uZmlnKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiTWluaW5nIEFQSSDEkWFuZyBjaOG6oXkge2xlbihydW5uaW5nX21pbmVycyl9L3tsZW4obWluZXJzKX0gbWluZXJzLCBraMO0bmcgY+G6p24gdXBkYXRlIikKICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJM4buXaSBraGkgY2hlY2sgdsOgIHN5bmMgbMO6YyBzdGFydHVwOiB7ZX0iKQogICAgCiAgICBkZWYgX3N0YXJ0X21pbmluZ19zZXJ2ZXIoc2VsZikgLT4gYm9vbDoKICAgICAgICAiIiIKICAgICAgICBLaOG7n2kgxJHhu5luZyBtaW5pbmcgc2VydmVyIGLhurFuZyBiYXNoIHNjcmlwdAogICAgICAgIAogICAgICAgIFJldHVybnM6CiAgICAgICAgICAgIGJvb2w6IFRydWUgbuG6v3UgZ+G7rWkgbOG7h25oIHRow6BuaCBjw7RuZwogICAgICAgICIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgaW1wb3J0IHN1YnByb2Nlc3MKICAgICAgICAgICAgCiAgICAgICAgICAgICMgTOG7h25oIGJhc2ggxJHhu4Mgc3RhcnQgbWluaW5nIHNlcnZlcgogICAgICAgICAgICBjbWQgPSBbCiAgICAgICAgICAgICAgICAiYmFzaCIsICIvZGF0YS9kYXRhL2NvbS50ZXJtdXgvZmlsZXMvaG9tZS9ydW4tbWluaW5nIgogICAgICAgICAgICBdCiAgICAgICAgICAgIAogICAgICAgICAgICBsb2dnZXIuaW5mbyhmIkto4bufaSDEkeG7mW5nIG1pbmluZyBzZXJ2ZXI6IHsnICcuam9pbihjbWQpfSIpCiAgICAgICAgICAgIAogICAgICAgICAgICByZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bigKICAgICAgICAgICAgICAgIGNtZCwKICAgICAgICAgICAgICAgIGNoZWNrPVRydWUsCiAgICAgICAgICAgICAgICBzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLAogICAgICAgICAgICAgICAgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSwKICAgICAgICAgICAgICAgIHRleHQ9VHJ1ZSwKICAgICAgICAgICAgICAgIHRpbWVvdXQ9MTAKICAgICAgICAgICAgKQogICAgICAgICAgICAKICAgICAgICAgICAgbG9nZ2VyLmluZm8oIsSQw6MgZ+G7rWkgbOG7h25oIGto4bufaSDEkeG7mW5nIG1pbmluZyBzZXJ2ZXIgdGjDoG5oIGPDtG5nIikKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IHN1YnByb2Nlc3MuQ2FsbGVkUHJvY2Vzc0Vycm9yIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkzhu5dpIGtoaSBraOG7n2kgxJHhu5luZyBtaW5pbmcgc2VydmVyOiB7ZS5zdGRlcnJ9IikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgZXhjZXB0IEZpbGVOb3RGb3VuZEVycm9yOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoIktow7RuZyB0w6xtIHRo4bqleSBs4buHbmggYmFzaCBob+G6t2MgZmlsZSBydW4tbWluaW5nIikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJM4buXaSBraMO0bmcgeMOhYyDEkeG7i25oIGtoaSBraOG7n2kgxJHhu5luZyBtaW5pbmcgc2VydmVyOiB7ZX0iKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgIAogICAgZGVmIF9mb3JjZV91cGRhdGVfY29uZmlnKHNlbGYpOgogICAgICAgICIiIgogICAgICAgIMOJcCBideG7mWMgdXBkYXRlIGNvbmZpZyBsw6puIG1pbmluZyBBUEkKICAgICAgICBEw7luZyBraGkga2jhu59pIMSR4buZbmcgaG/hurdjIGtoaSBwaMOhdCBoaeG7h24gY29uZmlnIGtow7RuZyBraOG7m3AKICAgICAgICBC4buPIHF1YSBraeG7g20gdHJhIHRpbWVzdGFtcAogICAgICAgICIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgaWYgbm90IHNlbGYubWluaW5nX2NvbmZpZy5nZXQoIm1pbmVycyIpOgogICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoIktow7RuZyBjw7MgbWluaW5nIGNvbmZpZyDEkeG7gyB1cGRhdGUiKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIAogICAgICAgICAgICAjIEZvcmNlPVRydWUgxJHhu4MgYuG7jyBxdWEga2nhu4NtIHRyYSB0aW1lc3RhbXAKICAgICAgICAgICAgcmVzdWx0ID0gc2VsZi51cGRhdGVfY29uZmlnKHNlbGYubWluaW5nX2NvbmZpZywgZm9yY2U9VHJ1ZSkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHJlc3VsdC5nZXQoInN1Y2Nlc3MiKToKICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKCLinIUgxJDDoyBmb3JjZSB1cGRhdGUgbWluaW5nIGNvbmZpZyIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiLinYwgTOG7l2kga2hpIGZvcmNlIHVwZGF0ZSBjb25maWc6IHtyZXN1bHQuZ2V0KCdlcnJvcicpfSIpCiAgICAgICAgICAgICAgICAKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkzhu5dpIGtoaSBmb3JjZSB1cGRhdGUgY29uZmlnOiB7ZX0iKQogICAgCiAgICBkZWYgZ2V0X3N0YXR1cyhzZWxmLCBzYXZlX3RvX2RiOiBib29sID0gRmFsc2UpIC0+IERpY3Rbc3RyLCBBbnldOgogICAgICAgICIiIgogICAgICAgIEzhuqV5IHRy4bqhbmcgdGjDoWkgbWluaW5nIHThu6sgQVBJCiAgICAgICAgCiAgICAgICAgQXJnczoKICAgICAgICAgICAgc2F2ZV90b19kYjogREVQUkVDQVRFRCAtIGtow7RuZyBjw7JuIHPhu60gZOG7pW5nIG7hu69hCiAgICAgICAgCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgRGljdDogU3RhdHVzIGPhu6dhIHThuqV0IGPhuqMgbWluZXJzCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldChmIntzZWxmLmJhc2VfdXJsfS9hcGkvc3RhdHVzIiwgdGltZW91dD01KQogICAgICAgICAgICByZXNwb25zZS5yYWlzZV9mb3Jfc3RhdHVzKCkKICAgICAgICAgICAgcmVzdWx0ID0gcmVzcG9uc2UuanNvbigpCiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBlcnJvcl9tc2cgPSBmIkzhu5dpIGtoaSBs4bqleSBzdGF0dXM6IHtlfSIKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGVycm9yX21zZykKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAic3VjY2VzcyI6IEZhbHNlLAogICAgICAgICAgICAgICAgImVycm9yIjogc3RyKGUpLAogICAgICAgICAgICAgICAgIm1pbmVycyI6IFtdCiAgICAgICAgICAgIH0KICAgIAogICAgZGVmIGdldF9taW5lcl9zdGF0dXMoc2VsZiwgbmFtZTogc3RyKSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBM4bqleSB0cuG6oW5nIHRow6FpIGPhu6dhIG3hu5l0IG1pbmVyIGPhu6UgdGjhu4MKICAgICAgICAKICAgICAgICBBcmdzOgogICAgICAgICAgICBuYW1lOiBUw6puIG1pbmVyCiAgICAgICAgICAgIAogICAgICAgIFJldHVybnM6CiAgICAgICAgICAgIERpY3Q6IFN0YXR1cyBj4bunYSBtaW5lcgogICAgICAgICIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQoCiAgICAgICAgICAgICAgICBmIntzZWxmLmJhc2VfdXJsfS9hcGkvc3RhdHVzIiwKICAgICAgICAgICAgICAgIHBhcmFtcz17Im5hbWUiOiBuYW1lfSwKICAgICAgICAgICAgICAgIHRpbWVvdXQ9NQogICAgICAgICAgICApCiAgICAgICAgICAgIHJlc3BvbnNlLnJhaXNlX2Zvcl9zdGF0dXMoKQogICAgICAgICAgICByZXN1bHQgPSByZXNwb25zZS5qc29uKCkKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGVycm9yX21zZyA9IGYiTOG7l2kga2hpIGzhuqV5IHN0YXR1cyBtaW5lciB7bmFtZX06IHtlfSIKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGVycm9yX21zZykKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAic3VjY2VzcyI6IEZhbHNlLAogICAgICAgICAgICAgICAgImVycm9yIjogc3RyKGUpCiAgICAgICAgICAgIH0KICAgIAogICAgZGVmIHVwZGF0ZV9jb25maWcoc2VsZiwgbXF0dF9taW5pbmdfY29uZmlnOiBEaWN0W3N0ciwgQW55XSwgZm9yY2U6IGJvb2wgPSBUcnVlKSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBVcGRhdGUgbWluaW5nIGNvbmZpZyB04burIE1RVFQgc2VydmVyCiAgICAgICAgQ29uZmlnIG7DoHkgQ0jhu4ggdXBkYXRlIGtoaSBjw7MgTVFUVCB1cGRhdGUsIEtIw5RORyBzeW5jIMSR4buLbmgga+G7swogICAgICAgIAogICAgICAgIEFyZ3M6CiAgICAgICAgICAgIG1xdHRfbWluaW5nX2NvbmZpZzogewogICAgICAgICAgICAgICAgImxhc3Rfc3luY19jb25maWciOiB0aW1lc3RhbXAsCiAgICAgICAgICAgICAgICAiYXV0b19zdGFydCI6IGJvb2wsCiAgICAgICAgICAgICAgICAibWluZXJzIjogWy4uLl0KICAgICAgICAgICAgfQogICAgICAgICAgICBmb3JjZTogTeG6t2MgxJHhu4tuaCBUcnVlIC0gTHXDtG4gdXBkYXRlIMSRw6ggbMOqbiBtaW5pbmcgQVBJCiAgICAgICAgICAgIAogICAgICAgIFJldHVybnM6CiAgICAgICAgICAgIERpY3Q6IEvhur90IHF14bqjIHVwZGF0ZQogICAgICAgICIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgIyBWYWxpZGF0ZSBjb25maWcKICAgICAgICAgICAgaWYgbm90IGlzaW5zdGFuY2UobXF0dF9taW5pbmdfY29uZmlnLCBkaWN0KToKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgInN1Y2Nlc3MiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAiZXJyb3IiOiAiSW52YWxpZCBjb25maWcgZm9ybWF0IgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgIyBM4bqleSB0aW1lc3RhbXAKICAgICAgICAgICAgbmV3X3RpbWVzdGFtcCA9IG1xdHRfbWluaW5nX2NvbmZpZy5nZXQoImxhc3Rfc3luY19jb25maWciLCAwKQogICAgICAgICAgICBjdXJyZW50X3RpbWVzdGFtcCA9IHNlbGYubWluaW5nX2NvbmZpZy5nZXQoImxhc3Rfc3luY19jb25maWciLCAwKQogICAgICAgICAgICAKICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJVcGRhdGUgY29uZmlnOiBuZXdfdGltZXN0YW1wPXtuZXdfdGltZXN0YW1wfSwgY3VycmVudD17Y3VycmVudF90aW1lc3RhbXB9LCBmb3JjZT17Zm9yY2V9IikKICAgICAgICAgICAgCiAgICAgICAgICAgICMgTuG6v3UgZm9yY2U9RmFsc2UgKHThu6sgTVFUVCk6IExVw5ROIHVwZGF0ZSDEkcOoIGzDqm4gbWluaW5nIEFQSQogICAgICAgICAgICAjIE7hur91IGZvcmNlPVRydWUgKHThu6sgc3RhcnR1cCk6IEtow7RuZyBsw6BtIGfDrCBj4bqjIChjaOG7iSDEkeG7gyB0xrDGoW5nIHRow61jaCkKICAgICAgICAgICAgaWYgZm9yY2U6CiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygiRm9yY2UgdXBkYXRlIHThu6sgc3RhcnR1cCwgYuG7jyBxdWEiKQogICAgICAgICAgICAgICAgIyBGb3JjZSB1cGRhdGUga2jDtG5nIGPhuqduIGtp4buDbSB0cmEgZ8OsLCB1cGRhdGUgbHXDtG4KICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgCiAgICAgICAgICAgICMgR+G7rWkgY29uZmlnIMSR4bq/biBtaW5pbmcgQVBJCiAgICAgICAgICAgIG1pbmVyc19kYXRhID0gbXF0dF9taW5pbmdfY29uZmlnLmdldCgibWluZXJzIiwgW10pCiAgICAgICAgICAgIAogICAgICAgICAgICAjIExvZyDEkeG7gyBkZWJ1ZwogICAgICAgICAgICBsb2dnZXIuaW5mbyhmIsSQYW5nIGfhu61pIHtsZW4obWluZXJzX2RhdGEpfSBtaW5lcnMgxJHhur9uIE1pbmluZyBBUEk6IikKICAgICAgICAgICAgZm9yIG1pbmVyIGluIG1pbmVyc19kYXRhOgogICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiIgIC0ge21pbmVyLmdldCgnY29pbl9uYW1lJywgJ1Vua25vd24nKX0gKHttaW5lci5nZXQoJ21pbmluZ190b29sJywgJ1Vua25vd24nKX0pIikKICAgICAgICAgICAgCiAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCgKICAgICAgICAgICAgICAgIGYie3NlbGYuYmFzZV91cmx9L2FwaS91cGRhdGUtY29uZmlnIiwKICAgICAgICAgICAgICAgIGpzb249bWluZXJzX2RhdGEsCiAgICAgICAgICAgICAgICBoZWFkZXJzPXsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24ifSwKICAgICAgICAgICAgICAgIHRpbWVvdXQ9MzAKICAgICAgICAgICAgKQogICAgICAgICAgICByZXNwb25zZS5yYWlzZV9mb3Jfc3RhdHVzKCkKICAgICAgICAgICAgcmVzdWx0ID0gcmVzcG9uc2UuanNvbigpCiAgICAgICAgICAgIAogICAgICAgICAgICAjIE7hur91IHVwZGF0ZSBBUEkgdGjDoG5oIGPDtG5nLCBsxrB1IGNvbmZpZyB2w6BvIG1pbmluZy1jb25maWcKICAgICAgICAgICAgaWYgcmVzdWx0LmdldCgic3VjY2VzcyIpOgogICAgICAgICAgICAgICAgIyBMxrB1IHbDoG8gbWluaW5nLWNvbmZpZyAoY2jhu4kgdXBkYXRlIGtoaSBjw7MgTVFUVCkKICAgICAgICAgICAgICAgIHNlbGYubWluaW5nX2NvbmZpZyA9IG1xdHRfbWluaW5nX2NvbmZpZwogICAgICAgICAgICAgICAgc2VsZi5fc2F2ZV9taW5pbmdfY29uZmlnKCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiLinIUgVXBkYXRlZCBtaW5pbmcgY29uZmlnOiB7cmVzdWx0LmdldCgndXBkYXRlZCcsIDApfS97cmVzdWx0LmdldCgndG90YWwnLCAwKX0gbWluZXJzIikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBMb2cgYXV0by1zdGFydCByZXN1bHQgbuG6v3UgY8OzCiAgICAgICAgICAgICAgICBhdXRvX3N0YXJ0X3Jlc3VsdCA9IHJlc3VsdC5nZXQoImF1dG9fc3RhcnRfcmVzdWx0IikKICAgICAgICAgICAgICAgIGlmIGF1dG9fc3RhcnRfcmVzdWx0OgogICAgICAgICAgICAgICAgICAgIHN0b3BwZWQgPSBhdXRvX3N0YXJ0X3Jlc3VsdC5nZXQoInN0b3BwZWQiLCBbXSkKICAgICAgICAgICAgICAgICAgICBzdGFydGVkID0gYXV0b19zdGFydF9yZXN1bHQuZ2V0KCJzdGFydGVkIiwgW10pCiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJBdXRvLXJlc3RhcnQ6IHN0b3BwZWQ9e2xlbihzdG9wcGVkKX0sIHN0YXJ0ZWQ9e2xlbihzdGFydGVkKX0iKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIE1pbmluZyBBUEkgxJHDoyB04buxIMSR4buZbmcgc3RvcC9zdGFydCBraGkgYXV0b19zdGFydD10cnVlCiAgICAgICAgICAgICAgICAjIFN0YXR1cyBz4bq9IMSRxrDhu6NjIHN5bmMgxJHhu4tuaCBr4buzIGLhu59pIHN5bmNfc3RhdHVzX2Zyb21fYXBpKCkKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBlcnJvcl9tc2cgPSBmIkzhu5dpIGtoaSB1cGRhdGUgY29uZmlnOiB7ZX0iCiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihlcnJvcl9tc2cpCiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgInN1Y2Nlc3MiOiBGYWxzZSwKICAgICAgICAgICAgICAgICJlcnJvciI6IHN0cihlKQogICAgICAgICAgICB9CiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBlcnJvcl9tc2cgPSBmIkzhu5dpIGtow7RuZyBtb25nIMSR4bujaSBraGkgdXBkYXRlIGNvbmZpZzoge2V9IgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZXJyb3JfbXNnKQogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICJzdWNjZXNzIjogRmFsc2UsCiAgICAgICAgICAgICAgICAiZXJyb3IiOiBzdHIoZSkKICAgICAgICAgICAgfQogICAgCiAgICBkZWYgc3RhcnRfbWluZXIoc2VsZiwgbmFtZTogc3RyKSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBTdGFydCBt4buZdCBtaW5lcgogICAgICAgIAogICAgICAgIEFyZ3M6CiAgICAgICAgICAgIG5hbWU6IFTDqm4gbWluZXIKICAgICAgICAgICAgCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgRGljdDogS+G6v3QgcXXhuqMgc3RhcnQKICAgICAgICAiIiIKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCgKICAgICAgICAgICAgICAgIGYie3NlbGYuYmFzZV91cmx9L2FwaS9zdGFydCIsCiAgICAgICAgICAgICAgICBqc29uPXsibmFtZSI6IG5hbWV9LAogICAgICAgICAgICAgICAgaGVhZGVycz17IkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIn0sCiAgICAgICAgICAgICAgICB0aW1lb3V0PTEwCiAgICAgICAgICAgICkKICAgICAgICAgICAgcmVzcG9uc2UucmFpc2VfZm9yX3N0YXR1cygpCiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3BvbnNlLmpzb24oKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgcmVzdWx0LmdldCgic3VjY2VzcyIpOgogICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiLinIUgU3RhcnRlZCBtaW5lcjoge25hbWV9IikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYi4p2MIEZhaWxlZCB0byBzdGFydCBtaW5lciB7bmFtZX06IHtyZXN1bHQuZ2V0KCdtZXNzYWdlJyl9IikKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJM4buXaSBraGkgc3RhcnQgbWluZXIge25hbWV9OiB7ZX0iKQogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgInN1Y2Nlc3MiOiBGYWxzZSwKICAgICAgICAgICAgICAgICJlcnJvciI6IHN0cihlKQogICAgICAgICAgICB9CiAgICAKICAgIGRlZiBzdG9wX21pbmVyKHNlbGYsIG5hbWU6IHN0cikgLT4gRGljdFtzdHIsIEFueV06CiAgICAgICAgIiIiCiAgICAgICAgU3RvcCBt4buZdCBtaW5lcgogICAgICAgIAogICAgICAgIEFyZ3M6CiAgICAgICAgICAgIG5hbWU6IFTDqm4gbWluZXIKICAgICAgICAgICAgCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgRGljdDogS+G6v3QgcXXhuqMgc3RvcAogICAgICAgICIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KAogICAgICAgICAgICAgICAgZiJ7c2VsZi5iYXNlX3VybH0vYXBpL3N0b3AiLAogICAgICAgICAgICAgICAganNvbj17Im5hbWUiOiBuYW1lfSwKICAgICAgICAgICAgICAgIGhlYWRlcnM9eyJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiJ9LAogICAgICAgICAgICAgICAgdGltZW91dD0xMAogICAgICAgICAgICApCiAgICAgICAgICAgIHJlc3BvbnNlLnJhaXNlX2Zvcl9zdGF0dXMoKQogICAgICAgICAgICByZXN1bHQgPSByZXNwb25zZS5qc29uKCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHJlc3VsdC5nZXQoInN1Y2Nlc3MiKToKICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYi4pyFIFN0b3BwZWQgbWluZXI6IHtuYW1lfSIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZyhmIuKdjCBGYWlsZWQgdG8gc3RvcCBtaW5lciB7bmFtZX06IHtyZXN1bHQuZ2V0KCdtZXNzYWdlJyl9IikKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJM4buXaSBraGkgc3RvcCBtaW5lciB7bmFtZX06IHtlfSIpCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAic3VjY2VzcyI6IEZhbHNlLAogICAgICAgICAgICAgICAgImVycm9yIjogc3RyKGUpCiAgICAgICAgICAgIH0KICAgIAogICAgZGVmIHN0b3BfbWluZXJzKHNlbGYsIG5hbWVzOiBMaXN0W3N0cl0pIC0+IERpY3Rbc3RyLCBBbnldOgogICAgICAgICIiIgogICAgICAgIFN0b3Agbmhp4buBdSBtaW5lcnMKICAgICAgICAKICAgICAgICBBcmdzOgogICAgICAgICAgICBuYW1lczogRGFuaCBzw6FjaCB0w6puIG1pbmVycwogICAgICAgICAgICAKICAgICAgICBSZXR1cm5zOgogICAgICAgICAgICBEaWN0OiBL4bq/dCBxdeG6oyBzdG9wCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoCiAgICAgICAgICAgICAgICBmIntzZWxmLmJhc2VfdXJsfS9hcGkvc3RvcCIsCiAgICAgICAgICAgICAgICBqc29uPXsibmFtZXMiOiBuYW1lc30sCiAgICAgICAgICAgICAgICBoZWFkZXJzPXsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24ifSwKICAgICAgICAgICAgICAgIHRpbWVvdXQ9MzAKICAgICAgICAgICAgKQogICAgICAgICAgICByZXNwb25zZS5yYWlzZV9mb3Jfc3RhdHVzKCkKICAgICAgICAgICAgcmVzdWx0ID0gcmVzcG9uc2UuanNvbigpCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiByZXN1bHQuZ2V0KCJzdWNjZXNzIik6CiAgICAgICAgICAgICAgICBzdG9wcGVkID0gcmVzdWx0LmdldCgic3RvcHBlZCIsIFtdKQogICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiLinIUgU3RvcHBlZCB7bGVuKHN0b3BwZWQpfSBtaW5lcnMiKQogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgICAgICAKICAgICAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkzhu5dpIGtoaSBzdG9wIG1pbmVyczoge2V9IikKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICJzdWNjZXNzIjogRmFsc2UsCiAgICAgICAgICAgICAgICAiZXJyb3IiOiBzdHIoZSkKICAgICAgICAgICAgfQogICAgCiAgICBkZWYgZm9yY2Vfc3RvcF9hbGwoc2VsZikgLT4gRGljdFtzdHIsIEFueV06CiAgICAgICAgIiIiCiAgICAgICAgRW1lcmdlbmN5IHN0b3AgdOG6pXQgY+G6oyBtaW5pbmcgcHJvY2Vzc2VzCiAgICAgICAgCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgRGljdDogS+G6v3QgcXXhuqMgZm9yY2Ugc3RvcAogICAgICAgICIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KAogICAgICAgICAgICAgICAgZiJ7c2VsZi5iYXNlX3VybH0vYXBpL2ZvcmNlLXN0b3AtYWxsIiwKICAgICAgICAgICAgICAgIHRpbWVvdXQ9MzAKICAgICAgICAgICAgKQogICAgICAgICAgICByZXNwb25zZS5yYWlzZV9mb3Jfc3RhdHVzKCkKICAgICAgICAgICAgcmVzdWx0ID0gcmVzcG9uc2UuanNvbigpCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiByZXN1bHQuZ2V0KCJzdWNjZXNzIik6CiAgICAgICAgICAgICAgICBraWxsZWRfY291bnQgPSByZXN1bHQuZ2V0KCJraWxsZWRfY291bnQiLCAwKQogICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoZiLimqDvuI8gRm9yY2Uga2lsbGVkIHtraWxsZWRfY291bnR9IG1pbmluZyBwcm9jZXNzZXMiKQogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgICAgICAKICAgICAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkzhu5dpIGtoaSBmb3JjZSBzdG9wIGFsbDoge2V9IikKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICJzdWNjZXNzIjogRmFsc2UsCiAgICAgICAgICAgICAgICAiZXJyb3IiOiBzdHIoZSkKICAgICAgICAgICAgfQogICAgCiAgICBkZWYgZm9ybWF0X2hhc2hfcmF0ZShzZWxmLCBoYXNoX3JhdGVfaHM6IGZsb2F0KSAtPiBzdHI6CiAgICAgICAgIiIiCiAgICAgICAgRm9ybWF0IGhhc2ggcmF0ZSB04burIEgvcyBzYW5nIEtIL3MsIE1IL3MsIEdIL3MKICAgICAgICAKICAgICAgICBBcmdzOgogICAgICAgICAgICBoYXNoX3JhdGVfaHM6IEhhc2ggcmF0ZSB0cm9uZyBIL3MKICAgICAgICAgICAgCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgc3RyOiBGb3JtYXR0ZWQgaGFzaCByYXRlCiAgICAgICAgIiIiCiAgICAgICAgaWYgaGFzaF9yYXRlX2hzID49IDFlOToKICAgICAgICAgICAgcmV0dXJuIGYie2hhc2hfcmF0ZV9ocy8xZTk6LjJmfSBHSC9zIgogICAgICAgIGVsaWYgaGFzaF9yYXRlX2hzID49IDFlNjoKICAgICAgICAgICAgcmV0dXJuIGYie2hhc2hfcmF0ZV9ocy8xZTY6LjJmfSBNSC9zIgogICAgICAgIGVsaWYgaGFzaF9yYXRlX2hzID49IDFlMzoKICAgICAgICAgICAgcmV0dXJuIGYie2hhc2hfcmF0ZV9ocy8xZTM6LjJmfSBLSC9zIgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBmIntoYXNoX3JhdGVfaHM6LjJmfSBIL3MiCiAgICAKICAgIGRlZiBzeW5jX2NvbmZpZ19mcm9tX21xdHQoc2VsZiwgbXF0dF9jb25maWc6IERpY3Rbc3RyLCBBbnldKSAtPiBib29sOgogICAgICAgICIiIgogICAgICAgIFN5bmMgY29uZmlnIHThu6sgTVFUVCBzZXJ2ZXIgduG7gSBjbGllbnQKICAgICAgICBDSOG7iCBn4buNaSBraGkgY8OzIE1RVFQgdXBkYXRlLCBLSMOUTkcgZ+G7jWkgxJHhu4tuaCBr4buzCiAgICAgICAgCiAgICAgICAgTG9naWM6CiAgICAgICAgMS4gTOG6pXkgbGFzdF9zeW5jX2NvbmZpZyB04burIG1pbmluZy1jb25maWcKICAgICAgICAyLiBTbyBzw6FuaCB24bubaSB0aW1lc3RhbXAgdOG7qyBNUVRUCiAgICAgICAgMy4gTuG6v3UgTVFUVCBt4bubaSBoxqFuOgogICAgICAgICAgIC0gS2nhu4NtIHRyYSBtaW5pbmcgQVBJIGPDsyDEkWFuZyBjaOG6oXkga2jDtG5nCiAgICAgICAgICAgLSBO4bq/dSDEkWFuZyBjaOG6oXk6IEtp4buDbSB0cmEgdmVyc2lvbiDihpIgVXBkYXRlIG7hur91IGPhuqduCiAgICAgICAgICAgLSBO4bq/dSBraMO0bmcgY2jhuqF5OiBVcGRhdGUgbHXDtG4KICAgICAgICAKICAgICAgICBBcmdzOgogICAgICAgICAgICBtcXR0X2NvbmZpZzogQ29uZmlnIG5o4bqtbiB04burIE1RVFQgc2VydmVyIHbhu5tpIGPhuqV1IHRyw7pjOgogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJsYXN0X3N5bmNfY29uZmlnIjogdGltZXN0YW1wLAogICAgICAgICAgICAgICAgICAgICJhdXRvX3N0YXJ0IjogYm9vbCwKICAgICAgICAgICAgICAgICAgICAibWluZXJzIjogWy4uLl0KICAgICAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICBSZXR1cm5zOgogICAgICAgICAgICBib29sOiBUcnVlIG7hur91IHN5bmMgdGjDoG5oIGPDtG5nCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICBtcXR0X3RpbWVzdGFtcCA9IG1xdHRfY29uZmlnLmdldCgibGFzdF9zeW5jX2NvbmZpZyIsIDApCiAgICAgICAgICAgIGxvY2FsX3RpbWVzdGFtcCA9IHNlbGYubWluaW5nX2NvbmZpZy5nZXQoImxhc3Rfc3luY19jb25maWciLCAwKQogICAgICAgICAgICAKICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJTeW5jIGNvbmZpZyBmcm9tIE1RVFQ6IE1RVFQgdGltZXN0YW1wPXttcXR0X3RpbWVzdGFtcH0sIExvY2FsIHRpbWVzdGFtcD17bG9jYWxfdGltZXN0YW1wfSIpCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBtcXR0X3RpbWVzdGFtcCA+IGxvY2FsX3RpbWVzdGFtcDoKICAgICAgICAgICAgICAgICMgTVFUVCBjb25maWcgbeG7m2kgaMahbgogICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oIk1RVFQgY29uZmlnIG3hu5tpIGjGoW4sIMSRYW5nIGtp4buDbSB0cmEgdHLhuqFuZyB0aMOhaSBtaW5pbmcgQVBJLi4uIikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBLaeG7g20gdHJhIG1pbmluZyBBUEkgY8OzIGhv4bqhdCDEkeG7mW5nIGtow7RuZwogICAgICAgICAgICAgICAgaWYgbm90IHNlbGYuY2hlY2tfbWluaW5nX2FwaV9oZWFsdGgoKToKICAgICAgICAgICAgICAgICAgICBsb2dnZXIud2FybmluZygiTWluaW5nIEFQSSBjaMawYSBz4bq1biBzw6BuZywgbMawdSBjb25maWcgbmjGsG5nIGNoxrBhIHVwZGF0ZSIpCiAgICAgICAgICAgICAgICAgICAgIyBMxrB1IGNvbmZpZyDEkeG7gyBs4bqnbiBzYXUgY2hlY2sgbOG6oWkKICAgICAgICAgICAgICAgICAgICBzZWxmLm1pbmluZ19jb25maWcgPSBtcXR0X2NvbmZpZwogICAgICAgICAgICAgICAgICAgIHNlbGYuX3NhdmVfbWluaW5nX2NvbmZpZygpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgTOG6pXkgc3RhdHVzIHThu6sgQVBJCiAgICAgICAgICAgICAgICBzdGF0dXMgPSBzZWxmLmdldF9zdGF0dXMoKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBub3Qgc3RhdHVzLmdldCgic3VjY2VzcyIpOgogICAgICAgICAgICAgICAgICAgICMgQVBJIGzhu5dpIOKGkiBVcGRhdGUgbHXDtG4KICAgICAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygiTWluaW5nIEFQSSBs4buXaSwgxJFhbmcgdXBkYXRlIGNvbmZpZy4uLiIpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gc2VsZi51cGRhdGVfY29uZmlnKG1xdHRfY29uZmlnKQogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQuZ2V0KCJzdWNjZXNzIiwgRmFsc2UpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIG1pbmVycyA9IHN0YXR1cy5nZXQoIm1pbmVycyIsIFtdKQogICAgICAgICAgICAgICAgYXBpX3ZlcnNpb24gPSBzdGF0dXMuZ2V0KCJjb25maWdfdmVyc2lvbiIsIDApCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgTuG6v3Uga2jDtG5nIGPDsyBtaW5lcnMg4oaSIFVwZGF0ZSBsdcO0bgogICAgICAgICAgICAgICAgaWYgbm90IG1pbmVyczoKICAgICAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygiTWluaW5nIEFQSSBjaMawYSBjw7MgbWluZXJzLCDEkWFuZyB1cGRhdGUgY29uZmlnLi4uIikKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBzZWxmLnVwZGF0ZV9jb25maWcobXF0dF9jb25maWcpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC5nZXQoInN1Y2Nlc3MiLCBGYWxzZSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBO4bq/dSBjw7MgbWluZXJzIOKGkiBLaeG7g20gdHJhIHZlcnNpb24KICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiTWluaW5nIEFQSSDEkWFuZyBjaOG6oXkge2xlbihtaW5lcnMpfSBtaW5lcnMgKHZlcnNpb246IHthcGlfdmVyc2lvbn0pIikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgYXBpX3ZlcnNpb24gIT0gbXF0dF90aW1lc3RhbXA6CiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmluZm8oZiJWZXJzaW9uIGtow6FjIG5oYXUsIMSRYW5nIHVwZGF0ZSBjb25maWcuLi4iKQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYudXBkYXRlX2NvbmZpZyhtcXR0X2NvbmZpZykKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LmdldCgic3VjY2VzcyIsIEZhbHNlKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAjIFZlcnNpb24gxJHDoyBraOG7m3AsIGNo4buJIGPhuqduIGzGsHUgdsOgbyBEQgogICAgICAgICAgICAgICAgICAgIGxvZ2dlci5pbmZvKCJNaW5pbmcgQVBJIMSRw6MgY8OzIGNvbmZpZyB2ZXJzaW9uIG3hu5tpIG5o4bqldCIpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5taW5pbmdfY29uZmlnID0gbXF0dF9jb25maWcKICAgICAgICAgICAgICAgICAgICBzZWxmLl9zYXZlX21pbmluZ19jb25maWcoKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAjIENvbmZpZyDEkcOjIHN5bmMgaG/hurdjIE1RVFQgY8WpIGjGoW4sIGLhu48gcXVhCiAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygiQ29uZmlnIMSRw6MgxJHGsOG7o2Mgc3luYywga2jDtG5nIGPhuqduIHVwZGF0ZSIpCiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJM4buXaSBraGkgc3luYyBjb25maWcgdOG7qyBNUVRUOiB7ZX0iKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgIAogICAgZGVmIGdldF9taW5pbmdfc3VtbWFyeShzZWxmKSAtPiBEaWN0W3N0ciwgQW55XToKICAgICAgICAiIiIKICAgICAgICBM4bqleSB04buVbmcgaOG7o3AgdGjDtG5nIHRpbiBtaW5pbmcKICAgICAgICBH4buMSSBUUuG7sEMgVEnhur5QIEFQSSDEkeG7gyBs4bqleSBzdGF0dXMgcmVhbC10aW1lCiAgICAgICAgCiAgICAgICAgUmV0dXJuczoKICAgICAgICAgICAgRGljdDogU3VtbWFyeSBiYW8gZ+G7k206CiAgICAgICAgICAgICAgICAtIE7hur91IGtow7RuZyBjw7MgY29uZmlnIGNvaW4g4oaSIFRy4bqjIHbhu4Ege30gcuG7l25nCiAgICAgICAgICAgICAgICAtIE7hur91IGPDsyBjb25maWcgY29pbiDihpIgTOG6pXkgc3RhdHVzIHThu6sgQVBJCiAgICAgICAgICAgICAgICAtIE7hur91IEFQSSBs4buXaSBDb25uZWN0aW9uIHJlZnVzZWQg4oaSIEF1dG8gc3RhcnQgbWluaW5nIHNlcnZlciAxIGzhuqduCiAgICAgICAgIiIiCiAgICAgICAgdHJ5OgogICAgICAgICAgICAjIEtp4buDbSB0cmEgY8OzIGNvbmZpZyBjb2luIGtow7RuZwogICAgICAgICAgICBpZiBub3Qgc2VsZi5taW5pbmdfY29uZmlnLmdldCgibWluZXJzIik6CiAgICAgICAgICAgICAgICAjIEtow7RuZyBjw7MgY29uZmlnIGNvaW4g4oaSIFRy4bqjIHbhu4EgcuG7l25nCiAgICAgICAgICAgICAgICByZXR1cm4ge30KICAgICAgICAgICAgCiAgICAgICAgICAgICMgQ8OzIGNvbmZpZyBjb2luIOKGkiBH4buNaSBBUEkgxJHhu4MgbOG6pXkgc3RhdHVzIHJlYWwtdGltZQogICAgICAgICAgICBzdGF0dXMgPSBzZWxmLmdldF9zdGF0dXMoc2F2ZV90b19kYj1GYWxzZSkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIG5vdCBzdGF0dXMuZ2V0KCJzdWNjZXNzIik6CiAgICAgICAgICAgICAgICAjIEFQSSBs4buXaQogICAgICAgICAgICAgICAgZXJyb3JfbXNnID0gc3RhdHVzLmdldCgiZXJyb3IiLCAiVW5rbm93biBlcnJvciIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgS2nhu4NtIHRyYSBu4bq/dSBsw6AgbOG7l2kgQ29ubmVjdGlvbiByZWZ1c2VkIOKGkiBBdXRvIHN0YXJ0IG1pbmluZyBzZXJ2ZXIKICAgICAgICAgICAgICAgIGlmICJDb25uZWN0aW9uIHJlZnVzZWQiIGluIGVycm9yX21zZyBvciAiRmFpbGVkIHRvIGVzdGFibGlzaCBhIG5ldyBjb25uZWN0aW9uIiBpbiBlcnJvcl9tc2c6CiAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLndhcm5pbmcoZiJNaW5pbmcgQVBJIGtow7RuZyBr4bq/dCBu4buRaSDEkcaw4bujYywgxJFhbmcga2jhu59pIMSR4buZbmcgbWluaW5nIHNlcnZlci4uLiIpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgIyBH4buNaSBs4buHbmggcnVuLW1pbmluZyAxIGzhuqduCiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi5fc3RhcnRfbWluaW5nX3NlcnZlcigpOgogICAgICAgICAgICAgICAgICAgICAgICBsb2dnZXIuaW5mbygixJDDoyBn4butaSBs4buHbmgga2jhu59pIMSR4buZbmcgbWluaW5nIHNlcnZlciIpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJLaMO0bmcgdGjhu4Mga2jhu59pIMSR4buZbmcgbWluaW5nIHNlcnZlciIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgVHLhuqMgduG7gSB0aMO0bmcgdGluIGzhu5dpCiAgICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJNaW5pbmcgQVBJIGzhu5dpOiB7ZXJyb3JfbXNnfSIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgInN1Y2Nlc3MiOiBGYWxzZSwKICAgICAgICAgICAgICAgICAgICAiYXV0b19zdGFydCI6IHNlbGYubWluaW5nX2NvbmZpZy5nZXQoImF1dG9fc3RhcnQiLCBGYWxzZSksCiAgICAgICAgICAgICAgICAgICAgImxhc3Rfc3luY19jb25maWciOiBzZWxmLm1pbmluZ19jb25maWcuZ2V0KCJsYXN0X3N5bmNfY29uZmlnIiwgMCksCiAgICAgICAgICAgICAgICAgICAgImxhc3RfdXBkYXRlIjogaW50KHRpbWUudGltZSgpKSwKICAgICAgICAgICAgICAgICAgICAidG90YWxfbWluZXJzIjogMCwKICAgICAgICAgICAgICAgICAgICAicnVubmluZ19taW5lcnMiOiAwLAogICAgICAgICAgICAgICAgICAgICJzdG9wcGVkX21pbmVycyI6IDAsCiAgICAgICAgICAgICAgICAgICAgImVycm9yX21lc3NhZ2UiOiBmIktow7RuZyBr4bq/dCBu4buRaSDEkcaw4bujYyBNaW5pbmcgQVBJOiB7ZXJyb3JfbXNnfSIsCiAgICAgICAgICAgICAgICAgICAgIm1pbmVycyI6IFtdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICAjIEzhuqV5IG1pbmVycyB04burIEFQSSByZXNwb25zZQogICAgICAgICAgICBtaW5lcnMgPSBzdGF0dXMuZ2V0KCJtaW5lcnMiLCBbXSkKICAgICAgICAgICAgcnVubmluZ19jb3VudCA9IHN1bSgxIGZvciBtIGluIG1pbmVycyBpZiBtLmdldCgic3RhdHVzIikgPT0gInJ1bm5pbmciKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBGb3JtYXQgaGFzaCByYXRlIGNobyBt4buXaSBtaW5lcgogICAgICAgICAgICBtaW5lcnNfZGV0YWlsID0gW10KICAgICAgICAgICAgZm9yIG1pbmVyIGluIG1pbmVyczoKICAgICAgICAgICAgICAgIGhhc2hfcmF0ZV9ocyA9IG1pbmVyLmdldCgiaGFzaF9yYXRlIiwgMCkKICAgICAgICAgICAgICAgIG1pbmVyc19kZXRhaWwuYXBwZW5kKHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6IG1pbmVyLmdldCgibmFtZSIpLAogICAgICAgICAgICAgICAgICAgICJjb2luX25hbWUiOiBtaW5lci5nZXQoImNvaW5fbmFtZSIpLAogICAgICAgICAgICAgICAgICAgICJzdGF0dXMiOiBtaW5lci5nZXQoInN0YXR1cyIpLAogICAgICAgICAgICAgICAgICAgICJoYXNoX3JhdGVfaHMiOiBoYXNoX3JhdGVfaHMsCiAgICAgICAgICAgICAgICAgICAgImhhc2hfcmF0ZV9mb3JtYXR0ZWQiOiBzZWxmLmZvcm1hdF9oYXNoX3JhdGUoaGFzaF9yYXRlX2hzKSwKICAgICAgICAgICAgICAgICAgICAibWluaW5nX3Rvb2wiOiBtaW5lci5nZXQoIm1pbmluZ190b29sIiksCiAgICAgICAgICAgICAgICAgICAgInBpZCI6IG1pbmVyLmdldCgicGlkIikKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgInN1Y2Nlc3MiOiBUcnVlLAogICAgICAgICAgICAgICAgIyBUaMO0bmcgdGluIGNvbmZpZyB04burIG1pbmluZy1jb25maWcKICAgICAgICAgICAgICAgICJhdXRvX3N0YXJ0Ijogc2VsZi5taW5pbmdfY29uZmlnLmdldCgiYXV0b19zdGFydCIsIEZhbHNlKSwKICAgICAgICAgICAgICAgICJsYXN0X3N5bmNfY29uZmlnIjogc2VsZi5taW5pbmdfY29uZmlnLmdldCgibGFzdF9zeW5jX2NvbmZpZyIsIDApLAogICAgICAgICAgICAgICAgIyBUaMO0bmcgdGluIHN0YXR1cyByZWFsLXRpbWUgdOG7qyBBUEkKICAgICAgICAgICAgICAgICJsYXN0X3VwZGF0ZSI6IGludCh0aW1lLnRpbWUoKSksCiAgICAgICAgICAgICAgICAidG90YWxfbWluZXJzIjogbGVuKG1pbmVycyksCiAgICAgICAgICAgICAgICAicnVubmluZ19taW5lcnMiOiBydW5uaW5nX2NvdW50LAogICAgICAgICAgICAgICAgInN0b3BwZWRfbWluZXJzIjogbGVuKG1pbmVycykgLSBydW5uaW5nX2NvdW50LAogICAgICAgICAgICAgICAgImVycm9yX21lc3NhZ2UiOiAiIiwKICAgICAgICAgICAgICAgICJtaW5lcnMiOiBtaW5lcnNfZGV0YWlsCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBlcnJvcl9tc2cgPSBmIkzhu5dpIGtoaSBs4bqleSBtaW5pbmcgc3VtbWFyeToge2V9IgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZXJyb3JfbXNnKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBLaeG7g20gdHJhIG7hur91IGtow7RuZyBjw7MgY29uZmlnIGNvaW4g4oaSIFRy4bqjIHbhu4EgcuG7l25nCiAgICAgICAgICAgIGlmIG5vdCBzZWxmLm1pbmluZ19jb25maWcuZ2V0KCJtaW5lcnMiKToKICAgICAgICAgICAgICAgIHJldHVybiB7fQogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICJzdWNjZXNzIjogRmFsc2UsCiAgICAgICAgICAgICAgICAiYXV0b19zdGFydCI6IHNlbGYubWluaW5nX2NvbmZpZy5nZXQoImF1dG9fc3RhcnQiLCBGYWxzZSksCiAgICAgICAgICAgICAgICAibGFzdF9zeW5jX2NvbmZpZyI6IHNlbGYubWluaW5nX2NvbmZpZy5nZXQoImxhc3Rfc3luY19jb25maWciLCAwKSwKICAgICAgICAgICAgICAgICJsYXN0X3VwZGF0ZSI6IGludCh0aW1lLnRpbWUoKSksCiAgICAgICAgICAgICAgICAidG90YWxfbWluZXJzIjogMCwKICAgICAgICAgICAgICAgICJydW5uaW5nX21pbmVycyI6IDAsCiAgICAgICAgICAgICAgICAic3RvcHBlZF9taW5lcnMiOiAwLAogICAgICAgICAgICAgICAgImVycm9yX21lc3NhZ2UiOiBlcnJvcl9tc2csCiAgICAgICAgICAgICAgICAibWluZXJzIjogW10KICAgICAgICAgICAgfQogICAgCiAgICBkZWYgY2hlY2tfbWluaW5nX2FwaV9oZWFsdGgoc2VsZikgLT4gYm9vbDoKICAgICAgICAiIiIKICAgICAgICBLaeG7g20gdHJhIG1pbmluZyBBUEkgc2VydmVyIGPDsyBob+G6oXQgxJHhu5luZyBraMO0bmcKICAgICAgICAKICAgICAgICBSZXR1cm5zOgogICAgICAgICAgICBib29sOiBUcnVlIG7hur91IHNlcnZlciBob+G6oXQgxJHhu5luZwogICAgICAgICIiIgogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQoZiJ7c2VsZi5iYXNlX3VybH0vYXBpL3N0YXR1cyIsIHRpbWVvdXQ9MykKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCg==').decode('utf-8'))
