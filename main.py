import base64
exec(base64.b64decode('aW1wb3J0IHRpbWUKaW1wb3J0IHRocmVhZGluZwppbXBvcnQgb3MKaW1wb3J0IHNpZ25hbAppbXBvcnQgc3lzCmZyb20gdHlwaW5nIGltcG9ydCBEaWN0LCBBbnksIE9wdGlvbmFsLCBMaXN0CmZyb20gc2VydmljZXMuaGVscGVyX3NlcnZpY2UgaW1wb3J0IEhlbHBlclNlcnZpY2UKZnJvbSBzZXJ2aWNlcy5kYl9zZXJ2aWNlIGltcG9ydCBEYXRhYmFzZVNlcnZpY2UKZnJvbSBzZXJ2aWNlcy5nb2xpa2Vfc2VydmljZSBpbXBvcnQgR29MaWtlU2VydmljZQpmcm9tIHNlcnZpY2VzLmpvYl9zZXJ2aWNlIGltcG9ydCBKb2JTZXJ2aWNlCmZyb20gc2VydmljZXMubXF0dF9zZXJ2aWNlIGltcG9ydCBNUVRUU2VydmljZQppbXBvcnQgdXRpbHMKZnJvbSB1dGlscyBpbXBvcnQgTG9nTGV2ZWwsIExvZ2dlcgppbXBvcnQgY29uZmlnCgojIFRoaeG6v3QgbOG6rXAgbG9nZ2luZwp1dGlscy5zZXR1cF9kZWZhdWx0X2xvZ2dpbmcoCiAgICBwcm9kdWN0aW9uPW5vdCBjb25maWcuREVCVUdfTU9ERSBpZiBoYXNhdHRyKGNvbmZpZywgJ0RFQlVHX01PREUnKSBlbHNlIEZhbHNlLAogICAgbG9nX3RvX2ZpbGU9VHJ1ZSBpZiBoYXNhdHRyKGNvbmZpZywgJ0xPR19UT19GSUxFJykgYW5kIGNvbmZpZy5MT0dfVE9fRklMRSBlbHNlIEZhbHNlCikKCiMgVOG6oW8gbG9nZ2VyIGNow61uaCBjaG8g4bupbmcgZOG7pW5nCmxvZ2dlciA9IHV0aWxzLmdldF9sb2dnZXIoIk1haW4iKQoKIyBCaeG6v24gdG/DoG4gY+G7pWMgxJHhu4MgbMawdSBzZXJ2aWNlIGluc3RhbmNlcwpkYiA9IE5vbmUKaGVscGVyID0gTm9uZQpnb2xpa2Vfc2VydmljZSA9IE5vbmUKam9iX3NlcnZpY2UgPSBOb25lCm1xdHRfc2VydmljZSA9IE5vbmUKCiMgRmxhZyDEkWnhu4F1IGtoaeG7g24KcnVubmluZyA9IFRydWUKCmRlZiBzaWduYWxfaGFuZGxlcihzaWcsIGZyYW1lKToKICAgICIiIljhu60gbMO9IGtoaSBuZ8aw4budaSBkw7luZyBuaOG6pW4gQ3RybCtDIiIiCiAgICBnbG9iYWwgcnVubmluZywgam9iX3NlcnZpY2UsIG1xdHRfc2VydmljZQogICAgCiAgICBsb2dnZXIuaW5mbygixJBhbmcgZOG7q25nIOG7qW5nIGThu6VuZyAoQ3RybCtDIMSRxrDhu6NjIG5o4bqlbikuLi4iKQogICAgcnVubmluZyA9IEZhbHNlCiAgICAKICAgICMgROG7q25nIGPDoWMgc2VydmljZSBt4buZdCBjw6FjaCBhbiB0b8OgbgogICAgaWYgam9iX3NlcnZpY2U6CiAgICAgICAgbG9nZ2VyLmluZm8oIkThu6tuZyBKb2JTZXJ2aWNlLi4uIikKICAgICAgICBqb2Jfc2VydmljZS5mb3JjZV9zdG9wX2FsbCgpICAjIEThu6tuZyBuZ2F5IGzhuq1wIHThu6ljCiAgICAgICAgCiAgICBpZiBtcXR0X3NlcnZpY2U6CiAgICAgICAgbG9nZ2VyLmluZm8oIk5n4bqvdCBr4bq/dCBu4buRaSBNUVRULi4uIikKICAgICAgICBtcXR0X3NlcnZpY2UuZGlzY29ubmVjdCgpICAjIE5n4bqvdCBr4bq/dCBu4buRaSBNUVRUCiAgICAgICAgCiAgICAjIMSQw7NuZyBr4bq/dCBu4buRaSBkYXRhYmFzZSBu4bq/dSBj4bqnbgogICAgaWYgZGI6CiAgICAgICAgbG9nZ2VyLmluZm8oIsSQw7NuZyBr4bq/dCBu4buRaSBkYXRhYmFzZS4uLiIpCiAgICAgICAgZGIuY2xvc2UoKQogICAgCiAgICBsb2dnZXIuaW5mbygi4buobmcgZOG7pW5nIMSRw6MgZOG7q25nIGFuIHRvw6BuLiBU4bqhbSBiaeG7h3QhIikKICAgIHN5cy5leGl0KDApCgpkZWYgbWFpbigpOgogICAgIiIiSMOgbSBjaMOtbmggY+G7p2Eg4bupbmcgZOG7pW5nIiIiCiAgICBnbG9iYWwgcnVubmluZywgZGIsIGhlbHBlciwgZ29saWtlX3NlcnZpY2UsIGpvYl9zZXJ2aWNlLCBtcXR0X3NlcnZpY2UKICAgIAogICAgdHJ5OgogICAgICAgICMgS+G6v3QgbuG7kWkgQURCCiAgICAgICAgdXRpbHMuY29ubmVjdF9hZGIoY29uZmlnLkFEQl9IT1NULCBjb25maWcuQURCX1BPUlQpCiAgICAgICAgCiAgICAgICAgIyBLaOG7n2kgdOG6oW8gY8OhYyBzZXJ2aWNlCiAgICAgICAgbG9nZ2VyLmluZm8oIkto4bufaSB04bqhbyBjw6FjIHNlcnZpY2UuLi4iKQogICAgICAgIGRiID0gRGF0YWJhc2VTZXJ2aWNlKGRiX3BhdGg9Y29uZmlnLkRCX1BBVEgsIGRlZmF1bHRfY29uZmlnX3BhdGg9Y29uZmlnLkRFRkFVTFRfQ09ORklHX1BBVEgpCiAgICAgICAgaGVscGVyID0gSGVscGVyU2VydmljZShiYXNlX3VybD1jb25maWcuSEVMUEVSX1NFUlZJQ0VfVVJMKQogICAgICAgIGdvbGlrZV9zZXJ2aWNlID0gR29MaWtlU2VydmljZShkYiwgaGVscGVyKQogICAgICAgIAogICAgICAgIGxvZ2dlci5pbmZvKCJLaOG7n2kgxJHhu5luZyDhu6luZyBk4bulbmcgRE5EVmluYS4uLiIpCiAgICAgICAgCiAgICAgICAgIyBWaeG7h2MgxJHhuqd1IHRpw6puOiBM4bqleSBkZXZpY2VfaWQKICAgICAgICBsb2dnZXIuaW5mbygixJBhbmcgbOG6pXkgZGV2aWNlX2lkLi4uIikKICAgICAgICBkZXZpY2VfaWQgPSBkYi5nZXRfb3JfY3JlYXRlX2RldmljZV9pZCgpCiAgICAgICAgbG9nZ2VyLmluZm8oZiJEZXZpY2UgSUQ6IHtkZXZpY2VfaWR9IikKICAgICAgICAKICAgICAgICAjIEto4bufaSB04bqhbyBNUVRUIHNlcnZpY2UKICAgICAgICBtcXR0X3NlcnZpY2UgPSBNUVRUU2VydmljZShkYiwgZGV2aWNlX2lkLCBoZWxwZXIpCiAgICAgICAgCiAgICAgICAgIyBLaOG7n2kgxJHhu5luZyBKb2JTZXJ2aWNlCiAgICAgICAgbG9nZ2VyLmluZm8oIkto4bufaSDEkeG7mW5nIEpvYlNlcnZpY2UuLi4iKQogICAgICAgIGpvYl9zZXJ2aWNlID0gSm9iU2VydmljZShkYiwgaGVscGVyLCBnb2xpa2Vfc2VydmljZSwgbXF0dF9zZXJ2aWNlKQogICAgICAgIAogICAgICAgICMgR8OhbiBKb2JTZXJ2aWNlIHbDoG8gTVFUVFNlcnZpY2UgxJHhu4MgeOG7rSBsw70gY29uZmlnIHVwZGF0ZXMKICAgICAgICBtcXR0X3NlcnZpY2Uuc2V0X2pvYl9zZXJ2aWNlKGpvYl9zZXJ2aWNlKQogICAgICAgIAogICAgICAgICMgS2jhu59pIMSR4buZbmcgTVFUVCBzZXJ2aWNlIC0gaMOgbSBuw6B5IHPhur0gdOG7sSBjaOG7nSBr4bq/dCBu4buRaSB0aMOgbmggY8O0bmcgdsOgIMSRxINuZyBrw70gaGFuZGxlcnMKICAgICAgICBsb2dnZXIuaW5mbygiS2jhu59pIMSR4buZbmcgTVFUVCBzZXJ2aWNlLi4uIikKICAgICAgICBtcXR0X3RocmVhZCA9IG1xdHRfc2VydmljZS5zdGFydCgpCiAgICAgICAgCiAgICAgICAgam9iX3RocmVhZCA9IGpvYl9zZXJ2aWNlLnN0YXJ0KCkKICAgICAgICAKICAgICAgICAjIFRow6ptIHbDsm5nIGzhurdwIGtp4buDbSB0cmEgxJHhu4MgZOG7hSBkw6BuZyBk4burbmcg4bupbmcgZOG7pW5nCiAgICAgICAgbG9nZ2VyLmluZm8oIuG7qG5nIGThu6VuZyDEkWFuZyBjaOG6oXkuIE5o4bqlbiBDdHJsK0MgxJHhu4MgZOG7q25nLi4uIikKICAgICAgICB3aGlsZSBydW5uaW5nOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgICAgICAgICAgICMgTuG6v3Ugc2lnbmFsX2hhbmRsZXIga2jDtG5nIMSRxrDhu6NjIGfhu41pIHbDrCBsw70gZG8gbsOgbyDEkcOzCiAgICAgICAgICAgICAgICBzaWduYWxfaGFuZGxlcihzaWduYWwuU0lHSU5ULCBOb25lKQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIAogICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgIGxvZ2dlci5pbmZvKCJOaOG6rW4gdMOtbiBoaeG7h3UgZOG7q25nIHThu6sgbmfGsOG7nWkgZMO5bmcsIMSRYW5nIHRob8OhdC4uLiIpCiAgICAgICAgc2lnbmFsX2hhbmRsZXIoc2lnbmFsLlNJR0lOVCwgTm9uZSkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXhjZXB0aW9uKGUsICJM4buXaSBraMO0bmcgeOG7rSBsw70gxJHGsOG7o2MgdHJvbmcgaMOgbSBtYWluIikKICAgICAgICAjIMSQ4bqjbSBi4bqjbyBk4burbmcgY8OhYyBzZXJ2aWNlIHRyxrDhu5tjIGtoaSB0aG/DoXQKICAgICAgICBzaWduYWxfaGFuZGxlcihzaWduYWwuU0lHSU5ULCBOb25lKQogICAgICAgIHN5cy5leGl0KDEpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgIyDEkMSDbmcga8O9IHNpZ25hbCBoYW5kbGVyCiAgICBzaWduYWwuc2lnbmFsKHNpZ25hbC5TSUdJTlQsIHNpZ25hbF9oYW5kbGVyKQogICAgc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHVEVSTSwgc2lnbmFsX2hhbmRsZXIpCiAgICAKICAgICMgS2jhu59pIGNo4bqheSBjaMawxqFuZyB0csOsbmgKICAgIG1haW4oKQ==').decode('utf-8'))
