import base64
exec(base64.b64decode('aW1wb3J0IHRpbWUKaW1wb3J0IHRocmVhZGluZwppbXBvcnQgb3MKaW1wb3J0IHNpZ25hbAppbXBvcnQgc3lzCmZyb20gdHlwaW5nIGltcG9ydCBEaWN0LCBBbnksIE9wdGlvbmFsLCBMaXN0CmZyb20gc2VydmljZXMuaGVscGVyX3NlcnZpY2UgaW1wb3J0IEhlbHBlclNlcnZpY2UKZnJvbSBzZXJ2aWNlcy5kYl9zZXJ2aWNlIGltcG9ydCBEYXRhYmFzZVNlcnZpY2UKZnJvbSBzZXJ2aWNlcy5nb2xpa2Vfc2VydmljZSBpbXBvcnQgR29MaWtlU2VydmljZQpmcm9tIHNlcnZpY2VzLm1haW5fc2VydmljZSBpbXBvcnQgTWFpblNlcnZpY2UgICMgVGhheSDEkeG7lWk6IFPhu60gZOG7pW5nIE1haW5TZXJ2aWNlIHRoYXkgdsOsIEpvYlNlcnZpY2UKZnJvbSBzZXJ2aWNlcy5tcXR0X3NlcnZpY2UgaW1wb3J0IE1RVFRTZXJ2aWNlCmltcG9ydCB1dGlscwpmcm9tIHV0aWxzIGltcG9ydCBMb2dMZXZlbCwgTG9nZ2VyCmltcG9ydCBjb25maWcKCiMgVGhp4bq/dCBs4bqtcCBsb2dnaW5nCnV0aWxzLnNldHVwX2RlZmF1bHRfbG9nZ2luZygKICAgIHByb2R1Y3Rpb249bm90IGNvbmZpZy5ERUJVR19NT0RFIGlmIGhhc2F0dHIoY29uZmlnLCAnREVCVUdfTU9ERScpIGVsc2UgRmFsc2UsCiAgICBsb2dfdG9fZmlsZT1UcnVlIGlmIGhhc2F0dHIoY29uZmlnLCAnTE9HX1RPX0ZJTEUnKSBhbmQgY29uZmlnLkxPR19UT19GSUxFIGVsc2UgRmFsc2UKKQoKIyBU4bqhbyBsb2dnZXIgY2jDrW5oIGNobyDhu6luZyBk4bulbmcKbG9nZ2VyID0gdXRpbHMuZ2V0X2xvZ2dlcigiTWFpbldpdGhNYWluU2VydmljZSIpCgojIEJp4bq/biB0b8OgbiBj4bulYyDEkeG7gyBsxrB1IHNlcnZpY2UgaW5zdGFuY2VzCmRiID0gTm9uZQpoZWxwZXIgPSBOb25lCmdvbGlrZV9zZXJ2aWNlID0gTm9uZQptYWluX3NlcnZpY2UgPSBOb25lICAjIFRoYXkgxJHhu5VpOiDEkeG7lWkgdMOqbiB04burIGpvYl9zZXJ2aWNlIHRow6BuaCBtYWluX3NlcnZpY2UKbXF0dF9zZXJ2aWNlID0gTm9uZQoKIyBGbGFnIMSRaeG7gXUga2hp4buDbgpydW5uaW5nID0gVHJ1ZQoKZGVmIHNpZ25hbF9oYW5kbGVyKHNpZywgZnJhbWUpOgogICAgIiIiWOG7rSBsw70ga2hpIG5nxrDhu51pIGTDuW5nIG5o4bqlbiBDdHJsK0MiIiIKICAgIGdsb2JhbCBydW5uaW5nLCBtYWluX3NlcnZpY2UsIG1xdHRfc2VydmljZQogICAgCiAgICBsb2dnZXIuaW5mbygixJBhbmcgZOG7q25nIOG7qW5nIGThu6VuZyAoQ3RybCtDIMSRxrDhu6NjIG5o4bqlbikuLi4iKQogICAgcnVubmluZyA9IEZhbHNlCiAgICAKICAgICMgROG7q25nIGPDoWMgc2VydmljZSBt4buZdCBjw6FjaCBhbiB0b8OgbgogICAgaWYgbWFpbl9zZXJ2aWNlOgogICAgICAgIGxvZ2dlci5pbmZvKCJE4burbmcgTWFpblNlcnZpY2UuLi4iKQogICAgICAgIG1haW5fc2VydmljZS5mb3JjZV9zdG9wX2FsbCgpICAjIEThu6tuZyBuZ2F5IGzhuq1wIHThu6ljCiAgICAgICAgCiAgICBpZiBtcXR0X3NlcnZpY2U6CiAgICAgICAgbG9nZ2VyLmluZm8oIk5n4bqvdCBr4bq/dCBu4buRaSBNUVRULi4uIikKICAgICAgICBtcXR0X3NlcnZpY2UuZGlzY29ubmVjdCgpICAjIE5n4bqvdCBr4bq/dCBu4buRaSBNUVRUCiAgICAgICAgCiAgICAjIMSQw7NuZyBr4bq/dCBu4buRaSBkYXRhYmFzZSBu4bq/dSBj4bqnbgogICAgaWYgZGI6CiAgICAgICAgbG9nZ2VyLmluZm8oIsSQw7NuZyBr4bq/dCBu4buRaSBkYXRhYmFzZS4uLiIpCiAgICAgICAgZGIuY2xvc2UoKQogICAgCiAgICBsb2dnZXIuaW5mbygi4buobmcgZOG7pW5nIMSRw6MgZOG7q25nIGFuIHRvw6BuLiBU4bqhbSBiaeG7h3QhIikKICAgIHN5cy5leGl0KDApCgpkZWYgbWFpbigpOgogICAgIiIiSMOgbSBjaMOtbmggY+G7p2Eg4bupbmcgZOG7pW5nIC0gc+G7rSBk4bulbmcgTWFpblNlcnZpY2UiIiIKICAgIGdsb2JhbCBydW5uaW5nLCBkYiwgaGVscGVyLCBnb2xpa2Vfc2VydmljZSwgbWFpbl9zZXJ2aWNlLCBtcXR0X3NlcnZpY2UKICAgIAogICAgdHJ5OgogICAgICAgIGxvZ2dlci5pbmZvKCJLaOG7n2kgxJHhu5luZyDhu6luZyBk4bulbmcgRE5EVmluYS4uLiIpCgogICAgICAgICMgS+G6v3QgbuG7kWkgQURCCiAgICAgICAgdXRpbHMuY29ubmVjdF9hZGIoY29uZmlnLkFEQl9IT1NULCBjb25maWcuQURCX1BPUlQpCiAgICAgICAgIyBLaOG7n2kgdOG6oW8gY8OhYyBzZXJ2aWNlCiAgICAgICAgbG9nZ2VyLmluZm8oIkto4bufaSB04bqhbyBjw6FjIHNlcnZpY2UuLi4iKQogICAgICAgIGRiID0gRGF0YWJhc2VTZXJ2aWNlKGRiX3BhdGg9Y29uZmlnLkRCX1BBVEgsIGRlZmF1bHRfY29uZmlnX3BhdGg9Y29uZmlnLkRFRkFVTFRfQ09ORklHX1BBVEgpCiAgICAgICAgaGVscGVyID0gSGVscGVyU2VydmljZShiYXNlX3VybD1jb25maWcuSEVMUEVSX1NFUlZJQ0VfVVJMKQogICAgICAgIGdvbGlrZV9zZXJ2aWNlID0gR29MaWtlU2VydmljZShkYiwgaGVscGVyKQoKICAgICAgICAjIFZp4buHYyDEkeG6p3UgdGnDqm46IEzhuqV5IGRldmljZV9pZAogICAgICAgIGxvZ2dlci5pbmZvKCLEkGFuZyBs4bqleSBkZXZpY2VfaWQuLi4iKQogICAgICAgIGRldmljZV9pZCA9IGRiLmdldF9vcl9jcmVhdGVfZGV2aWNlX2lkKCkKICAgICAgICBsb2dnZXIuaW5mbyhmIkRldmljZSBJRDoge2RldmljZV9pZH0iKQogICAgICAgIAogICAgICAgICMgS2jhu59pIHThuqFvIE1RVFQgc2VydmljZQogICAgICAgIG1xdHRfc2VydmljZSA9IE1RVFRTZXJ2aWNlKGRiLCBkZXZpY2VfaWQsIGhlbHBlcikKICAgICAgICAKICAgICAgICAjIEto4bufaSDEkeG7mW5nIE1haW5TZXJ2aWNlIHRoYXkgdsOsIEpvYlNlcnZpY2UKICAgICAgICBsb2dnZXIuaW5mbygiS2jhu59pIMSR4buZbmcgTWFpblNlcnZpY2UgKHRoYXkgdGjhur8gSm9iU2VydmljZSkuLi4iKQogICAgICAgIG1haW5fc2VydmljZSA9IE1haW5TZXJ2aWNlKGRiLCBoZWxwZXIsIGdvbGlrZV9zZXJ2aWNlLCBtcXR0X3NlcnZpY2UpCiAgICAgICAgCiAgICAgICAgIyBHw6FuIE1haW5TZXJ2aWNlIHbDoG8gTVFUVFNlcnZpY2UgxJHhu4MgeOG7rSBsw70gY29uZmlnIHVwZGF0ZXMKICAgICAgICAjIEzGsHUgw706IE1RVFQgc2VydmljZSBj4bqnbiBtZXRob2QgdMawxqFuZyB0aMOtY2ggduG7m2kgSm9iU2VydmljZQogICAgICAgIG1xdHRfc2VydmljZS5zZXRfam9iX3NlcnZpY2UobWFpbl9zZXJ2aWNlKQogICAgICAgIAogICAgICAgICMgS2jhu59pIMSR4buZbmcgTVFUVCBzZXJ2aWNlCiAgICAgICAgbG9nZ2VyLmluZm8oIkto4bufaSDEkeG7mW5nIE1RVFQgc2VydmljZS4uLiIpCiAgICAgICAgbXF0dF90aHJlYWQgPSBtcXR0X3NlcnZpY2Uuc3RhcnQoKQogICAgICAgIAogICAgICAgICMgS2jhu59pIMSR4buZbmcgTWFpblNlcnZpY2UgdHJvbmcgdGhyZWFkIHJpw6puZwogICAgICAgIGxvZ2dlci5pbmZvKCJLaOG7n2kgxJHhu5luZyBNYWluU2VydmljZSB0aHJlYWQuLi4iKQogICAgICAgIG1haW5fdGhyZWFkID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9bWFpbl9zZXJ2aWNlLnN0YXJ0LCBkYWVtb249VHJ1ZSkKICAgICAgICBtYWluX3RocmVhZC5zdGFydCgpCiAgICAgICAgCiAgICAgICAgIyBUaMOqbSB2w7JuZyBs4bq3cCBraeG7g20gdHJhIMSR4buDIGThu4UgZMOgbmcgZOG7q25nIOG7qW5nIGThu6VuZwogICAgICAgIGxvZ2dlci5pbmZvKCLhu6huZyBk4bulbmcgxJFhbmcgY2jhuqF5IHbhu5tpIE1haW5TZXJ2aWNlLiBOaOG6pW4gQ3RybCtDIMSR4buDIGThu6tuZy4uLiIpCgogICAgICAgIHdoaWxlIHJ1bm5pbmc6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkgICAgICAgICAgIAogICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgICAgICAjIE7hur91IHNpZ25hbF9oYW5kbGVyIGtow7RuZyDEkcaw4bujYyBn4buNaSB2w6wgbMO9IGRvIG7DoG8gxJHDswogICAgICAgICAgICAgICAgc2lnbmFsX2hhbmRsZXIoc2lnbmFsLlNJR0lOVCwgTm9uZSkKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAKICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgICBsb2dnZXIuaW5mbygiTmjhuq1uIHTDrW4gaGnhu4d1IGThu6tuZyB04burIG5nxrDhu51pIGTDuW5nLCDEkWFuZyB0aG/DoXQuLi4iKQogICAgICAgIHNpZ25hbF9oYW5kbGVyKHNpZ25hbC5TSUdJTlQsIE5vbmUpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmV4Y2VwdGlvbihlLCAiTOG7l2kga2jDtG5nIHjhu60gbMO9IMSRxrDhu6NjIHRyb25nIGjDoG0gbWFpbiIpCiAgICAgICAgIyDEkOG6o20gYuG6o28gZOG7q25nIGPDoWMgc2VydmljZSB0csaw4bubYyBraGkgdGhvw6F0CiAgICAgICAgc2lnbmFsX2hhbmRsZXIoc2lnbmFsLlNJR0lOVCwgTm9uZSkKICAgICAgICBzeXMuZXhpdCgxKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgICMgxJDEg25nIGvDvSBzaWduYWwgaGFuZGxlcgogICAgc2lnbmFsLnNpZ25hbChzaWduYWwuU0lHSU5ULCBzaWduYWxfaGFuZGxlcikKICAgIHNpZ25hbC5zaWduYWwoc2lnbmFsLlNJR1RFUk0sIHNpZ25hbF9oYW5kbGVyKQogICAgCiAgICAjIEto4bufaSBjaOG6oXkgY2jGsMahbmcgdHLDrG5oCiAgICBtYWluKCkK').decode('utf-8'))
