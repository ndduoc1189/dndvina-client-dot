import base64
exec(base64.b64decode('aW1wb3J0IHRpbWUKaW1wb3J0IHJhbmRvbQppbXBvcnQgdW5pY29kZWRhdGEKZnJvbSBzZXJ2aWNlcy5oZWxwZXJfc2VydmljZSBpbXBvcnQgSGVscGVyU2VydmljZQoKZGVmIHJlbW92ZV92aWV0bmFtZXNlX2FjY2VudHModGV4dCk6CiAgICB0ZXh0ID0gdW5pY29kZWRhdGEubm9ybWFsaXplKCdORkQnLCB0ZXh0KQogICAgdGV4dCA9ICcnLmpvaW4oW2MgZm9yIGMgaW4gdGV4dCBpZiB1bmljb2RlZGF0YS5jYXRlZ29yeShjKSAhPSAnTW4nXSkKICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoJ8SRJywgJ2QnKS5yZXBsYWNlKCfEkCcsICdEJykKICAgIHJldHVybiB0ZXh0CgpkZWYgcmFuZG9tX2JpcnRoZGF5KCk6CiAgICB5ZWFyID0gcmFuZG9tLnJhbmRpbnQoMTk5NCwgMjAwNSkKICAgIG1vbnRoID0gcmFuZG9tLnJhbmRpbnQoMSwgMTIpCiAgICBpZiBtb250aCA9PSAyOgogICAgICAgIGRheSA9IHJhbmRvbS5yYW5kaW50KDEsIDI4KQogICAgZWxpZiBtb250aCBpbiBbNCwgNiwgOSwgMTFdOgogICAgICAgIGRheSA9IHJhbmRvbS5yYW5kaW50KDEsIDMwKQogICAgZWxzZToKICAgICAgICBkYXkgPSByYW5kb20ucmFuZGludCgxLCAzMSkKICAgIHJldHVybiBkYXksIG1vbnRoLCB5ZWFyCgpkZWYgcmVnaXN0ZXJfaW5zdGFncmFtX2FjY291bnQoaXA9IjEwLjAuNC4zNiIgKToKICAgIGhlbHBlciA9IEhlbHBlclNlcnZpY2UoYmFzZV91cmw9ZiJodHRwOi8ve2lwfTo5MDk5IikKICAgIG5hbWVzPSJOZ3V54buFbiBUaOG7iyBMYW58VHLhuqduIFRo4buLIEhvYXxMw6ogVGjhu4sgSMawxqFuZ3xQaOG6oW0gVGjhu4sgSOG6sW5nfEhvw6BuZyBUaOG7iyBUaHV8SHXhu7NuaCBUaOG7iyBNYWl8UGhhbiBUaOG7iyBI4bqhbmh8VsWpIFRo4buLIE5n4buNY3xWw7UgVGjhu4sgTWluaHzEkOG6t25nIFRo4buLIEhp4buBbnxCw7lpIFRo4buLIER1bmd8xJDhu5cgVGjhu4sgVHJhbmd8SOG7kyBUaOG7iyBQaMawxqFuZ3xOZ8O0IFRo4buLIFF1ecOqbnxExrDGoW5nIFRo4buLIFnhur9ufEzDvSBUaOG7iyBOaHVuZ3xOZ3V54buFbiBUaOG7iyBUdXnhur90fFRy4bqnbiBUaOG7iyBWw6JufEzDqiBUaOG7iyBUaGFuaHxQaOG6oW0gVGjhu4sgVMOibXxIb8OgbmcgVGjhu4sgSG9hfEh14buzbmggVGjhu4sgSMawxqFuZ3xQaGFuIFRo4buLIEjhurFuZ3xWxakgVGjhu4sgVGh1fFbDtSBUaOG7iyBNYWl8xJDhurduZyBUaOG7iyBI4bqhbmh8QsO5aSBUaOG7iyBOZ+G7jWN8xJDhu5cgVGjhu4sgTWluaHxI4buTIFRo4buLIEhp4buBbnxOZ8O0IFRo4buLIER1bmd8RMawxqFuZyBUaOG7iyBUcmFuZ3xMw70gVGjhu4sgUGjGsMahbmd8Tmd1eeG7hW4gVGjhu4sgUXV5w6pufFRy4bqnbiBUaOG7iyBZ4bq/bnxMw6ogVGjhu4sgTmh1bmd8UGjhuqFtIFRo4buLIFR1eeG6v3R8SG/DoG5nIFRo4buLIFbDom58SHXhu7NuaCBUaOG7iyBUaGFuaHxQaGFuIFRo4buLIFTDom18VsWpIFRo4buLIExhbnxWw7UgVGjhu4sgSG9hfMSQ4bq3bmcgVGjhu4sgSMawxqFuZ3xCw7lpIFRo4buLIEjhurFuZ3zEkOG7lyBUaOG7iyBUaHV8SOG7kyBUaOG7iyBNYWl8TmfDtCBUaOG7iyBI4bqhbmh8RMawxqFuZyBUaOG7iyBOZ+G7jWN8TMO9IFRo4buLIE1pbmh8Tmd1eeG7hW4gVGjhu4sgSGnhu4FufFRy4bqnbiBUaOG7iyBEdW5nfEzDqiBUaOG7iyBUcmFuZ3xQaOG6oW0gVGjhu4sgUGjGsMahbmd8SG/DoG5nIFRo4buLIFF1ecOqbnxIdeG7s25oIFRo4buLIFnhur9ufFBoYW4gVGjhu4sgTmh1bmd8VsWpIFRo4buLIFR1eeG6v3R8VsO1IFRo4buLIFbDom58xJDhurduZyBUaOG7iyBUaGFuaHxCw7lpIFRo4buLIFTDom18xJDhu5cgVGjhu4sgTGFufEjhu5MgVGjhu4sgSG9hfE5nw7QgVGjhu4sgSMawxqFuZ3xExrDGoW5nIFRo4buLIEjhurFuZ3xMw70gVGjhu4sgVGh1fE5ndXnhu4VuIFRo4buLIE1haXxUcuG6p24gVGjhu4sgSOG6oW5ofEzDqiBUaOG7iyBOZ+G7jWN8UGjhuqFtIFRo4buLIE1pbmh8SG/DoG5nIFRo4buLIEhp4buBbnxIdeG7s25oIFRo4buLIER1bmd8UGhhbiBUaOG7iyBUcmFuZ3xWxakgVGjhu4sgUGjGsMahbmd8VsO1IFRo4buLIFF1ecOqbnzEkOG6t25nIFRo4buLIFnhur9ufELDuWkgVGjhu4sgTmh1bmd8xJDhu5cgVGjhu4sgVHV54bq/dHxI4buTIFRo4buLIFbDom58TmfDtCBUaOG7iyBUaGFuaHxExrDGoW5nIFRo4buLIFTDom18TMO9IFRo4buLIExhbnxOZ3V54buFbiBUaOG7iyBIb2F8VHLhuqduIFRo4buLIEjGsMahbmd8TMOqIFRo4buLIEjhurFuZ3xQaOG6oW0gVGjhu4sgVGh1fEhvw6BuZyBUaOG7iyBNYWl8SHXhu7NuaCBUaOG7iyBI4bqhbmh8UGhhbiBUaOG7iyBOZ+G7jWN8VsWpIFRo4buLIE1pbmh8VsO1IFRo4buLIEhp4buBbnzEkOG6t25nIFRo4buLIER1bmd8QsO5aSBUaOG7iyBUcmFuZ3zEkOG7lyBUaOG7iyBQaMawxqFuZ3xI4buTIFRo4buLIFF1ecOqbnxOZ8O0IFRo4buLIFnhur9ufETGsMahbmcgVGjhu4sgTmh1bmd8TMO9IFRo4buLIFR1eeG6v3R8Tmd1eeG7hW4gVGjhu4sgVsOibnxUcuG6p24gVGjhu4sgVGhhbmh8TMOqIFRo4buLIFTDom18UGjhuqFtIFRo4buLIExhbnxIb8OgbmcgVGjhu4sgSG9hfEh14buzbmggVGjhu4sgSMawxqFuZ3xQaGFuIFRo4buLIEjhurFuZ3xWxakgVGjhu4sgVGh1fFbDtSBUaOG7iyBNYWl8xJDhurduZyBUaOG7iyBI4bqhbmh8QsO5aSBUaOG7iyBOZ+G7jWN8xJDhu5cgVGjhu4sgTWluaHxI4buTIFRo4buLIEhp4buBbnxOZ8O0IFRo4buLIER1bmd8RMawxqFuZyBUaOG7iyBUcmFuZ3xMw70gVGjhu4sgUGjGsMahbmd8Tmd1eeG7hW4gVGjhu4sgUXV5w6pufFRy4bqnbiBUaOG7iyBZ4bq/bnxMw6ogVGjhu4sgTmh1bmd8UGjhuqFtIFRo4buLIFR1eeG6v3R8SG/DoG5nIFRo4buLIFbDom58SHXhu7NuaCBUaOG7iyBUaGFuaHxQaGFuIFRo4buLIFTDom18VsWpIFRo4buLIExhbnxWw7UgVGjhu4sgSG9hfMSQ4bq3bmcgVGjhu4sgSMawxqFuZ3xCw7lpIFRo4buLIEjhurFuZ3zEkOG7lyBUaOG7iyBUaHV8SOG7kyBUaOG7iyBNYWl8TmfDtCBUaOG7iyBI4bqhbmh8RMawxqFuZyBUaOG7iyBOZ+G7jWN8TMO9IFRo4buLIE1pbmh8Tmd1eeG7hW4gVGjhu4sgSGnhu4FufFRy4bqnbiBUaOG7iyBEdW5nfEzDqiBUaOG7iyBUcmFuZ3xQaOG6oW0gVGjhu4sgUGjGsMahbmd8SG/DoG5nIFRo4buLIFF1ecOqbnxIdeG7s25oIFRo4buLIFnhur9ufFBoYW4gVGjhu4sgTmh1bmd8VsWpIFRo4buLIFR1eeG6v3R8VsO1IFRo4buLIFbDom58xJDhurduZyBUaOG7iyBUaGFuaHxCw7lpIFRo4buLIFTDom18xJDhu5cgVGjhu4sgTGFufEjhu5MgVGjhu4sgSG9hfE5nw7QgVGjhu4sgSMawxqFuZ3xExrDGoW5nIFRo4buLIEjhurFuZ3xMw70gVGjhu4sgVGh1fE5ndXnhu4VuIFRo4buLIE1haXxUcuG6p24gVGjhu4sgSOG6oW5ofEzDqiBUaOG7iyBOZ+G7jWN8UGjhuqFtIFRo4buLIE1pbmh8SG/DoG5nIFRo4buLIEhp4buBbnxIdeG7s25oIFRo4buLIER1bmd8UGhhbiBUaOG7iyBUcmFuZ3xWxakgVGjhu4sgUGjGsMahbmd8VsO1IFRo4buLIFF1ecOqbnzEkOG6t25nIFRo4buLIFnhur9ufELDuWkgVGjhu4sgTmh1bmd8xJDhu5cgVGjhu4sgVHV54bq/dHxI4buTIFRo4buLIFbDom58TmfDtCBUaOG7iyBUaGFuaHxExrDGoW5nIFRo4buLIFTDom18TMO9IFRo4buLIExhbnxOZ3V54buFbiBUaOG7iyBIb2F8VHLhuqduIFRo4buLIEjGsMahbmd8TMOqIFRo4buLIEjhurFuZ3xQaOG6oW0gVGjhu4sgVGh1fEhvw6BuZyBUaOG7iyBNYWl8SHXhu7NuaCBUaOG7iyBI4bqhbmh8UGhhbiBUaOG7iyBOZ+G7jWN8VsWpIFRo4buLIE1pbmh8VsO1IFRo4buLIEhp4buBbnzEkOG6t25nIFRo4buLIER1bmd8QsO5aSBUaOG7iyBUcmFuZ3zEkOG7lyBUaOG7iyBQaMawxqFuZ3xI4buTIFRo4buLIFF1ecOqbnxOZ8O0IFRo4buLIFnhur9ufETGsMahbmcgVGjhu4sgTmh1bmd8TMO9IFRo4buLIFR1eeG6v3R8Tmd1eeG7hW4gVGjhu4sgVsOibnxUcuG6p24gVGjhu4sgVGhhbmh8TMOqIFRo4buLIFTDom18UGjhuqFtIFRo4buLIExhbnxIb8OgbmcgVGjhu4sgSG9hfEh14buzbmggVGjhu4sgSMawxqFuZ3xQaGFuIFRo4buLIEjhurFuZ3xWxakgVGjhu4sgVGh1fFbDtSBUaOG7iyBNYWl8xJDhurduZyBUaOG7iyBI4bqhbmh8QsO5aSBUaOG7iyBOZ+G7jWN8xJDhu5cgVGjhu4sgTWluaHxI4buTIFRo4buLIEhp4buBbnxOZ8O0IFRo4buLIER1bmd8RMawxqFuZyBUaOG7iyBUcmFuZ3xMw70gVGjhu4sgUGjGsMahbmd8Tmd1eeG7hW4gVGjhu4sgUXV5w6pufFRy4bqnbiBUaOG7iyBZ4bq/bnxMw6ogVGjhu4sgTmh1bmd8UGjhuqFtIFRo4buLIFR1eeG6v3R8SG/DoG5nIFRo4buLIFbDom58SHXhu7NuaCBUaOG7iyBUaGFuaHxQaGFuIFRo4buLIFTDom18VsWpIFRo4buLIExhbnxWw7UgVGjhu4sgSG9hfMSQ4bq3bmcgVGjhu4sgSMawxqFuZ3xCw7lpIFRo4buLIEjhurFuZ3zEkOG7lyBUaOG7iyBUaHV8SOG7kyBUaOG7iyBNYWl8TmfDtCBUaOG7iyBI4bqhbmh8RMawxqFuZyBUaOG7iyBOZ+G7jWN8TMO9IFRo4buLIE1pbmh8Tmd1eeG7hW4gVGjhu4sgSGnhu4FufFRy4bqnbiBUaOG7iyBEdW5nfEzDqiBUaOG7iyBUcmFuZ3xQaOG6oW0gVGjhu4sgUGjGsMahbmd8SG/DoG5nIFRo4buLIFF1ecOqbnxIdeG7s25oIFRo4buLIFnhur9ufFBoYW4gVGjhu4sgTmh1bmd8VsWpIFRo4buLIFR1eeG6v3R8VsO1IFRo4buLIFbDom58xJDhurduZyBUaOG7iyBUaGFuaHxCw7lpIFRo4buLIFTDom0iCiAgICBhcHBfcGFja2FnZSA9ICJjb20uaW5zdGFncmFtLmFuZHJvaWQiCiAgICBwcmludCgiWytdIMSQw7NuZyBhcHAgSW5zdGFncmFtLi4uIikKICAgIGhlbHBlci5jbG9zZV9hcHAoYXBwX3BhY2thZ2UpCiAgICB0aW1lLnNsZWVwKDIpCiAgICBwcmludCgiWytdIE3hu58gYXBwIEluc3RhZ3JhbS4uLiIpCiAgICBoZWxwZXIub3Blbl9hcHAoYXBwX3BhY2thZ2UpCiAgICB0aW1lLnNsZWVwKDUpCgogICAgIyBWw6BvIHByb2ZpbGUKICAgIHByaW50KCJbK10gVsOgbyB0YWIgVHJhbmcgY8OhIG5ow6JuLi4uIikKICAgIGZvciBfIGluIHJhbmdlKDMpOgogICAgICAgIHNjcmVlbl94bWwgPSBoZWxwZXIuZHVtcF9zY3JlZW5feG1sKCkKICAgICAgICBwcm9maWxlX3RhYiA9IGhlbHBlci5maW5kX2VsZW1lbnRfaW5feG1sKHNjcmVlbl94bWwsIGNvbnRlbnRfZGVzYz0iVHJhbmcgY8OhIG5ow6JuIikKICAgICAgICBpZiBwcm9maWxlX3RhYjoKICAgICAgICAgICAgaGVscGVyLnRhcF9lbGVtZW50X2NlbnRlcihwcm9maWxlX3RhYikKICAgICAgICAgICAgdGltZS5zbGVlcCgyKQogICAgICAgICAgICBicmVhawogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhlbHBlci5zd2lwZV91cCgpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKCiAgICAjIELhuqVtIHbDoG8gdGnDqnUgxJHhu4EgdXNlcm5hbWUgxJHhu4MgbeG7nyBkYW5oIHPDoWNoIHTDoGkga2hv4bqjbgogICAgcHJpbnQoIlsrXSBN4bufIGRhbmggc8OhY2ggdMOgaSBraG/huqNuLi4uIikKICAgIGZvciBfIGluIHJhbmdlKDMpOgogICAgICAgIHNjcmVlbl94bWwgPSBoZWxwZXIuZHVtcF9zY3JlZW5feG1sKCkKICAgICAgICB1c2VybmFtZV90aXRsZSA9IGhlbHBlci5maW5kX2VsZW1lbnRfaW5feG1sKHNjcmVlbl94bWwsIHJlc291cmNlX2lkPSJjb20uaW5zdGFncmFtLmFuZHJvaWQ6aWQvYWN0aW9uX2Jhcl9sYXJnZV90aXRsZV9hdXRvX3NpemUiKQogICAgICAgIGlmIHVzZXJuYW1lX3RpdGxlOgogICAgICAgICAgICBoZWxwZXIudGFwX2VsZW1lbnRfY2VudGVyKHVzZXJuYW1lX3RpdGxlKQogICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGVscGVyLnN3aXBlX2Rvd24oKQogICAgICAgICAgICB0aW1lLnNsZWVwKDEpCgogICAgIyBC4bqlbSBUaMOqbSB0w6BpIGtob+G6o24KICAgIHByaW50KCJbK10gQuG6pW0gVGjDqm0gdMOgaSBraG/huqNuLi4uIikKICAgIGZvciBfIGluIHJhbmdlKDMpOgogICAgICAgIHNjcmVlbl94bWwgPSBoZWxwZXIuZHVtcF9zY3JlZW5feG1sKCkKICAgICAgICBhZGRfYWNjb3VudCA9IGhlbHBlci5maW5kX2VsZW1lbnRfaW5feG1sKHNjcmVlbl94bWwsIGNvbnRlbnRfZGVzYz0iVGjDqm0gdMOgaSBraG/huqNuIEluc3RhZ3JhbSIpCiAgICAgICAgaWYgYWRkX2FjY291bnQ6CiAgICAgICAgICAgIGhlbHBlci50YXBfZWxlbWVudF9jZW50ZXIoYWRkX2FjY291bnQpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMikKICAgICAgICAgICAgYnJlYWsKICAgICAgICBlbHNlOgogICAgICAgICAgICBoZWxwZXIuc3dpcGVfdXAoKQogICAgICAgICAgICB0aW1lLnNsZWVwKDEpCgogICAgaGVscGVyLndhaXRfZm9yX2VsZW1lbnQodGV4dD0iVOG6oW8gdMOgaSBraG/huqNuIG3hu5tpIikKICAgICMgQuG6pW0gVOG6oW8gdMOgaSBraG/huqNuIG3hu5tpCiAgICBwcmludCgiWytdIELhuqVtIFThuqFvIHTDoGkga2hv4bqjbiBt4bubaS4uLiIpCiAgICBmb3IgXyBpbiByYW5nZSgzKToKICAgICAgICBzY3JlZW5feG1sID0gaGVscGVyLmR1bXBfc2NyZWVuX3htbCgpCiAgICAgICAgY3JlYXRlX2FjY291bnQgPSBoZWxwZXIuZmluZF9lbGVtZW50X2luX3htbChzY3JlZW5feG1sLCB0ZXh0PSJU4bqhbyB0w6BpIGtob+G6o24gbeG7m2kiKQogICAgICAgIGlmIGNyZWF0ZV9hY2NvdW50OgogICAgICAgICAgICBoZWxwZXIudGFwX2VsZW1lbnRfY2VudGVyKGNyZWF0ZV9hY2NvdW50KQogICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGVscGVyLnN3aXBlX3VwKCkKICAgICAgICAgICAgdGltZS5zbGVlcCgxKQoKICAgICMgU2luaCB0aMO0bmcgdGluIHJhbmRvbQogICAgbmFtZV9saXN0ID0gbmFtZXMuc3BsaXQoInwiKQogICAgZnVsbF9uYW1lID0gcmFuZG9tLmNob2ljZShuYW1lX2xpc3QpLnN0cmlwKCkKICAgIGRheSwgbW9udGgsIHllYXIgPSByYW5kb21fYmlydGhkYXkoKQogICAgYmFzZV91c2VybmFtZSA9IHJlbW92ZV92aWV0bmFtZXNlX2FjY2VudHMoZnVsbF9uYW1lKS5yZXBsYWNlKCIgIiwgIiIpLmxvd2VyKCkKICAgIGJhc2VfdXNlcm5hbWUgPSAnJy5qb2luKGMgZm9yIGMgaW4gYmFzZV91c2VybmFtZSBpZiBjLmlzYWxudW0oKSkKICAgIHVzZXJuYW1lID0gZiJ7YmFzZV91c2VybmFtZX17ZGF5OjAyZH17bW9udGg6MDJkfXtzdHIoeWVhcilbLTI6XX17cmFuZG9tLnJhbmRpbnQoMSw5OSk6MDJkfSIKICAgIGVtYWlsID0gZiJ7dXNlcm5hbWV9QGRuZHZpbmEuY29tIgogICAgcHJpbnQoZiJbK10gVGjDtG5nIHRpbiDEkcSDbmcga8O9OiB7ZnVsbF9uYW1lfSwge2RheTowMmR9L3ttb250aDowMmR9L3t5ZWFyfSwge3VzZXJuYW1lfSwge2VtYWlsfSIpCgogICAgIyBOaOG6rXAgdXNlcm5hbWUKICAgIHByaW50KCJbK10gTmjhuq1wIHVzZXJuYW1lLi4uIikKICAgIGZvciBfIGluIHJhbmdlKDMpOgogICAgICAgIHNjcmVlbl94bWwgPSBoZWxwZXIuZHVtcF9zY3JlZW5feG1sKCkKICAgICAgICB1c2VybmFtZV9pbnB1dCA9IGhlbHBlci5maW5kX2VsZW1lbnRfaW5feG1sKHNjcmVlbl94bWwsIHJlc291cmNlX2lkPSJjb20uaW5zdGFncmFtLmFuZHJvaWQ6aWQvdXNlcm5hbWUiKQogICAgICAgIGlmIG5vdCB1c2VybmFtZV9pbnB1dDoKICAgICAgICAgICAgdXNlcm5hbWVfaW5wdXQgPSBoZWxwZXIuZmluZF9lbGVtZW50X2luX3htbChzY3JlZW5feG1sLCBjbGFzc19uYW1lPSJhbmRyb2lkLndpZGdldC5FZGl0VGV4dCIpCiAgICAgICAgaWYgdXNlcm5hbWVfaW5wdXQ6CiAgICAgICAgICAgIGhlbHBlci50YXBfZWxlbWVudF9jZW50ZXIodXNlcm5hbWVfaW5wdXQpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKICAgICAgICAgICAgaGVscGVyLmlucHV0X3RleHQodXNlcm5hbWUpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoNSkKICAgICAgICAgICAgIyBC4bqlbSBUaeG6v3AKICAgICAgICAgICAgbmV4dF9idG4gPSBoZWxwZXIuZmluZF9lbGVtZW50X2luX3htbChzY3JlZW5feG1sLCB0ZXh0PSJUaeG6v3AiKQogICAgICAgICAgICBpZiBuZXh0X2J0bjoKICAgICAgICAgICAgICAgIGhlbHBlci50YXBfZWxlbWVudF9jZW50ZXIobmV4dF9idG4pCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGVscGVyLnN3aXBlX3VwKCkKICAgICAgICAgICAgdGltZS5zbGVlcCgxKQoKICAgICMgTmjhuq1wIG3huq10IGto4bqpdQogICAgcHJpbnQoIlsrXSBOaOG6rXAgbeG6rXQga2jhuql1Li4uIikKICAgIGZvciBfIGluIHJhbmdlKDMpOgogICAgICAgIHNjcmVlbl94bWwgPSBoZWxwZXIuZHVtcF9zY3JlZW5feG1sKCkKICAgICAgICBwYXNzd29yZF9pbnB1dCA9IGhlbHBlci5maW5kX2VsZW1lbnRfaW5feG1sKHNjcmVlbl94bWwsIHJlc291cmNlX2lkPSJjb20uaW5zdGFncmFtLmFuZHJvaWQ6aWQvcGFzc3dvcmQiKQogICAgICAgIGlmIG5vdCBwYXNzd29yZF9pbnB1dDoKICAgICAgICAgICAgcGFzc3dvcmRfaW5wdXQgPSBoZWxwZXIuZmluZF9lbGVtZW50X2luX3htbChzY3JlZW5feG1sLCBjbGFzc19uYW1lPSJhbmRyb2lkLndpZGdldC5FZGl0VGV4dCIpCiAgICAgICAgaWYgcGFzc3dvcmRfaW5wdXQ6CiAgICAgICAgICAgIGhlbHBlci50YXBfZWxlbWVudF9jZW50ZXIocGFzc3dvcmRfaW5wdXQpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKICAgICAgICAgICAgaGVscGVyLmlucHV0X3RleHQoInRpbnRpbkAxMjMiKQogICAgICAgICAgICB0aW1lLnNsZWVwKDMpCiAgICAgICAgICAgICMgQuG6pW0gVGnhur9wCiAgICAgICAgICAgIG5leHRfYnRuID0gaGVscGVyLmZpbmRfZWxlbWVudF9pbl94bWwoc2NyZWVuX3htbCwgdGV4dD0iVGnhur9wIikKICAgICAgICAgICAgaWYgbmV4dF9idG46CiAgICAgICAgICAgICAgICBoZWxwZXIudGFwX2VsZW1lbnRfY2VudGVyKG5leHRfYnRuKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgyKQogICAgICAgICAgICBicmVhawogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGhlbHBlci5zd2lwZV91cCgpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKCiAgICAjIELhuqVtIHRow6ptIGVtYWlsL3Phu5EgxJFp4buHbiB0aG/huqFpIG3hu5tpCiAgICBwcmludCgiWytdIELhuqVtIFRow6ptIGVtYWlsIGhv4bq3YyBz4buRIMSRaeG7h24gdGhv4bqhaSBt4bubaS4uLiIpCiAgICBmb3IgXyBpbiByYW5nZSgzKToKICAgICAgICBzY3JlZW5feG1sID0gaGVscGVyLmR1bXBfc2NyZWVuX3htbCgpCiAgICAgICAgYWRkX2VtYWlsX2J0biA9IGhlbHBlci5maW5kX2VsZW1lbnRfaW5feG1sKHNjcmVlbl94bWwsIHRleHQ9IlRow6ptIGVtYWlsIGhv4bq3YyBz4buRIMSRaeG7h24gdGhv4bqhaSBt4bubaSIpCiAgICAgICAgaWYgYWRkX2VtYWlsX2J0bjoKICAgICAgICAgICAgaGVscGVyLnRhcF9lbGVtZW50X2NlbnRlcihhZGRfZW1haWxfYnRuKQogICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGVscGVyLnN3aXBlX3VwKCkKICAgICAgICAgICAgdGltZS5zbGVlcCgxKQoKICAgICMgQ2h1eeG7g24gc2FuZyB0YWIgRW1haWwKICAgIHByaW50KCJbK10gQ2h1eeG7g24gc2FuZyB0YWIgRW1haWwuLi4iKQogICAgZm9yIF8gaW4gcmFuZ2UoMyk6CiAgICAgICAgc2NyZWVuX3htbCA9IGhlbHBlci5kdW1wX3NjcmVlbl94bWwoKQogICAgICAgIGVtYWlsX3RhYiA9IGhlbHBlci5maW5kX2VsZW1lbnRfaW5feG1sKHNjcmVlbl94bWwsIHRleHQ9IkVNQUlMIikKICAgICAgICBpZiBlbWFpbF90YWI6CiAgICAgICAgICAgIGhlbHBlci50YXBfZWxlbWVudF9jZW50ZXIoZW1haWxfdGFiKQogICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGVscGVyLnN3aXBlX3VwKCkKICAgICAgICAgICAgdGltZS5zbGVlcCgxKQoKICAgICMgTmjhuq1wIGVtYWlsCiAgICBwcmludCgiWytdIE5o4bqtcCBlbWFpbC4uLiIpCiAgICBmb3IgXyBpbiByYW5nZSgzKToKICAgICAgICBzY3JlZW5feG1sID0gaGVscGVyLmR1bXBfc2NyZWVuX3htbCgpCiAgICAgICAgZW1haWxfaW5wdXQgPSBoZWxwZXIuZmluZF9lbGVtZW50X2luX3htbChzY3JlZW5feG1sLCBjbGFzc19uYW1lPSJhbmRyb2lkLndpZGdldC5FZGl0VGV4dCIpCiAgICAgICAgaWYgZW1haWxfaW5wdXQ6CiAgICAgICAgICAgIGhlbHBlci50YXBfZWxlbWVudF9jZW50ZXIoZW1haWxfaW5wdXQpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKICAgICAgICAgICAgaGVscGVyLmlucHV0X3RleHQoZW1haWwpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoNikKICAgICAgICAgICAgIyBC4bqlbSBUaeG6v3AKICAgICAgICAgICAgbmV4dF9idG4gPSBoZWxwZXIuZmluZF9lbGVtZW50X2luX3htbChzY3JlZW5feG1sLCB0ZXh0PSJUaeG6v3AiKQogICAgICAgICAgICBpZiBuZXh0X2J0bjoKICAgICAgICAgICAgICAgIGhlbHBlci50YXBfZWxlbWVudF9jZW50ZXIobmV4dF9idG4pCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaGVscGVyLnN3aXBlX3VwKCkKICAgICAgICAgICAgdGltZS5zbGVlcCgxKQoKICAgIHByaW50KCJbK10gxJDEg25nIGvDvSB0w6BpIGtob+G6o24gSW5zdGFncmFtIGhvw6BuIHThuqV0ISIpCiAgICByZXR1cm4gewogICAgICAgICJmdWxsX25hbWUiOiBmdWxsX25hbWUsCiAgICAgICAgInVzZXJuYW1lIjogdXNlcm5hbWUsCiAgICAgICAgImVtYWlsIjogZW1haWwsCiAgICAgICAgImJpcnRoZGF5IjogZiJ7ZGF5OjAyZH0ve21vbnRoOjAyZH0ve3llYXJ9IgogICAgfQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGluZm8gPSByZWdpc3Rlcl9pbnN0YWdyYW1fYWNjb3VudCgpCiAgICBwcmludCgiW1JFU1VMVF0iLCBpbmZvKQo=').decode('utf-8'))
