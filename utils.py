import base64
exec(base64.b64decode('aW1wb3J0IHRpbWUKaW1wb3J0IHJlcXVlc3RzCmZyb20gdHlwaW5nIGltcG9ydCBEaWN0LCBBbnksIE9wdGlvbmFsLCBUdXBsZSwgRGljdCwgTGlzdAppbXBvcnQgY29uZmlnCmltcG9ydCBvcwppbXBvcnQgZGF0ZXRpbWUKaW1wb3J0IHN5cwppbXBvcnQgdHJhY2ViYWNrCmltcG9ydCBqc29uCmltcG9ydCBsb2dnaW5nCmltcG9ydCBsb2dnaW5nLmhhbmRsZXJzCmltcG9ydCBzdWJwcm9jZXNzCmZyb20gZW51bSBpbXBvcnQgRW51bQoKIyBUaGVvIGTDtWkgdOG6pXQgY+G6oyBjw6FjIGxvZ2dlciDEkcOjIHThuqFvCmFsbF9sb2dnZXJzOiBEaWN0W3N0ciwgJ0xvZ2dlciddID0ge30KCiMgQmnhur9uIHRvw6BuIGPhu6VjIMSR4buDIGzGsHUgdHLhuqFuZyB0aMOhaQpoZWxwZXJfYXZhaWxhYmxlID0gRmFsc2UKbmV0d29ya19hdmFpbGFibGUgPSBGYWxzZQoKIyDEkOG7i25oIG5naMSpYSBjw6FjIGxldmVsIGxvZwpjbGFzcyBMb2dMZXZlbChFbnVtKToKICAgIERFQlVHID0gbG9nZ2luZy5ERUJVRwogICAgSU5GTyA9IGxvZ2dpbmcuSU5GTwogICAgV0FSTklORyA9IGxvZ2dpbmcuV0FSTklORwogICAgRVJST1IgPSBsb2dnaW5nLkVSUk9SCiAgICBDUklUSUNBTCA9IGxvZ2dpbmcuQ1JJVElDQUwKCiMgQ+G6pXUgaMOsbmggbG9nZ2VyIHbhu5tpIFJvdGF0aW5nRmlsZUhhbmRsZXIgxJHhu4MgZ2nhu5tpIGjhuqFuIGvDrWNoIHRoxrDhu5tjIGZpbGUKIyBU4bqhbyBSb3RhdGluZ0ZpbGVIYW5kbGVyIC0gZ2nhu5tpIGjhuqFuIGtob+G6o25nIDIwMDAgZMOybmcgKMaw4bubYyB0w61uaCB+MjAwS0IgbeG7l2kgZmlsZSkKcm90YXRpbmdfaGFuZGxlciA9IGxvZ2dpbmcuaGFuZGxlcnMuUm90YXRpbmdGaWxlSGFuZGxlcigKICAgICdhcHAubG9nJywgCiAgICBtYXhCeXRlcz0yMDAqMTAyNCwgICMgMjAwS0IgcGVyIGZpbGUgKGtob+G6o25nIDIwMDAgZMOybmcpCiAgICBiYWNrdXBDb3VudD0xLCAgICAgICMgQ2jhu4kgZ2nhu68gMSBmaWxlIGJhY2t1cAogICAgZW5jb2Rpbmc9J3V0Zi04JwopCgpsb2dnaW5nLmJhc2ljQ29uZmlnKAogICAgbGV2ZWw9bG9nZ2luZy5JTkZPLAogICAgZm9ybWF0PSclKGFzY3RpbWUpcyAtICUobmFtZSlzIC0gJShsZXZlbG5hbWUpcyAtICUobWVzc2FnZSlzJywKICAgIGRhdGVmbXQ9JyVkLyVtICVIOiVNOiVTJywKICAgIGhhbmRsZXJzPVsKICAgICAgICBsb2dnaW5nLlN0cmVhbUhhbmRsZXIoKSwKICAgICAgICByb3RhdGluZ19oYW5kbGVyCiAgICBdCikKCmNsYXNzIExvZ2dlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBuYW1lKToKICAgICAgICBzZWxmLmxvZ2dlciA9IGxvZ2dpbmcuZ2V0TG9nZ2VyKG5hbWUpCiAgICAgICAgCiAgICBkZWYgZGVidWcoc2VsZiwgbWVzc2FnZSk6CiAgICAgICAgc2VsZi5sb2dnZXIuZGVidWcobWVzc2FnZSkKICAgICAgICAKICAgIGRlZiBpbmZvKHNlbGYsIG1lc3NhZ2UpOgogICAgICAgIHNlbGYubG9nZ2VyLmluZm8obWVzc2FnZSkKICAgICAgICAKICAgIGRlZiB3YXJuaW5nKHNlbGYsIG1lc3NhZ2UpOgogICAgICAgIHNlbGYubG9nZ2VyLndhcm5pbmcobWVzc2FnZSkKICAgICAgICAKICAgIGRlZiBlcnJvcihzZWxmLCBtZXNzYWdlKToKICAgICAgICBzZWxmLmxvZ2dlci5lcnJvcihtZXNzYWdlKQogICAgICAgIAogICAgZGVmIGNyaXRpY2FsKHNlbGYsIG1lc3NhZ2UpOgogICAgICAgIHNlbGYubG9nZ2VyLmNyaXRpY2FsKG1lc3NhZ2UpCiAgICAgICAgCiAgICBkZWYgZXhjZXB0aW9uKHNlbGYsIGUsIG1lc3NhZ2U9IkV4Y2VwdGlvbiBvY2N1cnJlZCIpOgogICAgICAgIHNlbGYubG9nZ2VyLmV4Y2VwdGlvbihmInttZXNzYWdlfToge3N0cihlKX0iKQoKIyBU4bqhbyBsb2dnZXIgbeG6t2MgxJHhu4tuaCBjaG8gbW9kdWxlIHV0aWxzCmxvZ2dlciA9IExvZ2dlcigiVXRpbHMiKQoKZGVmIHNldF9hbGxfbG9nZ2Vyc19sZXZlbChsZXZlbDogaW50KToKICAgICIiIgogICAgQ8OgaSDEkeG6t3QgY+G6pXAgxJHhu5kgbG9nIGNobyB04bqldCBj4bqjIGPDoWMgbG9nZ2VyIMSRw6MgdOG6oW8KICAgIAogICAgQXJnczoKICAgICAgICBsZXZlbDogQ+G6pXAgxJHhu5kgbG9nIHThu5FpIHRoaeG7g3UgKExvZ0xldmVsLkRFQlVHLCBMb2dMZXZlbC5JTkZPLCBMb2dMZXZlbC5FUlJPUikKICAgICIiIgogICAgZm9yIGxvZ2dlcl9uYW1lLCBsb2dnZXJfaW5zdGFuY2UgaW4gYWxsX2xvZ2dlcnMuaXRlbXMoKToKICAgICAgICBsb2dnZXJfaW5zdGFuY2Uuc2V0X2xldmVsKGxldmVsKQogICAgICAgIApkZWYgc2V0dXBfZGVmYXVsdF9sb2dnaW5nKHByb2R1Y3Rpb246IGJvb2wgPSBGYWxzZSwgbG9nX3RvX2ZpbGU6IGJvb2wgPSBGYWxzZSk6CiAgICAiIiIKICAgIFRoaeG6v3QgbOG6rXAgY+G6pXUgaMOsbmggbG9nIG3hurdjIMSR4buLbmggY2hvIOG7qW5nIGThu6VuZwogICAgCiAgICBBcmdzOgogICAgICAgIHByb2R1Y3Rpb246IFRydWUgbuG6v3UgxJFhbmcgY2jhuqF5IHRyb25nIG3DtGkgdHLGsOG7nW5nIHByb2R1Y3Rpb24gKGNo4buJIGxvZyB04burIElORk8gdHLhu58gbMOqbikKICAgICAgICBsb2dfdG9fZmlsZTogVHJ1ZSDEkeG7gyBnaGkgbG9nIHJhIGZpbGUKICAgICIiIgogICAgbGV2ZWwgPSBMb2dMZXZlbC5JTkZPIGlmIHByb2R1Y3Rpb24gZWxzZSBMb2dMZXZlbC5ERUJVRwogICAgCiAgICAjIMSQ4bq3dCBsZXZlbCBjaG8gdOG6pXQgY+G6oyBjw6FjIGxvZ2dlciBoaeG7h24gY8OzCiAgICBzZXRfYWxsX2xvZ2dlcnNfbGV2ZWwobGV2ZWwpCiAgICAKICAgICMgxJDhurd0IGxvZ190b19maWxlIGNobyBsb2dnZXIgaGnhu4duIGPDswogICAgaWYgbG9nX3RvX2ZpbGU6CiAgICAgICAgZm9yIGxvZ2dlcl9uYW1lLCBsb2dnZXJfaW5zdGFuY2UgaW4gYWxsX2xvZ2dlcnMuaXRlbXMoKToKICAgICAgICAgICAgIyBU4bqhbyBmaWxlIGxvZyBt4bubaSBu4bq/dSBjaMawYSBjw7MKICAgICAgICAgICAgaWYgbm90IGxvZ2dlcl9pbnN0YW5jZS5sb2dfdG9fZmlsZToKICAgICAgICAgICAgICAgIGxvZ2dlcl9pbnN0YW5jZS5sb2dfdG9fZmlsZSA9IFRydWUKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBU4bqhbyB0aMawIG3hu6VjIGxvZyBu4bq/dSBj4bqnbgogICAgICAgICAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKGxvZ2dlcl9pbnN0YW5jZS5sb2dfZGlyKToKICAgICAgICAgICAgICAgICAgICBvcy5tYWtlZGlycyhsb2dnZXJfaW5zdGFuY2UubG9nX2RpcikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBU4bqhbyB0w6puIGZpbGUgbG9nIHbhu5tpIG5nw6B5IHRow6FuZwogICAgICAgICAgICAgICAgdG9kYXkgPSBkYXRldGltZS5kYXRldGltZS5ub3coKS5zdHJmdGltZSgiJVktJW0tJWQiKQogICAgICAgICAgICAgICAgbG9nX2ZpbGVuYW1lID0gZiJ7bG9nZ2VyX25hbWV9X3t0b2RheX0ubG9nIgogICAgICAgICAgICAgICAgbG9nZ2VyX2luc3RhbmNlLmxvZ19maWxlID0gb3MucGF0aC5qb2luKGxvZ2dlcl9pbnN0YW5jZS5sb2dfZGlyLCBsb2dfZmlsZW5hbWUpCgpkZWYgZ2V0X2xvZ2dlcihuYW1lOiBzdHIsIGxldmVsOiBpbnQgPSBMb2dMZXZlbC5ERUJVRywgbG9nX3RvX2ZpbGU6IGJvb2wgPSBGYWxzZSkgLT4gTG9nZ2VyOgogICAgIiIiCiAgICBU4bqhbyB2w6AgdHLhuqMgduG7gSBt4buZdCBsb2dnZXIgduG7m2kgY+G6pXUgaMOsbmggY2jhu4kgxJHhu4tuaAogICAgCiAgICBBcmdzOgogICAgICAgIG5hbWU6IFTDqm4gY+G7p2EgbG9nZ2VyL21vZHVsZQogICAgICAgIGxldmVsOiBD4bqlcCDEkeG7mSBsb2cgdOG7kWkgdGhp4buDdQogICAgICAgIGxvZ190b19maWxlOiBUcnVlIMSR4buDIGdoaSBsb2cgcmEgZmlsZQogICAgCiAgICBSZXR1cm5zOgogICAgICAgIExvZ2dlcjogxJDhu5FpIHTGsOG7o25nIGxvZ2dlciDEkcOjIGPhuqV1IGjDrG5oCiAgICAiIiIKICAgICMgS2nhu4NtIHRyYSB4ZW0gbG9nZ2VyIMSRw6MgdOG7k24gdOG6oWkgY2jGsGEKICAgIGlmIG5hbWUgaW4gYWxsX2xvZ2dlcnM6CiAgICAgICAgcmV0dXJuIGFsbF9sb2dnZXJzW25hbWVdCiAgICAgICAgCiAgICAjIFThuqFvIGxvZ2dlciBt4bubaQogICAgcmV0dXJuIExvZ2dlcihuYW1lKQoKZGVmIGNoZWNrX2hlbHBlcl9zZXJ2aWNlKGhlbHBlcl9zZXJ2aWNlKToKICAgICIiIgogICAgS2nhu4NtIHRyYSBIZWxwZXJTZXJ2aWNlIGPDsyBob+G6oXQgxJHhu5luZyBraMO0bmcKICAgIAogICAgUmV0dXJuczoKICAgICAgICBUdXBsZVtib29sLCBBbnldOiAoVHJ1ZS9GYWxzZSwgcmVzcG9uc2UgZGF0YSBu4bq/dSBjw7MpCiAgICAiIiIKICAgIGdsb2JhbCBoZWxwZXJfYXZhaWxhYmxlCiAgICAKICAgIHRyeToKICAgICAgICAjIEtp4buDbSB0cmEgYuG6sW5nIGPDoWNoIGfhu41pIGdldF9kZXZpY2VfaW5mbwogICAgICAgIHJlc3BvbnNlID0gaGVscGVyX3NlcnZpY2UuZ2V0X2RldmljZV9pbmZvKCkKICAgICAgICAKICAgICAgICBpZiByZXNwb25zZVsic3RhdHVzIl0gPT0gInN1Y2Nlc3MiOgogICAgICAgICAgICBsb2dnZXIuaW5mbygiSGVscGVyU2VydmljZSDEkWFuZyBob+G6oXQgxJHhu5luZyIpCiAgICAgICAgICAgIGhlbHBlcl9hdmFpbGFibGUgPSBUcnVlCiAgICAgICAgICAgIAogICAgICAgICAgICAjIFRy4bqjIHbhu4EgdGjDtG5nIHRpbiB0aGnhur90IGLhu4sgxJHhu4MgY8OzIHRo4buDIGzGsHUgdsOgbyBEQgogICAgICAgICAgICBpZiAiZGF0YSIgaW4gcmVzcG9uc2U6CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZSwgcmVzcG9uc2UKICAgICAgICAgICAgcmV0dXJuIFRydWUsIE5vbmUKICAgICAgICBlbHNlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJIZWxwZXJTZXJ2aWNlIHRy4bqjIHbhu4EgbOG7l2k6IHtyZXNwb25zZS5nZXQoJ21lc3NhZ2UnLCAnS2jDtG5nIHLDtSBs4buXaScpfSIpCiAgICAgICAgICAgIGhlbHBlcl9hdmFpbGFibGUgPSBGYWxzZQogICAgICAgICAgICByZXR1cm4gRmFsc2UsIE5vbmUKICAgICAgICAgICAgCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYiTOG7l2kga2hpIGtp4buDbSB0cmEgSGVscGVyU2VydmljZToge2V9IikKICAgICAgICBoZWxwZXJfYXZhaWxhYmxlID0gRmFsc2UKICAgICAgICByZXR1cm4gRmFsc2UsIE5vbmUKCmRlZiBjaGVja19uZXR3b3JrX2Nvbm5lY3Rpb24oKToKICAgICIiIgogICAgS2nhu4NtIHRyYSBr4bq/dCBu4buRaSBt4bqhbmcgdsOgIGNsb3VkIHNlcnZlcgogICAgCiAgICBSZXR1cm5zOgogICAgICAgIFR1cGxlW2Jvb2wsIEFueV06IChUcnVlL0ZhbHNlLCByZXNwb25zZSBkYXRhIG7hur91IGPDsykKICAgICIiIgogICAgZ2xvYmFsIG5ldHdvcmtfYXZhaWxhYmxlCiAgICAKICAgIHRyeToKICAgICAgICAjIEtp4buDbSB0cmEga+G6v3QgbuG7kWkgxJHhur9uIGNsb3VkIFVSTCAoa2jDtG5nIHRow6ptIC9waW5nIG7hu69hKQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KGNvbmZpZy5DTE9VRF9VUkwsIHRpbWVvdXQ9NSkKICAgICAgICAKICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgIGxvZ2dlci5pbmZvKCJL4bq/dCBu4buRaSBt4bqhbmcg4buVbiDEkeG7i25oIikKICAgICAgICAgICAgbmV0d29ya19hdmFpbGFibGUgPSBUcnVlCiAgICAgICAgICAgIHJldHVybiBUcnVlLCByZXNwb25zZS5qc29uKCkgaWYgcmVzcG9uc2UuaGVhZGVycy5nZXQoJ2NvbnRlbnQtdHlwZScpID09ICdhcHBsaWNhdGlvbi9qc29uJyBlbHNlIE5vbmUKICAgICAgICBlbHNlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJLaMO0bmcgdGjhu4Mga+G6v3QgbuG7kWkgxJHhur9uIGNsb3VkIHNlcnZlcjoge3Jlc3BvbnNlLnN0YXR1c19jb2RlfSIpCiAgICAgICAgICAgIG5ldHdvcmtfYXZhaWxhYmxlID0gRmFsc2UKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBOb25lCiAgICAgICAgICAgIAogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkzhu5dpIGvhur90IG7hu5FpIG3huqFuZzoge2V9IikKICAgICAgICBuZXR3b3JrX2F2YWlsYWJsZSA9IEZhbHNlCiAgICAgICAgcmV0dXJuIEZhbHNlLCBOb25lCgpkZWYgaXNfaGVscGVyX2F2YWlsYWJsZSgpIC0+IGJvb2w6CiAgICAiIiJUcuG6oyB24buBIHRy4bqhbmcgdGjDoWkgaGnhu4duIHThuqFpIGPhu6dhIGhlbHBlciBzZXJ2aWNlIiIiCiAgICByZXR1cm4gaGVscGVyX2F2YWlsYWJsZQoKZGVmIGlzX25ldHdvcmtfYXZhaWxhYmxlKCkgLT4gYm9vbDoKICAgICIiIlRy4bqjIHbhu4EgdHLhuqFuZyB0aMOhaSBoaeG7h24gdOG6oWkgY+G7p2Ega+G6v3QgbuG7kWkgbeG6oW5nIiIiCiAgICByZXR1cm4gbmV0d29ya19hdmFpbGFibGUKCmRlZiByZXRyeV91bnRpbF9zdWNjZXNzKGZ1bmMsIG1heF9yZXRyaWVzOiBpbnQsIGRlbGF5OiBpbnQsICphcmdzLCAqKmt3YXJncykgLT4gVHVwbGVbYm9vbCwgT3B0aW9uYWxbQW55XV06CiAgICAiIiIKICAgIFRo4butIHRo4buxYyBoaeG7h24gbeG7mXQgaMOgbSBuaGnhu4F1IGzhuqduIGNobyDEkeG6v24ga2hpIHRow6BuaCBjw7RuZwogICAgCiAgICBBcmdzOgogICAgICAgIGZ1bmM6IEjDoG0gY+G6p24gdGjhu7FjIGhp4buHbgogICAgICAgIG1heF9yZXRyaWVzOiBT4buRIGzhuqduIHRo4butIHThu5FpIMSRYQogICAgICAgIGRlbGF5OiBUaOG7nWkgZ2lhbiBjaOG7nSBnaeG7r2EgY8OhYyBs4bqnbiB0aOG7rSAoZ2nDonkpCiAgICAgICAgKmFyZ3MsICoqa3dhcmdzOiBUaGFtIHPhu5EgY2hvIGjDoG0gY+G6p24gdGjhu7FjIGhp4buHbgogICAgICAgIAogICAgUmV0dXJuczoKICAgICAgICBUdXBsZVtib29sLCBBbnldOiAoVGjDoG5oIGPDtG5nIGhheSBraMO0bmcsIEvhur90IHF14bqjIHRy4bqjIHbhu4EgbuG6v3UgY8OzKQogICAgIiIiCiAgICByZXRyeV9jb3VudCA9IDAKICAgIHN1Y2Nlc3MgPSBGYWxzZQogICAgcmVzdWx0ID0gTm9uZQogICAgCiAgICB3aGlsZSByZXRyeV9jb3VudCA8IG1heF9yZXRyaWVzIGFuZCBub3Qgc3VjY2VzczoKICAgICAgICBzdWNjZXNzLCByZXN1bHQgPSBmdW5jKCphcmdzLCAqKmt3YXJncykKICAgICAgICBpZiBzdWNjZXNzOgogICAgICAgICAgICByZXR1cm4gVHJ1ZSwgcmVzdWx0CiAgICAgICAgICAgIAogICAgICAgIHJldHJ5X2NvdW50ICs9IDEKICAgICAgICBpZiByZXRyeV9jb3VudCA8IG1heF9yZXRyaWVzOgogICAgICAgICAgICBsb2dnZXIuZGVidWcoZiJUaOG7rSBs4bqhaSBzYXUge2RlbGF5fSBnacOieS4uLiAoY8OybiB7bWF4X3JldHJpZXMgLSByZXRyeV9jb3VudH0gbOG6p24pIikKICAgICAgICAgICAgdGltZS5zbGVlcChkZWxheSkKICAgIAogICAgcmV0dXJuIEZhbHNlLCBOb25lIAoKZGVmIGdldF9kZXZpY2VfaWRfZnJvbV9zeXN0ZW0oKSAtPiBzdHI6CiAgICAiIiIKICAgIEzhuqV5IGRldmljZV9pZCB04burIGjhu4cgdGjhu5FuZyBi4bqxbmcgbOG7h25oIGdldHByb3Agcm8uc2VyaWFsbm8KICAgIAogICAgUmV0dXJuczoKICAgICAgICBzdHI6IERldmljZSBJRCBob+G6t2MgY2h14buXaSBy4buXbmcgbuG6v3Uga2jDtG5nIGzhuqV5IMSRxrDhu6NjCiAgICAiIiIKICAgIHRyeToKICAgICAgICBpbXBvcnQgc3VicHJvY2VzcwogICAgICAgICMgVGjhu7FjIGhp4buHbiBs4buHbmggZ2V0cHJvcCByby5zZXJpYWxubyDEkeG7gyBs4bqleSBzZXJpYWwgbnVtYmVyIGPhu6dhIHRoaeG6v3QgYuG7iwogICAgICAgIHJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKAogICAgICAgICAgICBbImdldHByb3AiLCAicm8uc2VyaWFsbm8iXSwKICAgICAgICAgICAgY2hlY2s9VHJ1ZSwKICAgICAgICAgICAgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwKICAgICAgICAgICAgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSwKICAgICAgICAgICAgdGV4dD1UcnVlCiAgICAgICAgKQogICAgICAgIAogICAgICAgICMgTOG6pXkga+G6v3QgcXXhuqMgdsOgIGxv4bqhaSBi4buPIGtob+G6o25nIHRy4bqvbmcgdGjhu6thCiAgICAgICAgZGV2aWNlX2lkID0gcmVzdWx0LnN0ZG91dC5zdHJpcCgpCiAgICAgICAgCiAgICAgICAgaWYgZGV2aWNlX2lkOgogICAgICAgICAgICBsb2dnZXIuaW5mbyhmIsSQw6MgbOG6pXkgxJHGsOG7o2MgZGV2aWNlX2lkIHThu6sgaOG7hyB0aOG7kW5nOiB7ZGV2aWNlX2lkfSIpCiAgICAgICAgICAgIHJldHVybiBkZXZpY2VfaWQKICAgICAgICBlbHNlOgogICAgICAgICAgICBsb2dnZXIud2FybmluZygiS2jDtG5nIGzhuqV5IMSRxrDhu6NjIGRldmljZV9pZCB04burIGjhu4cgdGjhu5FuZyIpCiAgICAgICAgICAgIHJldHVybiAiIgogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkzhu5dpIGtoaSBs4bqleSBkZXZpY2VfaWQgdOG7qyBo4buHIHRo4buRbmc6IHtzdHIoZSl9IikKICAgICAgICByZXR1cm4gIiIgCgojIEjDoG0ga2nhu4NtIHRyYSBr4bq/dCBu4buRaSBt4bqhbmcKZGVmIGNoZWNrX25ldHdvcmtfY29ubmVjdGlvbigpIC0+IFR1cGxlW2Jvb2wsIHN0cl06CiAgICAiIiIKICAgIEtp4buDbSB0cmEga+G6v3QgbuG7kWkgbeG6oW5nIGLhurFuZyBjw6FjaCBwaW5nIGdvb2dsZS5jb20KICAgIAogICAgUmV0dXJuczoKICAgICAgICBUdXBsZVtib29sLCBzdHJdOiAoVHJ1ZSwgIlN1Y2Nlc3MiKSBu4bq/dSB0aMOgbmggY8O0bmcsIChGYWxzZSwgZXJyb3JfbWVzc2FnZSkgbuG6v3UgdGjhuqV0IGLhuqFpCiAgICAiIiIKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbSIsIHRpbWVvdXQ9NSkKICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgIHJldHVybiBUcnVlLCAiU3VjY2VzcyIKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gRmFsc2UsIGYiSFRUUCBlcnJvcjoge3Jlc3BvbnNlLnN0YXR1c19jb2RlfSIKICAgIGV4Y2VwdCByZXF1ZXN0cy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmV0dXJuIEZhbHNlLCBmIk5ldHdvcmsgZXJyb3I6IHtzdHIoZSl9IgoKIyBIw6BtIGtp4buDbSB0cmEgSGVscGVyU2VydmljZQpkZWYgY2hlY2tfaGVscGVyX3NlcnZpY2UoaGVscGVyKSAtPiBUdXBsZVtib29sLCBPcHRpb25hbFtEaWN0W3N0ciwgQW55XV1dOgogICAgIiIiCiAgICBLaeG7g20gdHJhIGvhur90IG7hu5FpIMSR4bq/biBIZWxwZXJTZXJ2aWNlCiAgICAKICAgIEFyZ3M6CiAgICAgICAgaGVscGVyOiBIZWxwZXJTZXJ2aWNlIGluc3RhbmNlCiAgICAgICAgCiAgICBSZXR1cm5zOgogICAgICAgIFR1cGxlW2Jvb2wsIE9wdGlvbmFsW0RpY3RdXTogKFRydWUsIHJlc3BvbnNlX2RhdGEpIG7hur91IHRow6BuaCBjw7RuZywgKEZhbHNlLCBOb25lKSBu4bq/dSB0aOG6pXQgYuG6oWkKICAgICIiIgogICAgdHJ5OgogICAgICAgICMgR+G7jWkgQVBJIGtp4buDbSB0cmEKICAgICAgICByZXNwb25zZSA9IGhlbHBlci5nZXRfZGV2aWNlX2luZm8oKQogICAgICAgIAogICAgICAgICMgS2nhu4NtIHRyYSBr4bq/dCBxdeG6owogICAgICAgIGlmIHJlc3BvbnNlIGFuZCAic3RhdHVzIiBpbiByZXNwb25zZSBhbmQgcmVzcG9uc2VbInN0YXR1cyJdID09ICJzdWNjZXNzIjoKICAgICAgICAgICAgcmV0dXJuIFRydWUsIHJlc3BvbnNlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlLCBOb25lCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZSwgTm9uZQoKIyBIw6BtIGvhur90IG7hu5FpIEFEQgpkZWYgY29ubmVjdF9hZGIoaG9zdDogc3RyLCBwb3J0OiBpbnQpIC0+IGJvb2w6CiAgICAiIiIKICAgIEvhur90IG7hu5FpIMSR4bq/biB0aGnhur90IGLhu4sgQW5kcm9pZCBxdWEgQURCCiAgICAKICAgIEFyZ3M6CiAgICAgICAgaG9zdDogxJDhu4thIGNo4buJIElQIGPhu6dhIHRoaeG6v3QgYuG7iwogICAgICAgIHBvcnQ6IFBvcnQgQURCICh0aMaw4budbmcgbMOgIDU1NTUpCiAgICAgICAgCiAgICBSZXR1cm5zOgogICAgICAgIGJvb2w6IFRydWUgbuG6v3Uga+G6v3QgbuG7kWkgdGjDoG5oIGPDtG5nLCBGYWxzZSBu4bq/dSB0aOG6pXQgYuG6oWkKICAgICIiIgogICAgbG9nZ2VyID0gZ2V0X2xvZ2dlcigiQURCIikKICAgIAogICAgdHJ5OgogICAgICAgICMgS2nhu4NtIHRyYSBBREIgxJHDoyDEkcaw4bujYyBjw6BpIMSR4bq3dCBjaMawYQogICAgICAgIHRyeToKICAgICAgICAgICAgc3VicHJvY2Vzcy5ydW4oWyJhZGIiLCAidmVyc2lvbiJdLCBjaGVjaz1UcnVlLCBzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLCBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFKQogICAgICAgIGV4Y2VwdCAoc3VicHJvY2Vzcy5TdWJwcm9jZXNzRXJyb3IsIEZpbGVOb3RGb3VuZEVycm9yKToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJBREIga2jDtG5nIMSRxrDhu6NjIGPDoGkgxJHhurd0IGhv4bq3YyBraMO0bmcgY8OzIHRyb25nIFBBVEgiKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgCiAgICAgICAgIyBLaOG7n2kgxJHhu5luZyBBREIgc2VydmVyIG7hur91IGNoxrBhIGNo4bqheQogICAgICAgIHN1YnByb2Nlc3MucnVuKFsiYWRiIiwgInN0YXJ0LXNlcnZlciJdLCBjaGVjaz1GYWxzZSwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSkKICAgICAgICAKICAgICAgICAjIEvhur90IG7hu5FpIMSR4bq/biB0aGnhur90IGLhu4sKICAgICAgICBjb25uZWN0X2NtZCA9IFsiYWRiIiwgImNvbm5lY3QiLCBmIntob3N0fTp7cG9ydH0iXQogICAgICAgIHJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKGNvbm5lY3RfY21kLCBjaGVjaz1GYWxzZSwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSwgdGV4dD1UcnVlKQogICAgICAgIAogICAgICAgICMgS2nhu4NtIHRyYSBr4bq/dCBxdeG6owogICAgICAgIG91dHB1dCA9IHJlc3VsdC5zdGRvdXQKICAgICAgICBpZiAiY29ubmVjdGVkIiBpbiBvdXRwdXQubG93ZXIoKSBhbmQgInVuYWJsZSIgbm90IGluIG91dHB1dC5sb3dlcigpOgogICAgICAgICAgICBsb2dnZXIuaW5mbyhmIsSQw6Mga+G6v3QgbuG7kWkgdGjDoG5oIGPDtG5nIMSR4bq/biB7aG9zdH06e3BvcnR9IikKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJLaMO0bmcgdGjhu4Mga+G6v3QgbuG7kWkgxJHhur9uIHtob3N0fTp7cG9ydH06IHtvdXRwdXR9IikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgICAgIAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5leGNlcHRpb24oZSwgZiJM4buXaSBraGkga+G6v3QgbuG7kWkgQURCIMSR4bq/biB7aG9zdH06e3BvcnR9IikKICAgICAgICByZXR1cm4gRmFsc2Ug').decode('utf-8'))
