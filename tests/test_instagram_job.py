import base64
exec(base64.b64decode('IiIiClRlc3Qgc2NyaXB0IMSR4buDIGRlYnVnIGPDoWMgaMOgbSBJbnN0YWdyYW0gSm9iIG3hu5l0IGPDoWNoIG5oYW5oIGNow7NuZwpDaOG6oXkgZmlsZSBuw6B5IMSR4buDIHRlc3QgdOG7q25nIGjDoG0gcmnDqm5nIGzhursKIiIiCgppbXBvcnQgc3lzCmltcG9ydCBvcwoKIyBUaMOqbSDEkcaw4budbmcgZOG6q24gcm9vdCB2w6BvIHN5cy5wYXRoIMSR4buDIGltcG9ydCBjw6FjIG1vZHVsZQpzeXMucGF0aC5pbnNlcnQoMCwgb3MucGF0aC5qb2luKG9zLnBhdGguZGlybmFtZShfX2ZpbGVfXyksICcuLicpKQoKZnJvbSBqb2JzLmluc3RhZ3JhbV9qb2IgaW1wb3J0IEluc3RhZ3JhbUpvYgpmcm9tIHNlcnZpY2VzLmRiX3NlcnZpY2UgaW1wb3J0IERhdGFiYXNlU2VydmljZQpmcm9tIHNlcnZpY2VzLmhlbHBlcl9zZXJ2aWNlIGltcG9ydCBIZWxwZXJTZXJ2aWNlCmZyb20gc2VydmljZXMuZ29saWtlX3NlcnZpY2UgaW1wb3J0IEdvTGlrZVNlcnZpY2UKCgpkZWYgY3JlYXRlX2luc3RhZ3JhbV9qb2IoKToKICAgICIiIlThuqFvIEluc3RhZ3JhbSBKb2IgaW5zdGFuY2UgduG7m2kgY8OhYyBzZXJ2aWNlIHRo4buxYyIiIgogICAgdHJ5OgogICAgICAgICMgS2jhu59pIHThuqFvIGPDoWMgc2VydmljZSB0aOG7sWMKICAgICAgICBkYl9zZXJ2aWNlID0gRGF0YWJhc2VTZXJ2aWNlKCkKICAgICAgICBoZWxwZXJfc2VydmljZSA9IEhlbHBlclNlcnZpY2UoKQogICAgICAgIGdvbGlrZV9zZXJ2aWNlID0gR29MaWtlU2VydmljZShkYl9zZXJ2aWNlLCBoZWxwZXJfc2VydmljZSkKICAgICAgICAKICAgICAgICAjIFThuqFvIEluc3RhZ3JhbSBqb2IKICAgICAgICBpbnN0YWdyYW1fam9iID0gSW5zdGFncmFtSm9iKAogICAgICAgICAgICBkYl9zZXJ2aWNlPWRiX3NlcnZpY2UsCiAgICAgICAgICAgIGhlbHBlcl9zZXJ2aWNlPWhlbHBlcl9zZXJ2aWNlLAogICAgICAgICAgICBnb2xpa2Vfc2VydmljZT1nb2xpa2Vfc2VydmljZQogICAgICAgICkKICAgICAgICAKICAgICAgICBwcmludCgi4pyFIMSQw6Mga2jhu59pIHThuqFvIEluc3RhZ3JhbSBKb2IgdGjDoG5oIGPDtG5nISIpCiAgICAgICAgcmV0dXJuIGluc3RhZ3JhbV9qb2IKICAgICAgICAKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIuKdjCBM4buXaSBraGkga2jhu59pIHThuqFvIEluc3RhZ3JhbSBKb2I6IHtlfSIpCiAgICAgICAgcmV0dXJuIE5vbmUKCgpkZWYgZ2V0X3NhbXBsZV9hY2NvdW50KCk6CiAgICAiIiJUcuG6oyB24buBIHNhbXBsZSBhY2NvdW50IMSR4buDIHRlc3QiIiIKICAgIHJldHVybiB7CiAgICAgICAgImlkIjogMSwKICAgICAgICAidW5pcXVlX3VzZXJuYW1lIjogInRlc3RfdXNlciIsCiAgICAgICAgIm5pY2tuYW1lIjogIlRlc3QgVXNlciIsCiAgICAgICAgInN0YXR1cyI6ICJhY3RpdmUiLAogICAgICAgICJpc19sb2dpbiI6IFRydWUsCiAgICAgICAgImF2YXRhcl90aHVtYiI6ICIiLAogICAgICAgICJqb2JfZW5hYmxlIjogVHJ1ZSwKICAgICAgICAibGV2ZWwiOiAzLAogICAgICAgICJsYXN0X3VwZGF0ZSI6IDE2NDA5OTUyMDAsCiAgICAgICAgImdvbGlrZV9pZCI6ICIxMjM0NSIKICAgIH0KCgpkZWYgZ2V0X3NhbXBsZV9qb2IoKToKICAgICIiIlRy4bqjIHbhu4Egc2FtcGxlIGpvYiDEkeG7gyB0ZXN0IiIiCiAgICByZXR1cm4gewogICAgICAgICJpZCI6ICJqb2JfMTIzIiwKICAgICAgICAidHlwZSI6ICJmb2xsb3ciLAogICAgICAgICJsaW5rIjogImh0dHBzOi8vaW5zdGFncmFtLmNvbS90ZXN0X2FjY291bnQiLAogICAgICAgICJkZXNjcmlwdGlvbiI6ICJGb2xsb3cgdGVzdCBhY2NvdW50IgogICAgfQoKCmRlZiB0ZXN0X3Bvc3RfbmV3ZmVlZCgpOgogICAgIiIiVGVzdCBow6BtIHBvc3RfbmV3ZmVlZCIiIgogICAgcHJpbnQoIlxuPT09IFRFU1QgUE9TVCBORVdGRUVEID09PSIpCiAgICAKICAgIGpvYiA9IGNyZWF0ZV9pbnN0YWdyYW1fam9iKCkKICAgIGlmIG5vdCBqb2I6CiAgICAgICAgcmV0dXJuCiAgICAgICAgCiAgICBhY2NvdW50ID0gZ2V0X3NhbXBsZV9hY2NvdW50KCkKICAgIAogICAgdHJ5OgogICAgICAgIHByaW50KGYixJBhbmcgdGVzdCBwb3N0X25ld2ZlZWQgY2hvIGFjY291bnQ6IHthY2NvdW50Wyd1bmlxdWVfdXNlcm5hbWUnXX0iKQogICAgICAgIAogICAgICAgICMgR+G7jWkgaMOgbSBwb3N0X25ld2ZlZWQgLSBjw7MgdGjhu4MgxJHhurd0IGJyZWFrcG9pbnQg4bufIMSRw6J5IMSR4buDIGRlYnVnCiAgICAgICAgcmVzdWx0ID0gam9iLnBvc3RfbmV3ZmVlZChhY2NvdW50KQogICAgICAgIAogICAgICAgIHByaW50KGYiS+G6v3QgcXXhuqM6IHsn4pyFIFRow6BuaCBjw7RuZycgaWYgcmVzdWx0IGVsc2UgJ+KdjCBUaOG6pXQgYuG6oWknfSIpCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgIAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYi4p2MIEzhu5dpIGtoaSB0ZXN0IHBvc3RfbmV3ZmVlZDoge2V9IikKICAgICAgICByZXR1cm4gRmFsc2UKCgpkZWYgdGVzdF9leGVjdXRlX2pvYigpOgogICAgIiIiVGVzdCBow6BtIGV4ZWN1dGVfam9iIiIiCiAgICBwcmludCgiXG49PT0gVEVTVCBFWEVDVVRFIEpPQiA9PT0iKQogICAgCiAgICBqb2IgPSBjcmVhdGVfaW5zdGFncmFtX2pvYigpCiAgICBpZiBub3Qgam9iOgogICAgICAgIHJldHVybgogICAgICAgIAogICAgYWNjb3VudCA9IGdldF9zYW1wbGVfYWNjb3VudCgpCiAgICBzYW1wbGVfam9iID0gZ2V0X3NhbXBsZV9qb2IoKQogICAgCiAgICB0cnk6CiAgICAgICAgcHJpbnQoZiLEkGFuZyB0ZXN0IGV4ZWN1dGVfam9iOiIpCiAgICAgICAgcHJpbnQoZiIgIC0gQWNjb3VudDoge2FjY291bnRbJ3VuaXF1ZV91c2VybmFtZSddfSIpCiAgICAgICAgcHJpbnQoZiIgIC0gSm9iIHR5cGU6IHtzYW1wbGVfam9iWyd0eXBlJ119IikKICAgICAgICBwcmludChmIiAgLSBKb2IgbGluazoge3NhbXBsZV9qb2JbJ2xpbmsnXX0iKQogICAgICAgIAogICAgICAgICMgR+G7jWkgaMOgbSBleGVjdXRlX2pvYiAtIGPDsyB0aOG7gyDEkeG6t3QgYnJlYWtwb2ludCDhu58gxJHDonkgxJHhu4MgZGVidWcKICAgICAgICByZXN1bHQgPSBqb2IuZXhlY3V0ZV9qb2IoYWNjb3VudCwgc2FtcGxlX2pvYikKICAgICAgICAKICAgICAgICBwcmludChmIkvhur90IHF14bqjOiB7cmVzdWx0fSIpCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgIAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYi4p2MIEzhu5dpIGtoaSB0ZXN0IGV4ZWN1dGVfam9iOiB7ZX0iKQogICAgICAgIHJldHVybiBOb25lCgoKZGVmIHRlc3RfZ2V0X2FjY291bnRzX2Zyb21fZGV2aWNlKCk6CiAgICAiIiJUZXN0IGjDoG0gZ2V0X2FjY291bnRzX2Zyb21fZGV2aWNlIiIiCiAgICBwcmludCgiXG49PT0gVEVTVCBHRVQgQUNDT1VOVFMgRlJPTSBERVZJQ0UgPT09IikKICAgIAogICAgam9iID0gY3JlYXRlX2luc3RhZ3JhbV9qb2IoKQogICAgaWYgbm90IGpvYjoKICAgICAgICByZXR1cm4KICAgICAgICAKICAgIHRyeToKICAgICAgICBwcmludCgixJBhbmcgbOG6pXkgZGFuaCBzw6FjaCB0w6BpIGtob+G6o24gdOG7qyB0aGnhur90IGLhu4suLi4iKQogICAgICAgIAogICAgICAgICMgR+G7jWkgaMOgbSBnZXRfYWNjb3VudHNfZnJvbV9kZXZpY2UgLSBjw7MgdGjhu4MgxJHhurd0IGJyZWFrcG9pbnQg4bufIMSRw6J5IMSR4buDIGRlYnVnCiAgICAgICAgYWNjb3VudHMgPSBqb2IuZ2V0X2FjY291bnRzX2Zyb21fZGV2aWNlKCkKICAgICAgICAKICAgICAgICBwcmludChmIlTDrG0gdGjhuqV5IHtsZW4oYWNjb3VudHMpfSB0w6BpIGtob+G6o246IikKICAgICAgICBmb3IgaSwgYWNjb3VudCBpbiBlbnVtZXJhdGUoYWNjb3VudHMsIDEpOgogICAgICAgICAgICBwcmludChmIiAge2l9LiB7YWNjb3VudC5nZXQoJ3VuaXF1ZV91c2VybmFtZScsICdVbmtub3duJyl9IikKICAgICAgICAKICAgICAgICByZXR1cm4gYWNjb3VudHMKICAgICAgICAKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIuKdjCBM4buXaSBraGkgdGVzdCBnZXRfYWNjb3VudHNfZnJvbV9kZXZpY2U6IHtlfSIpCiAgICAgICAgcmV0dXJuIFtdCgoKZGVmIHRlc3RfY2FyZV9mdW5jdGlvbnMoKToKICAgICIiIlRlc3QgY8OhYyBow6BtIGNhcmUiIiIKICAgIHByaW50KCJcbj09PSBURVNUIENBUkUgRlVOQ1RJT05TID09PSIpCiAgICAKICAgIGpvYiA9IGNyZWF0ZV9pbnN0YWdyYW1fam9iKCkKICAgIGlmIG5vdCBqb2I6CiAgICAgICAgcmV0dXJuCiAgICAgICAgCiAgICBhY2NvdW50ID0gZ2V0X3NhbXBsZV9hY2NvdW50KCkKICAgIAogICAgdHJ5OgogICAgICAgICMgVGVzdCBfY2FyZV9zd2lwZV9mZWVkCiAgICAgICAgcHJpbnQoIjEuIFRlc3QgX2NhcmVfc3dpcGVfZmVlZC4uLiIpCiAgICAgICAgcmVzdWx0MSA9IGpvYi5fY2FyZV9zd2lwZV9mZWVkKGFjY291bnQpCiAgICAgICAgcHJpbnQoZiIgICBL4bq/dCBxdeG6ozogeyfinIUgVGjDoG5oIGPDtG5nJyBpZiByZXN1bHQxIGVsc2UgJ+KdjCBUaOG6pXQgYuG6oWknfSIpCiAgICAgICAgCiAgICAgICAgIyBUZXN0IF9jYXJlX3dhdGNoX3JlZWxzCiAgICAgICAgcHJpbnQoIjIuIFRlc3QgX2NhcmVfd2F0Y2hfcmVlbHMuLi4iKQogICAgICAgIHJlc3VsdDIgPSBqb2IuX2NhcmVfd2F0Y2hfcmVlbHMoYWNjb3VudCkKICAgICAgICBwcmludChmIiAgIEvhur90IHF14bqjOiB7J+KchSBUaMOgbmggY8O0bmcnIGlmIHJlc3VsdDIgZWxzZSAn4p2MIFRo4bqldCBi4bqhaSd9IikKICAgICAgICAKICAgICAgICAjIFRlc3QgX2NhcmVfdmlld19zdG9yaWVzCiAgICAgICAgcHJpbnQoIjMuIFRlc3QgX2NhcmVfdmlld19zdG9yaWVzLi4uIikKICAgICAgICByZXN1bHQzID0gam9iLl9jYXJlX3ZpZXdfc3RvcmllcyhhY2NvdW50KQogICAgICAgIHByaW50KGYiICAgS+G6v3QgcXXhuqM6IHsn4pyFIFRow6BuaCBjw7RuZycgaWYgcmVzdWx0MyBlbHNlICfinYwgVGjhuqV0IGLhuqFpJ30iKQogICAgICAgIAogICAgICAgICMgVGVzdCBfY2FyZV92aWV3X25vdGlmaWNhdGlvbnMKICAgICAgICBwcmludCgiNC4gVGVzdCBfY2FyZV92aWV3X25vdGlmaWNhdGlvbnMuLi4iKQogICAgICAgIHJlc3VsdDQgPSBqb2IuX2NhcmVfdmlld19ub3RpZmljYXRpb25zKGFjY291bnQpCiAgICAgICAgcHJpbnQoZiIgICBL4bq/dCBxdeG6ozogeyfinIUgVGjDoG5oIGPDtG5nJyBpZiByZXN1bHQ0IGVsc2UgJ+KdjCBUaOG6pXQgYuG6oWknfSIpCiAgICAgICAgCiAgICAgICAgcmV0dXJuIFtyZXN1bHQxLCByZXN1bHQyLCByZXN1bHQzLCByZXN1bHQ0XQogICAgICAgIAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYi4p2MIEzhu5dpIGtoaSB0ZXN0IGNhcmUgZnVuY3Rpb25zOiB7ZX0iKQogICAgICAgIHJldHVybiBbRmFsc2UsIEZhbHNlLCBGYWxzZSwgRmFsc2VdCgoKZGVmIHRlc3RfbmF2aWdhdGlvbl9mdW5jdGlvbnMoKToKICAgICIiIlRlc3QgY8OhYyBow6BtIG5hdmlnYXRpb24iIiIKICAgIHByaW50KCJcbj09PSBURVNUIE5BVklHQVRJT04gRlVOQ1RJT05TID09PSIpCiAgICAKICAgIGpvYiA9IGNyZWF0ZV9pbnN0YWdyYW1fam9iKCkKICAgIGlmIG5vdCBqb2I6CiAgICAgICAgcmV0dXJuCiAgICAgICAgCiAgICB0cnk6CiAgICAgICAgIyBUZXN0IGlzX2hvbWVfc2NyZWVuCiAgICAgICAgcHJpbnQoIjEuIFRlc3QgaXNfaG9tZV9zY3JlZW4uLi4iKQogICAgICAgIHJlc3VsdDEgPSBqb2IuaXNfaG9tZV9zY3JlZW4oKQogICAgICAgIHByaW50KGYiICAgxJBhbmcg4bufIGhvbWUgc2NyZWVuOiB7J+KchSBDw7MnIGlmIHJlc3VsdDEgZWxzZSAn4p2MIEtow7RuZyd9IikKICAgICAgICAKICAgICAgICAjIFRlc3QgZW5zdXJlX2hvbWVfc2NyZWVuCiAgICAgICAgcHJpbnQoIjIuIFRlc3QgZW5zdXJlX2hvbWVfc2NyZWVuLi4uIikKICAgICAgICByZXN1bHQyID0gam9iLmVuc3VyZV9ob21lX3NjcmVlbigpCiAgICAgICAgcHJpbnQoZiIgICBW4buBIGhvbWUgc2NyZWVuOiB7J+KchSBUaMOgbmggY8O0bmcnIGlmIHJlc3VsdDIgZWxzZSAn4p2MIFRo4bqldCBi4bqhaSd9IikKICAgICAgICAKICAgICAgICAjIFRlc3QgYmFja190b19ob21lCiAgICAgICAgcHJpbnQoIjMuIFRlc3QgYmFja190b19ob21lLi4uIikKICAgICAgICByZXN1bHQzID0gam9iLmJhY2tfdG9faG9tZSgpCiAgICAgICAgcHJpbnQoZiIgICBRdWF5IHbhu4EgaG9tZTogeyfinIUgVGjDoG5oIGPDtG5nJyBpZiByZXN1bHQzIGVsc2UgJ+KdjCBUaOG6pXQgYuG6oWknfSIpCiAgICAgICAgCiAgICAgICAgcmV0dXJuIFtyZXN1bHQxLCByZXN1bHQyLCByZXN1bHQzXQogICAgICAgIAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYi4p2MIEzhu5dpIGtoaSB0ZXN0IG5hdmlnYXRpb24gZnVuY3Rpb25zOiB7ZX0iKQogICAgICAgIHJldHVybiBbRmFsc2UsIEZhbHNlLCBGYWxzZV0KCgpkZWYgbWFpbigpOgogICAgIiIiTWVudSBjaMOtbmggxJHhu4MgY2jhu41uIHRlc3QgbsOgbyBtdeG7kW4gY2jhuqF5IiIiCiAgICBwcmludCgi8J+UpyBJTlNUQUdSQU0gSk9CIERFQlVHR0VSIikKICAgIHByaW50KCI9IiAqIDUwKQogICAgCiAgICB3aGlsZSBUcnVlOgogICAgICAgIHByaW50KCJcbkNo4buNbiBmdW5jdGlvbiBtdeG7kW4gdGVzdDoiKQogICAgICAgIHByaW50KCIxLiBUZXN0IHBvc3RfbmV3ZmVlZCIpCiAgICAgICAgcHJpbnQoIjIuIFRlc3QgZXhlY3V0ZV9qb2IiKQogICAgICAgIHByaW50KCIzLiBUZXN0IGdldF9hY2NvdW50c19mcm9tX2RldmljZSIpCiAgICAgICAgcHJpbnQoIjQuIFRlc3QgY2FyZSBmdW5jdGlvbnMiKQogICAgICAgIHByaW50KCI1LiBUZXN0IG5hdmlnYXRpb24gZnVuY3Rpb25zIikKICAgICAgICBwcmludCgiNi4gVGVzdCB04bqldCBj4bqjIikKICAgICAgICBwcmludCgiMC4gVGhvw6F0IikKICAgICAgICAKICAgICAgICBjaG9pY2UgPSBpbnB1dCgiXG5OaOG6rXAgbOG7sWEgY2jhu41uICgwLTYpOiAiKS5zdHJpcCgpCiAgICAgICAgCiAgICAgICAgaWYgY2hvaWNlID09ICIwIjoKICAgICAgICAgICAgcHJpbnQoIvCfkYsgVOG6oW0gYmnhu4d0ISIpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjEiOgogICAgICAgICAgICB0ZXN0X3Bvc3RfbmV3ZmVlZCgpCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjIiOgogICAgICAgICAgICB0ZXN0X2V4ZWN1dGVfam9iKCkKICAgICAgICBlbGlmIGNob2ljZSA9PSAiMyI6CiAgICAgICAgICAgIHRlc3RfZ2V0X2FjY291bnRzX2Zyb21fZGV2aWNlKCkKICAgICAgICBlbGlmIGNob2ljZSA9PSAiNCI6CiAgICAgICAgICAgIHRlc3RfY2FyZV9mdW5jdGlvbnMoKQogICAgICAgIGVsaWYgY2hvaWNlID09ICI1IjoKICAgICAgICAgICAgdGVzdF9uYXZpZ2F0aW9uX2Z1bmN0aW9ucygpCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjYiOgogICAgICAgICAgICBwcmludCgiXG7wn5qAIENI4bqgWSBU4bqkVCBD4bqiIFRFU1RTIikKICAgICAgICAgICAgdGVzdF9uYXZpZ2F0aW9uX2Z1bmN0aW9ucygpCiAgICAgICAgICAgIHRlc3RfZ2V0X2FjY291bnRzX2Zyb21fZGV2aWNlKCkKICAgICAgICAgICAgdGVzdF9jYXJlX2Z1bmN0aW9ucygpCiAgICAgICAgICAgIHRlc3RfZXhlY3V0ZV9qb2IoKQogICAgICAgICAgICB0ZXN0X3Bvc3RfbmV3ZmVlZCgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoIuKdjCBM4buxYSBjaOG7jW4ga2jDtG5nIGjhu6NwIGzhu4chIikKCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgbWFpbigpCg==').decode('utf-8'))
